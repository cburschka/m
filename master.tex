%% LyX 2.1.4 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass[ngerman]{scrbook}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{geometry}
\geometry{verbose,bmargin=0.15\paperheight}
\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}
\setlength{\parskip}{\medskipamount}
\setlength{\parindent}{0pt}
\usepackage{float}
\usepackage{textcomp}
\usepackage{mathtools}
\usepackage{enumitem}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{stmaryrd}
\usepackage{setspace}
\onehalfspacing

\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.
\floatstyle{ruled}
\newfloat{algorithm}{tbp}{loa}[chapter]
\providecommand{\algorithmname}{Algorithmus}
\floatname{algorithm}{\protect\algorithmname}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Textclass specific LaTeX commands.
\usepackage{enumitem}		% customizable list environments
\newlength{\lyxlabelwidth}      % auxiliary length 
\theoremstyle{plain}
\ifx\thechapter\undefined
\newtheorem{thm}{\protect\theoremname}
\else
\newtheorem{thm}{\protect\theoremname}[chapter]
\fi
  \theoremstyle{definition}
  \newtheorem{defn}[thm]{\protect\definitionname}
  \theoremstyle{plain}
  \newtheorem{prop}[thm]{\protect\propositionname}
 \newlist{casenv}{enumerate}{4}
 \setlist[casenv]{leftmargin=*,align=left,widest={iiii}}
 \setlist[casenv,1]{label={{\itshape\ \casename} \arabic*.},ref=\arabic*}
 \setlist[casenv,2]{label={{\itshape\ \casename} \roman*.},ref=\roman*}
 \setlist[casenv,3]{label={{\itshape\ \casename\ \alph*.}},ref=\alph*}
 \setlist[casenv,4]{label={{\itshape\ \casename} \arabic*.},ref=\arabic*}
  \theoremstyle{remark}
  \newtheorem{notation}[thm]{\protect\notationname}
% labeling-like list based on enumitem's description list with
% mandatory second argument (label-pattern):
\newenvironment{elabeling}[2][]%
{\settowidth{\lyxlabelwidth}{#2}
\begin{description}[font=\normalfont,style=sameline,
leftmargin=\lyxlabelwidth,#1]}
{\end{description}}
  \theoremstyle{definition}
  \newtheorem{example}[thm]{\protect\examplename}
  \theoremstyle{definition}
  \newtheorem*{example*}{\protect\examplename}
  \theoremstyle{remark}
  \newtheorem*{rem*}{\protect\remarkname}
  \theoremstyle{plain}
  \newtheorem{lem}[thm]{\protect\lemmaname}
\newenvironment{lyxcode}
{\par\begin{list}{}{
\setlength{\rightmargin}{\leftmargin}
\setlength{\listparindent}{0pt}% needed for AMS classes
\raggedright
\setlength{\itemsep}{0pt}
\setlength{\parsep}{0pt}
\normalfont\ttfamily}%
 \item[]}
{\end{list}}
  \theoremstyle{plain}
  \newtheorem{cor}[thm]{\protect\corollaryname}
  \theoremstyle{remark}
  \newtheorem{claim}[thm]{\protect\claimname}
  \theoremstyle{plain}
  \newtheorem*{assumption*}{\protect\assumptionname}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
\usepackage[nottoc]{tocbibind} 
\usepackage{hyperref}
\usepackage{tikz}
%\tikzstyle{every node}=[circle, draw=black,inner sep=0.2em]
%\usetikzlibrary{fixedpointarithmetic}
%\usetikzlibrary{positioning}
%\let\nchapter\chapter
%\renewcommand*\chapter[1]{\nchapter*{#1}\addcontentsline{toc}{chapter}{#1}}
%\theoremstyle{definition}
%\newtheorem{notation}[thm]{Notation}
%\newtheorem*{notation*}{Notation}
%\numberwithin{thm}{chapter}

%\usepackage{prettyref}
%\newrefformat{chap}{\textbf{Kapitel~\ref{#1}}}
%\newrefformat{sec}{\textbf{Abschnitt~\ref{#1}}}
%\newrefformat{sub}{\textbf{Abschnitt~\ref{#1}}}
%\newrefformat{thm}{\textbf{Theorem~\ref{#1}}}
%\newrefformat{lem}{\textbf{Lemma~\ref{#1}}}
%\newrefformat{prop}{\textbf{Satz~\ref{#1}}}

\makeatother

\usepackage{babel}
  \providecommand{\assumptionname}{Annahme}
  \providecommand{\claimname}{Behauptung}
  \providecommand{\corollaryname}{Korollar}
  \providecommand{\definitionname}{Definition}
  \providecommand{\examplename}{Beispiel}
  \providecommand{\lemmaname}{Lemma}
  \providecommand{\notationname}{Notation}
  \providecommand{\propositionname}{Satz}
  \providecommand{\remarkname}{Bemerkung}
 \providecommand{\casename}{Fall}
\providecommand{\theoremname}{Theorem}

\begin{document}

\title{Logische Charakterisierungen von Symmetrischen Schaltkreisfamilien}


\subject{Master-Arbeit}


\author{Christoph Burschka}


\publishers{\textsc{Goethe-Universität Frankfurt am Main}\\
\textsc{\normalsize{}Institut für Informatik}}

\maketitle
\tableofcontents{}


\chapter{Einleitung}

Wir modellieren Graphen und Datenbanken als Strukturen, die ein Schema
von relationalen Prädikaten über einem endlichen Universum interpretieren.
Eine Datenbank-Anfrage in einem solchen Schema wird als Funktion modelliert,
die jede endliche Struktur auf eine Relation abbildet.

Von besonderem Interesse ist die Daten-Komplexität solcher Anfragen:
Die Zeit- und Platzkomplexität der Auswertung einer festen Anfrage
in Abhängigkeit von der Größe der eingegebenen Struktur. Wir betrachten
zwei Modelle, in denen alle beschreibbaren Anfragen eine beschränkte
Datenkomplexität besitzen:
\begin{enumerate}
\item Klassen von booleschen Schaltkreisfamilien $\left(\mathcal{C}_{n}\right)_{n\in\mathbb{N}}$
(mit $\mathtt{AND}$-, $\mathtt{OR}$-, $\mathtt{NOT}$-, und gegebenenfalls
Majority-Gates).
\item Formeln der Prädikatenlogik erster Stufe (beziehungsweise deren Erweiterungen).
\end{enumerate}
Boolesche Schaltkreise arbeiten per Definition auf einer geordneten
Struktur. Für ungeordnete Strukturen wird deshalb eine beliebige Ordnung
gewählt und gefordert, dass das Ergebnis bezüglich der Ordnung invariant
ist. Wir führen eine strukturelle Einschränkung (Symmetrie) der Schaltkreise
ein, die diese Invarianz garantiert.

Die Schaltkreisfamilie besteht aus einer unendlichen Sequenz von Schaltkreisen
für jede Eingabegröße $n\in\mathbb{N}$ ist. Ohne Einschränkung kann
eine solche Sequenz auch unentscheidbare Klassen von natürlichen Zahlen
kodieren. In der Praxis ist es daher erwünscht, dass die Schaltkreise
von einem effizienten Algorithmus berechnet werden: Ist zum Beispiel
jeder Schaltkreis in Polynomialzeit oder mit logarithmischem Platz
(in Abhängigkeit von $n$) berechenbar, dann nennen wir die Schaltkreisfamilie
$P$- beziehungsweise $\mathrm{LOGSPACE}$-uniform.

Die Logik erster Stufe ist in der Praxis zu eingeschränkt: Selbst
einfache Probleme wie die Frage, ob eine Struktur eine gerade Anzahl
von Elementen enthält, oder zwei Knoten durch einen Weg beliebiger
Länge verbunden sind, können nicht ausgedrückt werden.\cite{Libkin2012}
Daher erweitern wir die Logik um Fixpunkt-Operatoren, numerische Prädikate
und Zähler. Insbesondere betrachten wir Logiken, in denen die numerischen
Prädikate \emph{disjunkt} von dem Universum der eigentlichen Struktur
interpretiert werden, und weisen nach, dass solche Logiken gerade
die verschiedenen Klassen symmetrischer Schaltkreisfamilien charakterisieren.

Konkret ist die Klasse der symmetrischen $P$-uniformen booleschen
Schaltkreisfamilien $\mathrm{SBC}^{P}$ äquivalent zu der Logik erster
Stufe mit Fixpunkt-Operator und disjunktem Ordnungsprädikat $\mathrm{FP}+\mathbf{ORD}$.
Das Ergebnis wurde 2014 von Matthew Anderson und Anuj Dawar\cite{AD2014}
(nach einem ähnlichen Ergebnis für infinitäre Logik von Martin Otto
in 1997\cite{Otto1997}) veröffentlicht, und bildet die Grundlage
dieser Arbeit.

Die logische Zählerweiterung $\mathrm{FP}+C$ charakterisiert die
Schaltkreisklasse $\left(\mathrm{SBC}+\mathbf{MAJ}\right)^{P}$ mit
einem Majority-Gate, und die Erweiterung der Logik um beliebige numerische
Prädikate $\mathrm{FP}+\mathbf{ARB}$ charakterisiert die nicht-uniforme
Klasse $\mathrm{SBC}^{P/\mathrm{poly}}$. Diese beiden Erweiterungen
sind miteinander kombinierbar.
\begin{thm}
\textbf{\label{thm:fp}Anderson und Dawar (2014)}

Die folgenden Paare von Anfragenklassen sind auf endlichen Strukturen
äquivalent:
\begin{enumerate}
\item $\mathrm{FP}+\mathbf{ORD}$ und $\mathrm{SBC}^{P}$
\item $\mathrm{FP}+C$ und $\left(\mathrm{SBC}+\mathbf{MAJ}\right)^{P}$
\item $\mathrm{FP}+\mathbf{ARB}$ und $\mathrm{SBC}^{P/\mathrm{poly}}$
\end{enumerate}
\end{thm}
Ein ähnliches Ergebnis gibt es für Schaltkreisfamilien konstanter
Tiefe. Es wird eine Charakterisierung der $\mathrm{LOGSPACE}$-uniformen
symmetrischen $\mathrm{AC}^{0}$-Schaltkreisfamilien ($\left(\mathrm{SAC}^{0}\right)^{\mathrm{LOGSPACE}}$)
durch die Logik $\mathrm{FO}+\mathbf{BIT}$ mit disjunktem $\mathtt{BIT}$-Prädikat
nachgewiesen.
\begin{thm}
\label{thm:fo}Die folgenden Paare von Anfragenklassen sind auf endlichen
Strukturen äquivalent:
\begin{enumerate}
\item $\mathrm{FO}+\mathbf{BIT}$ und $\left(\mathrm{SAC}^{0}\right)^{\mathrm{LOGSPACE}}$
\item $\mathrm{FO}+\mathbf{BIT}+C$ und $\left(\mathrm{SAC}^{0}+\mathbf{MAJ}\right)^{\mathrm{LOGSPACE}}$
\item $\mathrm{FO}+\mathbf{ARB}$ und $\left(\mathrm{SAC}^{0}+\mathbf{MAJ}\right)^{P/\mathrm{poly}}$
\end{enumerate}
\end{thm}
Die Einschränkung auf symmetrische Schaltkreisfamilien bringt im Allgemeinen
eine Reduktion der Ausdrucksstärke mit sich. So wird die Klasse $\mathrm{AC}^{0}$
durch die invariante Logik $\mathrm{inv}\left(\mathrm{FO}\oplus\mathbf{ARB}\right)$
(\cite{Immerman1987,Makowsky1997-FO}), und $P/\mathrm{poly}$ durch
$\mathrm{inv}\left(\mathrm{FP}\oplus\mathbf{ARB}\right)$ (\cite{Makowsky1997-FO,Makowsky1998-LFP})
charakterisiert. $\mathrm{inv}\left(\mathrm{FO}\oplus\mathbf{ARB}\right)$
ist jedoch echt ausdrucksstärker als die disjunkte Variante $\mathrm{FO}+\mathbf{ARB}$.
\begin{thm}
\label{thm:fo-arb}Für die $\mathrm{FO}+\mathbf{ARB}$-Logik und die
arb-invariante $\mathrm{FO}\oplus\mathbf{ARB}$-Logik gilt:
\begin{enumerate}
\item Jede $\mathrm{FO}+\mathbf{ARB}$-Formel beschreibt eine Anfrage, die
durch eine arb-invariante $\mathrm{FO}\oplus\mathbf{ARB}$-Formel
definierbar ist.
\item Es existiert eine Anfrage, die in der arb-invarianten $\mathrm{FO}\oplus\mathbf{ARB}$-Logik,
aber nicht $\mathrm{FO}+\mathbf{ARB}$ definierbar ist.
\end{enumerate}
\end{thm}
Ähnliche Bezüge bestehen vermutlich auch zwischen den symmetrischen
und nicht-symmetrischen Teilen der übrigen betrachteten Schaltkreisklassen.


\chapter{Grundlegende Definitionen}


\section{Notation}

Zunächst legen wir einige Notationen und Abkürzungen fest. Im folgenden
bezeichne $\mathbb{N}$ die Menge der natürlichen Zahlen einschließlich
$0$, $\mathbb{R}$ die Menge der reellen Zahlen, und ,,$\leqslant$``
(wenn nicht anders definiert) die natürliche Ordnung von $\mathbb{R}$
und $\mathbb{N}$. Mit ,,ex.``, ,,s.d.`` und ,,f.a.`` kürzen
wir gegebenenfalls ,,es existiert``, ,,so dass`` und ,,für alle``
ab.
\begin{defn}
\textbf{\label{def:tupel}Mengen und Tupel}

Mengen benennen wir im allgemeinen durch Großbuchstaben wie $A$,
$B$, $U$ oder $X$. Für eine Menge $A$ bezeichne $2^{A}\coloneqq\left\{ A'\mid A'\subseteq A\right\} $
die Menge aller Teilmengen von $A$.

Tupel benennen wir durch Kleinbuchstaben mit Balken wie $\bar{a}$,
$\bar{b}$, $\bar{u}$ oder $\bar{x}$. Die Stelligkeit $\mathrm{ar}\left(\bar{x}\right)$
eines Tupels $\bar{x}$ sei die Anzahl seiner Elemente, und ein $n$-stelliges
Tupel heiße kurz ,,$n$-Tupel``. Implizit gelte stets $\bar{x}=\left(x_{1},\cdots,x_{\left|\mathrm{ar}\left(x\right)\right|}\right)$.
Die Menge aller $k$-Tupel einer Menge $A$ sei $A^{k}$.

Für ein $m$-Tupel $\bar{x}$ und ein $n$-Tupel $\bar{y}$ sei $\bar{x}\bar{y}$
das $\left(m+n\right)$-Tupel $\left(x_{1},\cdots,x_{m},y_{1},\cdots,y_{n}\right)$.
Das $0$-stellige Tupel wird durch $\left\langle \right\rangle $
notiert.

Für $\bar{a}\in A^{k}$ und $A'\subseteq A$ sei $\bar{a}_{\mid A'}$
das Tupel, das aus $\bar{a}$ entsteht, wenn die Elemente $a_{i}\in A\backslash A'$
entfernt werden.
\end{defn}

\begin{defn}
\textbf{Intervall}

Ein endliches Intervall von natürlichen Zahlen wird durch $\left[a,b\right]$
abgekürzt:
\[
\left[a,b\right]\coloneqq\left\{ i\in\mathbb{N}\mid a\leqslant i\leqslant b\right\} 
\]


Ein Intervall von reellen Zahlen wird durch $\mathbb{R}_{\left[a,b\right]}$
oder $\mathbb{R}_{\left[a,b\right[}$ abgekürzt: 
\begin{eqnarray*}
\mathbb{R}_{\left[a,b\right]} & \coloneqq & \left\{ i\in\mathbb{R}\mid a\leqslant i\leqslant b\right\} \\
\mathbb{R}_{\left[a,b\right[} & \coloneqq & \left\{ i\in\mathbb{R}\mid a\leqslant i<b\right\} 
\end{eqnarray*}

\end{defn}
Als nächstes definieren wir Relationen als Mengen von Tupeln von Elementen
eines Universums. 
\begin{defn}
\textbf{\label{def:relation}Relation}

Für eine Menge $A$ und $k\in\mathbb{N}$ sei $R\subseteq A^{k}$
eine $k$-stellige Relation über $A$. Für jede Relation $R\subseteq A^{k}$
sei $\left[R\right]:A^{k}\rightarrow\left\{ 0,1\right\} $ die folgende
Funktion: 
\[
\left[R\right]\left(\bar{a}\right)\coloneqq\begin{cases}
1 & \mathrm{falls}\,\,\bar{a}\in R\\
0 & \mathrm{sonst}
\end{cases}
\]

\end{defn}
Für geordnete Mengen definieren wir die Operatoren $\min$ und $\max$,
die das kleinste und größte Element (sofern vorhanden) einer Menge
unter einer bestimmten Ordnung bezeichnen.
\begin{defn}
\textbf{Minimum und Maximum}

Für eine Ordnung $\preceq$ auf einer Menge $X$ seien $\min_{\preceq}\left(X\right)\in X$
und $\max_{\preceq}\left(X\right)\in X$ diejenigen Elemente (sofern
vorhanden), so dass für alle Elemente $z\in X$ gilt:
\[
\min_{\preceq}\left(X\right)\preceq z\preceq\max_{\preceq}\left(X\right)
\]
Für $X\subseteq\mathbb{R}$ wird die natürliche Ordnung $\leqslant$
nicht explizit notiert. Für eine Funktion $f:U\rightarrow\mathbb{R}$
und eine Menge $X\subseteq U$ bezeichnen $\min_{x\in X}f\left(x\right)\in\mathbb{R}$
und $\max_{x\in X}f\left(x\right)\in\mathbb{R}$ die folgende Abkürzungen:
\begin{eqnarray*}
\min_{x\in X}f\left(x\right) & \coloneqq & \min\left\{ f\left(x\right)\mid x\in X\right\} \\
\max_{x\in X}f\left(x\right) & \coloneqq & \max\left\{ f\left(x\right)\mid x\in X\right\} 
\end{eqnarray*}
Umgekehrt bezeichnet $\min_{f}U$ ein beliebiges Element $u\in U$
mit dem minimalen Wert $f\left(u\right)=\min_{x\in U}f\left(x\right)$,
und $\max_{f}U$ analog.
\end{defn}

\begin{defn}
\textbf{Asymptotische Klassen}

Für jede Funktion $f:\mathbb{N}\rightarrow\mathbb{R}$ definieren
wir die Funktionsklassen $\mathcal{O}\left(f\right)$ und $\Omega\left(f\right)$:
\begin{itemize}
\item Es gelte $g\in\mathcal{O}\left(f\right)$ genau dann wenn ein $n_{0},c\in\mathbb{N}$
existieren, so dass für alle $n\geqslant n_{0}$ gilt: $g\left(n\right)\leqslant c\cdot f\left(n\right)$.
\item Es gelte $g\in\Omega\left(f\right)$ genau dann wenn $f\in\mathcal{O}\left(g\right)$.
\end{itemize}
Für $f:\mathbb{R}\rightarrow\mathbb{R}$ und eine Klasse $\mathcal{F}$
sei $f\left(\mathcal{F}\right)\coloneqq\left\{ f\circ g\mid g\in\mathcal{F}\right\} $.
Zum Beispiel ist $f\in2^{\mathcal{O}\left(n\right)}$ genau dann wenn
$f\in\mathcal{O}\left(2^{kn}\right)$ für ein festes $k\in\mathbb{N}$.
\end{defn}


Wir legen mehrere einfache Operationen für Abbildungen fest, darunter
die Verkettung, Vereinigung disjunkter Definitionsbereiche und Reduktion
auf einen Teilbereich.
\begin{defn}
\textbf{Abbildung}

Für eine Abbildung $\pi:A\rightarrow B$ und $a\in A$ schreiben wir
statt $\pi\left(a\right)$ gegebenenfalls $\pi a$ ohne Klammern.

Jede Abbildung $\pi:A\rightarrow B$ wird auf natürliche Weise auf
Tupel, Teilmengen und Relationen von $A$ erweitert:
\begin{eqnarray*}
\pi\left(x_{1},\cdots,x_{k}\right) & \coloneqq & \left(\pi x_{1},\cdots,\pi x_{n}\right)\\
\pi\left\{ x_{1},\cdots,x_{n}\right\}  & \coloneqq & \left\{ \pi x_{1},\cdots,\pi x_{n}\right\} 
\end{eqnarray*}


Eine Abbildung $\pi:A\rightarrow B$ mit $A=\left\{ a_{1},\cdots,a_{n}\right\} $
schreiben wir gegebenenfalls extensional wie folgt auf. Für ein Tupel
$\bar{a}=\left(a_{1},\cdots,a_{n}\right)$ kürzen wir diese Abbildung
auch durch $\left(\bar{a}\mapsto\pi\bar{a}\right)$ ab. 
\begin{eqnarray*}
\pi & \coloneqq & \left(\begin{array}{c}
a_{1}\\
\pi a_{1}
\end{array}\cdots\begin{array}{c}
a_{n}\\
\pi a_{n}
\end{array}\right)\\
\pi & \coloneqq & \left(\bar{a}\mapsto\pi\bar{a}\right)
\end{eqnarray*}


Für zwei Abbildungen $\pi_{1}:B\rightarrow C$ und $\pi_{2}:A\rightarrow B$
sei $\pi_{1}\circ\pi_{2}:A\rightarrow C$ (kurz $\pi_{1}\pi_{2}$)
die folgende Abbildung: 
\[
\pi_{1}\pi_{2}\coloneqq\left(\bar{a}\mapsto\pi_{1}\left(\pi_{2}\left(\bar{a}\right)\right)\right)
\]


Für zwei Abbildungen $\pi:A\rightarrow B$ und $\pi':A'\rightarrow B'$
mit disjunkten Definitionsbereichen $A\cap A'=\emptyset$ sei $\pi''\coloneqq\pi\cup\pi'$
die folgende Abbildung: 
\begin{eqnarray*}
\pi'' & : & A\uplus A'\rightarrow B\cup B'\\
\pi''x & \coloneqq & \begin{cases}
\pi x & \mathrm{falls}\,\,x\in A\\
\pi'x & \mathrm{falls}\,\,x\in A'
\end{cases}
\end{eqnarray*}


Für $\pi:A\rightarrow B$ und $A'\subseteq A$ sei $\pi_{\mid A'}:A'\rightarrow B$
die Reduktion von $\pi$ auf eine Teilmenge des Definitionsbereichs,
und $\pi_{\backslash A'}:A\backslash A'\rightarrow B$ die Reduktion
auf das Komplement.

Es sei $\mathbf{id}$ die Identität mit $\mathbf{id}\left(a\right)=a$
für alle Elemente $a$. Mit $\mathbf{id}_{X}$ bezeichnen wir die
Identitätsfunktion auf einer Menge $X$.

Die Menge $\mathrm{Abb}\left(A,B\right)$ bezeichne alle Funktionen
$\pi:A\rightarrow B$, und $\mathrm{Bij}\left(A,B\right)$ bezeichne
für endliche $\left|A\right|=\left|B\right|=n$ alle $n!$ bijektiven
Abbildungen $\pi:A\rightleftarrows B$.
\end{defn}

\begin{defn}
\textbf{Permutation}

Eine Permutation von $U$ ist eine bijektive Abbildung $\pi:U\rightleftarrows U$.
Die Menge aller Permutationen $\mathrm{Bij}\left(U,U\right)$ bezeichnen
wir auch als $\mathrm{Sym}_{U}$. Diese bilden eine Symmetrie-Gruppe
bezüglich der Verkettung $\circ$ mit dem neutralen Element $\mathbf{id}_{U}$.

Es sei $\pi^{-1}$ die inverse Abbildung mit $\pi^{-1}\pi=\pi\pi^{-1}=\mathbf{id}_{U}$.

Eine Transposition sei eine Permutation, die zwei Elemente $u_{i}$
und $u_{j}$ vertauscht und alle anderen Elemente fixiert. Die Permutation
$\left(\begin{array}{cc}
u_{i} & u_{j}\\
u_{j} & u_{i}
\end{array}\right)\cup\mathbf{id}_{U\backslash\left\{ u_{i},u_{j}\right\} }$ wird kurz durch $\left(u_{i}u_{j}\right)$ notiert.
\end{defn}

\begin{defn}
\textbf{\label{def:orbit}Orbit}

In einer Permutationsgruppe $G\subseteq\mathrm{Sym}_{U}$ sei $\mathrm{Orb}_{G}\left(u\right)\coloneqq\left\{ \pi u\mid\pi\in G\right\} $
die Menge aller Elemente, auf die $u$ abgebildet wird.
\end{defn}

\section{Endliche relationale Strukturen}

Wir betrachten Anfragen und Eigenschaften auf Graphen und allgemeinen
endlichen Strukturen über eine beliebige relationale Signatur $\sigma$.
\begin{defn}
\textbf{Relationale Signaturen}

Eine relationale Signatur $\sigma$ ist eine Menge von Relationssymbolen.
Jedes Symbol $R\in\sigma$ hat eine feste Stelligkeit $\mathrm{ar}\left(R\right)=k\in\mathbb{N}_{\geqslant1}$.
Gegebenenfalls wird die Stelligkeit kompakt durch $R/k\in\sigma$
beziehungsweise $\sigma=\left\{ R_{1}/k_{1},\cdots,R_{k}/k_{k}\right\} $
notiert.
\end{defn}

\begin{defn}
\textbf{Endliche Strukturen}

Eine endliche $\sigma$-Struktur $\mathfrak{A}=\left(A,\left(R^{\mathfrak{A}}\right)_{R\in\sigma}\right)$
über einer Signatur $\sigma$ und einem endlichen nicht-leeren Universum
$A$ besteht aus einer Interpretation $R^{\mathfrak{A}}\subseteq A^{k}$
für jedes Symbol $R/k\in\sigma$. Strukturen benennen wir im Allgemeinen
durch die Frakturbuchstaben $\mathfrak{A}$ und $\mathfrak{B}$.
\begin{itemize}
\item Für eine endliche Menge $U$ sei $\mathbf{FIN}^{U}\left(\sigma\right)$
die Menge aller $\sigma$-Strukturen über dem Universum $U$.
\item Für $n\in\mathbb{N}_{\geqslant1}$ seien $\mathbf{FIN}^{\left(n\right)}\left(\sigma\right)$
die $\sigma$-Strukturen über einem beliebigen Universum der Größe
$n$.
\item Seien $\mathbf{FIN}\left(\sigma\right)\coloneqq\bigcup_{n\in\mathbb{N}_{\geqslant1}}\mathbf{FIN}^{\left(n\right)}\left(\sigma\right)$
die endlichen $\sigma$-Strukturen.
\end{itemize}
\end{defn}
Die Signatur $\sigma$ kann in Ausnahmefällen unendlich sein; da wir
jedoch nur endlich repräsentierbare $\sigma$-Anfragen betrachten,
können diese sich nur auf eine endlichen Menge von Relationssymbolen
$\sigma'\subseteq_{\mathrm{fin}}\sigma$ beziehen.

Wir formalisieren die Interpretation als eine Abbildung $\square^{\mathfrak{A}}:\sigma\rightarrow\bigcup_{k\in\mathbb{N}}2^{\left(A^{k}\right)}$,
die jedem Symbol eine Relation der entsprechenden Stelligkeit zuweist.
Daher kann die Interpretation gegebenenfalls auch explizit durch $\mathfrak{A}=\left(A,\square^{\mathfrak{A}}\right)$
notiert werden, um die Zuordnung von Symbolen und Relationen zu verdeutlichen:
\[
\mathfrak{A}:=\left(A,\left(\begin{array}{c}
R_{1}\\
R_{1}^{\mathfrak{A}}
\end{array}\cdots\begin{array}{c}
R_{k}\\
R_{k}^{\mathfrak{A}}
\end{array}\right)\right)
\]

\begin{defn}
\textbf{Geordnete Strukturen}

Sei $\sigma$ eine relationale Signatur, die nicht das zweistellige
Symbol $\leqslant$ enthält.

Für $a,b\in\mathbb{N}$ sei 
\[
\mathbf{FIN}_{\leqslant}^{\left[a,b\right]}\left(\sigma\right)\subseteq\mathbf{FIN}^{\left[a,b\right]}\left(\sigma\cup\left\{ \leqslant\right\} \right)
\]
 die Menge der endlichen $\sigma\cup\left\{ \leqslant\right\} $-Strukturen
mit dem Universum $\left[a,b\right]$, wobei $\leqslant$ durch die
natürliche Ordnung von $\left[a,b\right]$ interpretiert wird, und
sei 
\[
\mathbf{FIN}_{\leqslant}^{a}\left(\sigma\right)\coloneqq\bigcup_{b\in\mathbb{N}}\mathbf{FIN}_{\leqslant}^{\left[a,b\right]}\left(\sigma\right)
\]
 die Menge aller endlichen geordneten $\sigma\cup\left\{ \leqslant\right\} $-Strukturen
über Intervallen, die mit $a$ beginnen (normalerweise mit $a\in\left\{ 0,1\right\} $).
\end{defn}
Der Lesbarkeit halber verwenden wir die Infixnotation $a\leqslant b$
anstelle von $\left(a,b\right)\in\leqslant$ oder $\left[\leqslant\right]\left(a,b\right)$.
Die Symbole $\dot{\leqslant}$ und $\dot{=}$ seien gleichbedeutend
mit den Symbolen $\leqslant$ und $=$, und werden gegebenenfalls
in Gleichungen wie $\varphi=x\dot{=}y$ und $\varphi=x\dot{\leqslant}y$
verwendet.
\begin{defn}
\textbf{\label{def:isomorphism}Isomorphismus}

Für zwei $\sigma$-Strukturen $\mathfrak{A}$ und $\mathfrak{B}$
sei eine bijektive Abbildung $\pi:A\rightleftarrows B$ ein Isomorphismus,
falls $\pi R^{\mathfrak{A}}=R^{\mathfrak{B}}$ für alle Symbole $R\in\sigma$
gilt.

Die Abbildung $\pi$ wird auf natürliche Weise auf Strukturen erweitert:
\[
\pi\mathfrak{A}\coloneqq\left(\pi A,\left(\pi R^{\mathfrak{A}}\right)_{R\in\sigma}\right)
\]


Die Menge aller Isomorphismen bezeichnen wir mit $\mathrm{Bij}\left(\mathfrak{A},\mathfrak{B}\right)$.
Zwei Strukturen heißen isomorph (kurz $\mathfrak{A}\cong\mathfrak{B}$),
falls $\mathrm{Bij}\left(\mathfrak{A},\mathfrak{B}\right)$ nicht
leer ist. Wir schreiben $\left(\mathfrak{A},\bar{a}\right)\cong\left(\mathfrak{B},\bar{b}\right)$,
wenn insbesondere ein $\pi\in\mathrm{Bij}\left(\mathfrak{A},\mathfrak{B}\right)$
mit $\pi\bar{a}=\bar{b}$ existiert.

Ein Automorphismus $\pi\in\mathrm{Bij}\left(\mathfrak{A},\mathfrak{A}\right)$
sei ein Isomorphismus von $\mathfrak{A}$ zu sich selbst. Die Menge
der Automorphismen $\mathrm{Bij}\left(\mathfrak{A},\mathfrak{A}\right)$
nennen wir $\mathrm{Aut}_{\mathfrak{A}}$; diese bilden (so wie die
Permutationen einer Menge) eine Gruppe bezüglich der Verkettung $\circ$
und dem neutralen Element $\mathbf{id}_{A}$.

Der Orbit eines Elements $a\in A$ sei analog zu Definition \ref{def:orbit}
die Menge $\mathrm{Orb}_{\mathfrak{A}}\left(a\right)\coloneqq\left\{ \pi a\mid\pi\in\mathrm{Aut}_{\mathfrak{A}}\right\} $
aller Elemente, auf die $a$ von einem Automorphismus abgebildet werden
kann.
\end{defn}

\begin{defn}
\textbf{\label{def:disjoint-union}Vereinigung von Strukturen}

Zwei Strukturen können vereinigt werden, wenn sie entweder disjunkte
Signaturen oder die gleiche Signatur besitzen. Für eine $\sigma_{1}$-Struktur
$\mathfrak{A}$ und eine $\sigma_{2}$-Struktur $\mathfrak{B}$ gelte:
\begin{enumerate}
\item Wenn $\sigma_{1}\cap\sigma_{2}=\emptyset$, so ist $\mathfrak{A}\cup\mathfrak{B}$
die folgende $\left(\sigma_{1}\cup\sigma_{2}\right)$-Struktur:
\[
\mathfrak{A}\cup\mathfrak{B}\coloneqq\left(A\cup B,\left(R^{\mathfrak{A}}\right)_{R\in\sigma_{1}},\left(R^{\mathfrak{B}}\right)_{R\in\sigma_{2}}\right)
\]

\item Wenn $\sigma_{1}=\sigma_{2}=\sigma$, so ist $\mathfrak{A}\cup\mathfrak{B}$
die folgende $\sigma$-Struktur:
\[
\mathfrak{A}\cup\mathfrak{B}\coloneqq\left(A\cup B,\left(R^{\mathfrak{A}}\cup R^{\mathfrak{B}}\right)_{R\in\sigma}\right)
\]

\end{enumerate}
Falls die beiden Strukturen disjunkte Universen $A\cap B=\emptyset$
haben, so heiße $\mathfrak{A}\cup\mathfrak{B}=\mathfrak{A}\uplus\mathfrak{B}$
die \textbf{disjunkte Vereinigung} der Strukturen. Wenn sie disjunkte
Signaturen und das gleiche Universum haben, so nennen wir $\mathfrak{A}\cup\mathfrak{B}=\mathfrak{A}\oplus\mathfrak{B}$
die \textbf{Konkatenation} der Strukturen.\end{defn}
\begin{prop}
\label{prop:iso-closed-disjoint}Isomorphismen sind unter disjunkter
Vereinigung abgeschlossen.\end{prop}
\begin{proof}
Seien $\mathfrak{A},\mathfrak{A}'\in\mathbf{FIN}\left(\sigma_{1}\right)$
und $\mathfrak{B},\mathfrak{B}'\in\mathbf{FIN}\left(\sigma_{2}\right)$
jeweils zwei Paare isomorpher Strukturen mit $\pi_{1}\in\mathrm{Bij}\left(\mathfrak{A},\mathfrak{A}'\right)$
und $\pi_{2}\in\mathrm{Bij}\left(\mathfrak{B},\mathfrak{B}'\right)$.
Sei ferner $A\cap B=A'\cap B'=\emptyset$, und seien $\bar{a}\in A^{k},\bar{a}'\in A'^{k},\bar{b}\in B^{k'},\bar{b}\in B'^{k'}$
vier Tupel mit $\pi_{1}\bar{a}=\bar{a}'$ und $\pi_{2}\bar{b}=\bar{b}'$.

So gilt für die Abbildung $\pi\coloneqq\pi_{1}\cup\pi_{2}:A\uplus A'\rightarrow B\uplus B'$:
\begin{casenv}
\item Wenn $\sigma_{1}\cap\sigma_{2}=\emptyset$:
\begin{eqnarray*}
\pi R^{\mathfrak{A}\uplus\mathfrak{B}} & = & \pi_{1}R^{\mathfrak{A}}=R^{\mathfrak{A}'}=R^{\mathfrak{A}'\uplus\mathfrak{B}'}\,\mathrm{f\ddot{u}r}\,R\in\sigma_{1}\\
\pi R^{\mathfrak{A}\uplus\mathfrak{B}} & = & \pi_{2}R^{\mathfrak{B}}=R^{\mathfrak{B}'}=R^{\mathfrak{A}'\uplus\mathfrak{B}'}\,\mathrm{f\ddot{u}r}\,R\in\sigma_{2}
\end{eqnarray*}

\item Wenn $\sigma_{1}=\sigma_{2}$, dann gilt für alle $R\in\sigma_{1}$:
\[
\pi R^{\mathfrak{A}\cup\mathfrak{B}}=\pi_{1}R^{\mathfrak{A}}\uplus\pi_{2}R^{\mathfrak{B}}=R^{\mathfrak{A}'}\uplus R^{\mathfrak{B}'}=R^{\mathfrak{A}'\uplus\mathfrak{B}'}
\]

\end{casenv}
Damit ist $\pi\left(\mathfrak{A}\uplus\mathfrak{B}\right)=\mathfrak{A}'\uplus\mathfrak{B}'$
und $\pi\bar{a}\bar{b}=\bar{a}'\bar{b}'$, und $\left(\mathfrak{A}\uplus\mathfrak{B},\bar{a}\bar{b}\right)\cong\left(\mathfrak{A}'\uplus\mathfrak{B}',\bar{a}'\bar{b}'\right)$.
\end{proof}

\begin{defn}
\textbf{\label{def:induced-structure}Induzierte Teilstruktur}

Für eine Relation $R\subseteq A^{k}$ und eine Teilmenge $A'\subseteq A$
sei $R_{\mid A'}\coloneqq R\cap\left(A'\right)^{k}$ die von $A'$
induzierte Teilrelation. Für eine $\sigma$-Struktur $\mathfrak{A}$
sei $\mathfrak{A}_{\mid A'}\coloneqq\left(A',\left(R_{\mid A'}^{\mathfrak{A}}\right)_{R\in\sigma}\right)$
die von der Teilmenge $A'$ in $\mathfrak{A}$ induzierte Teilstruktur.
\end{defn}

\begin{defn}
\textbf{\label{def:neighborhoods}$r$-Nachbarschaft} (siehe Abschnitt
2.4 von \cite{EbbinghausFlum})

Für eine Struktur $\mathfrak{A}\in\mathbf{FIN}\left(\sigma\right)$
sei $\mathcal{G}\left(\mathfrak{A}\right)\in\mathbf{FIN}^{A}\left(\left\{ E\right\} \right)$
der \textbf{Gaifman-Graph} von $\mathfrak{A}$, der alle Knoten miteinander
verbindet, die im gleichen Tupel vorkommen. Insbesondere ist für jeden
symmetrischen\footnote{Der Gaifman-Graph ist ungerichtet, wird aber hier als symmetrische,
gerichtete $\left\{ E\right\} $-Struktur modelliert.} Graphen $\mathfrak{A}\in\mathbf{FIN}\left(\left\{ E\right\} \right)$
offensichtlich $\mathcal{G}\left(\mathfrak{A}\right)=\mathfrak{A}$.
\begin{eqnarray*}
\mathcal{G}\left(\mathfrak{A}\right) & = & \left(A,E^{\mathcal{G}\left(\mathfrak{A}\right)}\right)\\
E^{\mathcal{G}\left(\mathfrak{A}\right)} & = & \left\{ \left(a_{i},a_{j}\right)\mid R/k\in\sigma,\,\bar{a}\in R^{\mathfrak{A}},\,i,j\in\left[1,k\right],\,i\neq j\right\} 
\end{eqnarray*}


Sei $\mathrm{dist}_{\mathfrak{A}}:A^{2}\rightarrow\mathbb{N\cup\left\{ \infty\right\} }$
die minimale Distanz $\mathrm{dist}_{\mathfrak{A}}\left(a,b\right)$
in $\mathcal{G}\left(\mathfrak{A}\right)$ zwischen zwei Knoten $a,b\in A$.
Für ein $r\in\mathbb{N}$ sei nun $N_{r}^{\mathfrak{A}}\left(a\right)\coloneqq\left\{ b\in A\mid\mathrm{dist}_{\mathfrak{A}}\left(a,b\right)\leqslant r\right\} $
die \textbf{$r$-Kugel} um $a\in A$. Deren induzierte Teilstruktur
$\mathcal{N}_{r}^{\mathfrak{A}}\left(a\right)=\mathfrak{A}_{\mid N_{r}\left(a\right)}$
in $\mathfrak{A}$ sei die \textbf{$r$-Umgebung} von $a$.

Für zwei Strukturen $\mathfrak{A},\mathfrak{B}\in\mathbf{FIN}\left(\sigma\right)$
und zwei Elemente $a\in A$, $b\in B$ schreiben wir $a\sim_{r}b$
($a$ ist \textbf{$r$-ähnlich} zu $b$), wenn ein Isomorphismus $\pi\in\mathrm{Bij}\left(\mathcal{N}_{r}^{\mathfrak{A}}\left(a\right),\mathcal{N}_{r}^{\mathfrak{B}}\left(b\right)\right)$
mit $\pi a=b$ existiert.
\end{defn}

\begin{defn}
\textbf{$\sigma$-Anfragen}

Eine $\sigma$\textbf{-Anfrage} $q$ mit der Stelligkeit $\mathrm{ar}\left(q\right)=k$
sei eine Abbildung jeder endlichen $\sigma$-Struktur $\mathfrak{A}\in\mathbf{FIN}\left(\sigma\right)$
auf eine Relation $q\left(\mathfrak{A}\right)\subseteq A^{k}$. Eine
$\sigma$\textbf{-Eigenschaft} $S\subseteq\mathbf{FIN}\left(\sigma\right)$
sei eine Menge von $\sigma$-Strukturen und entspreche der 0-stelligen
Anfrage $q_{S}$:
\begin{eqnarray*}
q_{S}\left(\mathfrak{A}\right) & \coloneqq & \begin{cases}
\left\{ \left\langle \right\rangle \right\}  & \mathrm{falls}\,\mathfrak{A}\in S\\
\emptyset & \mathrm{sonst}
\end{cases}
\end{eqnarray*}


Per Definition sind alle $\sigma$-Anfragen und $\sigma$-Eigenschaften
unter Isomorphismen abgeschlossen: Für $\mathfrak{A}\cong\mathfrak{B}$
und $\pi\in\mathrm{Bij}\left(\mathfrak{A},\mathfrak{B}\right)$ gilt
$\pi q\left(\mathfrak{A}\right)=q\left(\mathfrak{B}\right)$ und $\mathfrak{A}\in S\Leftrightarrow\mathfrak{B}\in S$.
\end{defn}

\chapter{Logik}


\section{Grundlagen der relationalen Logik}

Wir betrachten logische Sprachen auf relationalen Signaturen $\sigma$,
deren Ausdrücke auf endlichen $\sigma$-Strukturen ausgewertet werden.

Zunächst definieren wir $\mathbf{var}$ als die Menge aller erststufigen
Variablen. Für einen Ausdruck $\omega$ sei $\mathrm{var}\left(\omega\right)$
die Menge der darin vorkommenden Variablen, und $\mathrm{frei}\left(\omega\right)\subseteq\mathrm{var}\left(\omega\right)$
die Menge der freien Variablen.

In einer Struktur $\mathfrak{A}$ sei eine \textbf{Belegung} $\beta$
eine partielle Abbildung $\beta:\mathbf{var}\rightarrow A$ von Variablen
auf Elemente des Universums.

Eine Auswertungsfunktion für eine Struktur $\mathfrak{A}$ und eine
Belegung $\beta$ wird durch $\left\llbracket \cdot\right\rrbracket \left(\mathfrak{A},\beta\right)$
notiert.
\begin{defn}
Eine Logik $\mathcal{L}\left[\sigma\right]$ besteht aus der Sprache
der $\mathcal{L}\left[\sigma\right]$-Terme, der Sprache der $\mathcal{L}\left[\sigma\right]$-Formeln,
und einer Auswertungsfunktion $\left\llbracket \omega\right\rrbracket \left(\mathfrak{A},\beta\right)$
für jede Struktur $\mathfrak{A}$ und Belegung $\beta:X\rightarrow A$
und jeden Ausdruck $\omega$ mit $\mathrm{frei}\left(\omega\right)\subseteq X$.

Für einen $\mathcal{L}\left[\sigma\right]$-Term $t$ ist $\left\llbracket t\right\rrbracket \left(\mathfrak{A},\beta\right)\in A$
ein Element des Universums. Für eine $\mathcal{L}\left[\sigma\right]$-Formel
$\varphi$ ist $\left\llbracket \varphi\right\rrbracket \left(\mathfrak{A},\beta\right)\in\left\{ 0,1\right\} $
ein Wahrheitswert.\end{defn}
\begin{notation}
Wir verwenden den Begriff ,,Ausdruck`` als Oberbegriff der Formeln
und Terme einer Logik, und bezeichnen Ausdrücke mit dem Buchstaben
$\omega$. Terme werden mit kleinen Buchstaben benannt, und Formeln
mit den Buchstaben $\varphi$, $\psi$ oder $\chi$.\end{notation}
\begin{defn}
Für eine Formel $\varphi$ und ein Tupel $\bar{x}\in\mathbf{var}^{k}$
mit $\mathrm{frei}\left(\varphi\right)=\left\{ x_{1},\cdots,x_{k}\right\} $
und $\left|\left\{ x_{1},\cdots,x_{k}\right\} \right|=k$ nennen wir
das Tupel $\bar{x}=\left(x_{1}\cdots x_{k}\right)$ ein \textbf{Argument
}von $\varphi$. Verschiedene Argumente von $\varphi$ unterscheiden
sich nur in der Reihenfolge der Variablen. Durch die Notation $\varphi\left(\bar{x}\right)$
legen wir ein beliebiges Argument $\bar{x}$ für $\varphi$ fest.

Die \textbf{Stelligkeit }einer logischen Formel (beziehungsweise ihrer
Argumente) bezeichne die Anzahl der frei vorkommenden Variablen: Für
$\varphi\left(\bar{x}\right)$ gelte: 
\[
\mathrm{ar}\left(\varphi\right)=\mathrm{ar}\left(\bar{x}\right)=\left|\mathrm{frei}\left(\varphi\right)\right|
\]


Ein \textbf{Satz} sei eine Formel ohne freie Variablen.
\end{defn}
Mit $\mathtt{MF}\left(\omega\right)$ bezeichnen wir die maximale
Anzahl freier Variablen jedes Teilausdrucks von $\omega$.
\begin{defn}
Für eine $k$-stellige Formel $\varphi$ und eine Belegung $\beta:\mathrm{frei}\left(\varphi\right)\rightarrow A$
schreiben wir $\mathfrak{A}\models\varphi^{\beta}$ genau dann wenn
$\left\llbracket \varphi\right\rrbracket \left(\mathfrak{A},\beta\right)=1$.

Für $\varphi\left(\bar{x}\right)$ und $\bar{a}\in A^{\mathrm{ar}\left(\bar{x}\right)}$
schreiben wir $\left\llbracket \varphi\right\rrbracket \left(\mathfrak{A},\bar{a}\right)$
anstelle von $\left\llbracket \varphi\right\rrbracket \left(\mathfrak{A},\left(\bar{x}\mapsto\bar{b}\right)\right)$,
und $\mathfrak{A}\models\varphi\left[\bar{a}\right]$ anstelle von
$\mathfrak{A}\models\varphi^{\bar{x}\mapsto\bar{a}}$.

Entsprechend sei 
\[
q_{\varphi\left(\bar{x}\right)}\left(\mathfrak{A}\right)\coloneqq\left\{ \bar{a}\in A^{\mathrm{ar}\left(\bar{x}\right)}\mid\mathfrak{A}\models\varphi\left[\bar{a}\right]\right\} 
\]
die Relation aller $\varphi$ erfüllenden Tupel.
\end{defn}
Somit beschreibt jede $\mathcal{L}\left[\sigma\right]$-Formel $\varphi\left(\bar{x}\right)$
eine $\sigma$-Anfrage $q_{\varphi\left(\bar{x}\right)}$, und jeder
Satz eine $\sigma$-Eigenschaft. Da die Reihenfolge der Spalten der
Relation von der Wahl des Arguments $\bar{x}$ abhängt, wird es durch
$q_{\varphi\left(\bar{x}\right)}$ mit angegeben.

In manchen Fällen möchten wir einige Variablen einer Formel belegen
und sie erst dann als Anfrage auswerten.
\begin{defn}
Für eine Formel $\varphi$ und eine Belegung $\beta:X\rightarrow A$
mit $\mathrm{frei}\left(\varphi\right)\nsubseteq X$ sei $\varphi^{\beta}$
ein \textbf{partiell belegter} Ausdruck; es sei $\mathrm{frei}\left(\varphi^{\beta}\right)=\mathrm{frei}\left(\varphi\right)\backslash X$.

Für $\beta':\mathrm{frei}\left(\varphi^{\beta}\right)\rightarrow A$
bezeichne $\left\llbracket \varphi^{\beta}\right\rrbracket \left(\mathfrak{A},\beta'\right)$
die Auswertung $\left\llbracket \varphi\right\rrbracket \left(\mathfrak{A},\beta\cup\beta'\right)$.
Für ein Argument $\bar{x}'$ von $\varphi^{\beta}$ definieren wir
die folgende Anfrage: 
\[
q_{\varphi^{\beta}\left(\bar{x}'\right)}\coloneqq\left\{ \bar{a}\in A^{\ell}\mid\mathfrak{A}\models\varphi^{\beta}\left[\bar{a}\right]\right\} 
\]

\end{defn}

\begin{defn}
Für eine $\mathcal{L}\left[\sigma\right]$-Formel $\varphi$ und $n\in\mathbb{N}$
drücke $\models_{n}\varphi$ aus, dass diese von allen $\sigma$-Strukturen
$\mathfrak{A}\in\mathbf{FIN}^{\left(n\right)}\left(\sigma\right)$
der Größe $n$ unter allen Belegungen erfüllt wird. Die Notation $\models_{\mathrm{fin}}\varphi$
drücke aus, dass $\varphi$ von allen endlichen $\sigma$-Strukturen
$\mathfrak{A}\in\mathbf{FIN}\left(\sigma\right)$ unter allen Belegungen
erfüllt wird.

Falls $\models_{n}\left(\varphi\leftrightarrow\psi\right)$, so heißen
$\varphi$ und $\psi$ $n$-\textbf{äquivalent}. Insbesondere bedeutet
dies, dass $\varphi$ und $\psi$ die gleiche Anfrage $q_{\varphi\left(\bar{x}\right)}=q_{\psi\left(\bar{x}\right)}$
auf Strukturen der Größe $n$ definieren.
\end{defn}

\section{Die Logik erster Stufe}
\begin{defn}
\label{def:fo}Für eine relationale Signatur $\sigma$ sind die Syntax
und Semantik der Logik erster Stufe $\mathrm{FO}\left[\sigma\right]$
wie folgt definiert.\end{defn}
\begin{elabeling}{00.00.0000}
\item [{(TV)}] Für jede Variable $x\in\mathbf{var}$ ist $x$ ein $\mathrm{FO}\left[\sigma\right]$-Term.
\[
\mathrm{frei}\left(x\right)=\mathrm{var}\left(x\right)\coloneqq\left\{ x\right\} 
\]
\[
\left\llbracket x\right\rrbracket \left(\mathfrak{A},\beta\right)\coloneqq\beta x
\]

\item [{(AR)}] Für jedes Relationssymbol $R/k\in\sigma$ und jedes $k$-Tupel
von $\mathrm{FO}\left[\sigma\right]$-Termen $\bar{x}$ ist $R\bar{x}$
eine $\mathrm{FO}\left[\sigma\right]$-Formel.
\begin{eqnarray*}
\mathrm{frei}\left(R\bar{x}\right)\coloneqq\bigcup_{i=1}^{k}\mathrm{frei}\left(x_{i}\right) &  & \mathrm{var}\left(R\bar{x}\right)\coloneqq\bigcup_{i=1}^{k}\mathrm{var}\left(x_{i}\right)
\end{eqnarray*}
\begin{eqnarray*}
\left\llbracket R\bar{x}\right\rrbracket \left(\mathfrak{A},\beta\right) & \coloneqq & \left[R^{\mathfrak{A}}\right]\left(\left\llbracket x_{1}\right\rrbracket \left(\mathfrak{A},\beta\right),\cdots,\left\llbracket x_{k}\right\rrbracket \left(\mathfrak{A},\beta\right)\right)
\end{eqnarray*}

\item [{(AE)}] Für zwei $\mathrm{FO}\left[\sigma\right]$-Terme $x_{1},x_{2}$
ist $x_{1}\dot{=}x_{2}$ eine $\mathrm{FO}\left[\sigma\right]$-Formel.
\begin{eqnarray*}
\mathrm{frei}\left(x_{1}\dot{=}x_{2}\right)\coloneqq\bigcup_{i=1}^{2}\mathrm{frei}\left(x_{i}\right) &  & \mathrm{var}\left(x_{1}\dot{=}x_{2}\right)\coloneqq\bigcup_{i=1}^{2}\mathrm{var}\left(x_{i}\right)
\end{eqnarray*}
\begin{eqnarray*}
\left\llbracket x\dot{=}y\right\rrbracket \left(\mathfrak{A},\beta\right) & \coloneqq & \begin{cases}
1 & \mathrm{falls}\,\left\llbracket x\right\rrbracket \left(\mathfrak{A},\beta\right)=\left\llbracket y\right\rrbracket \left(\mathfrak{A},\beta\right)\\
0 & \mathrm{sonst}
\end{cases}
\end{eqnarray*}

\item [{(N)}] Für eine $\mathrm{FO}\left[\sigma\right]$-Formel $\varphi$
ist $\neg\varphi$ eine $\mathrm{FO}\left[\sigma\right]$-Formel.
\begin{eqnarray*}
\mathrm{frei}\left(\neg\varphi\right)\coloneqq\mathrm{frei}\left(\varphi\right) &  & \mathrm{var}\left(\neg\varphi\right)\coloneqq\mathrm{var}\left(\varphi\right)
\end{eqnarray*}
\[
\left\llbracket \neg\varphi\right\rrbracket \left(\mathfrak{A},\beta\right)\coloneqq1-\left\llbracket \varphi\right\rrbracket \left(\mathfrak{A},\beta\right)
\]

\item [{(J)}] Für $k\geqslant2$ $\mathrm{FO}\left[\sigma\right]$-Formeln
$\varphi_{1},\cdots,\varphi_{k}$ und einen Junktor $\gamma\in\left\{ \wedge,\vee,\rightarrow,\leftrightarrow\right\} $
(mit $k=2$ für $\gamma\in\left\{ \rightarrow,\leftrightarrow\right\} $)
ist auch $\left(\varphi_{1}\gamma\cdots\gamma\varphi_{k}\right)$
eine $\mathrm{FO}\left[\sigma\right]$-Formel. 
\begin{eqnarray*}
\mathrm{frei}\left(\varphi_{1}\gamma\cdots\gamma\varphi_{k}\right)\coloneqq\bigcup_{i=1}^{k}\mathrm{frei}\left(\varphi_{i}\right) &  & \mathrm{var}\left(\varphi_{1}\gamma\cdots\gamma\varphi_{k}\right)\coloneqq\bigcup_{i=1}^{k}\mathrm{var}\left(\varphi_{i}\right)
\end{eqnarray*}
\begin{eqnarray*}
\left\llbracket \varphi_{1}\wedge\cdots\wedge\varphi_{k}\right\rrbracket \left(\mathfrak{A},\beta\right) & \coloneqq & \min_{1\leqslant i\leqslant k}\left\llbracket \varphi_{i}\right\rrbracket \left(\mathfrak{A},\beta\right)\\
\left\llbracket \varphi_{1}\vee\cdots\vee\varphi_{k}\right\rrbracket \left(\mathfrak{A},\beta\right) & \coloneqq & \max_{1\leqslant i\leqslant k}\left\llbracket \varphi_{i}\right\rrbracket \left(\mathfrak{A},\beta\right)\\
\left\llbracket \varphi_{1}\rightarrow\varphi_{2}\right\rrbracket \left(\mathfrak{A},\beta\right) & \coloneqq & \left\llbracket \neg\varphi_{1}\vee\varphi_{2}\right\rrbracket \left(\mathfrak{A},\beta\right)\\
\left\llbracket \varphi_{1}\leftrightarrow\varphi_{2}\right\rrbracket \left(\mathfrak{A},\beta\right) & \coloneqq & \left\llbracket \left(\varphi_{1}\rightarrow\varphi_{2}\right)\wedge\left(\varphi_{2}\rightarrow\varphi_{1}\right)\right\rrbracket \left(\mathfrak{A},\beta\right)
\end{eqnarray*}

\item [{(Q)}] Für einen Quantor $Q\in\left\{ \exists,\forall\right\} $,
eine Variable $x\in\mathbf{var}$ und eine $\mathrm{FO}\left[\sigma\right]$-Formel
$\varphi$ ist $Qx\varphi$ eine $\mathrm{FO}\left[\sigma\right]$-Formel.
\begin{eqnarray*}
\mathrm{frei}\left(Qx\varphi\right)\coloneqq\mathrm{frei}\left(\varphi\right)\backslash\left\{ x\right\}  &  & \mathrm{var}\left(Qx\varphi\right)\coloneqq\mathrm{var}\left(\varphi\right)\cup\left\{ x\right\} 
\end{eqnarray*}
\begin{eqnarray*}
\left\llbracket \exists x\varphi\right\rrbracket \left(\mathfrak{A},\beta\right) & \coloneqq & \max_{a\in A}\left(\left\llbracket \varphi\right\rrbracket \left(\mathfrak{A},\beta_{\backslash\left\{ x\right\} }\cup\left(x\mapsto a\right)\right)\right)\\
\left\llbracket \forall x\varphi\right\rrbracket \left(\mathfrak{A},\beta\right) & \coloneqq & \min_{a\in A}\left(\left\llbracket \varphi\right\rrbracket \left(\mathfrak{A},\beta_{\backslash\left\{ x\right\} }\cup\left(x\mapsto a\right)\right)\right)
\end{eqnarray*}
Ohne Beschränkung der Allgemeinheit gelte für $Qx\varphi$ stets $x\in\mathrm{frei}\left(\varphi\right)$,
denn $Qx\varphi\equiv Qx\left(x\dot{=}x\wedge\varphi\right)$.
\end{elabeling}
Wir kürzen $Qx_{1}\cdots Qx_{k}\varphi$ durch $Q\bar{x}\varphi$
und $\bigwedge_{i=1}^{k}\left(x_{i}=y_{i}\right)$ durch $\bar{x}=\bar{y}$
ab. Im folgenden werden wir im Allgemeinen Formeln ohne Implikations-Pfeile
betrachten.
\begin{defn}
Eine $\mathrm{FO}\left[\sigma\right]$-Formel sei \textbf{implikationsfrei
}wenn sie keine Teilformel der Form $\left(\varphi\rightarrow\psi\right)$
oder $\left(\varphi\leftrightarrow\psi\right)$ enthält.
\end{defn}
Weil $\left(\varphi\rightarrow\psi\right)\equiv\left(\neg\varphi\vee\psi\right)$
und $\left(\varphi\leftrightarrow\psi\right)\equiv\left(\varphi\wedge\psi\right)\vee\left(\neg\varphi\wedge\neg\psi\right)$,
sind alle $\mathrm{FO}\left[\sigma\right]$-Formeln äquivalent zu
implikationsfreien $\mathrm{FO}\left[\sigma\right]$-Formeln. Hierbei
entsteht ein fester Zuwachs in der Länge der Formel $\left\Vert \varphi\right\Vert $,
der die Datenkomplexität unberührt lässt.


\begin{defn}
\textbf{\label{def:qr}Quantorenrang}

Der Quantorenrang einer Formel sei die maximale Anzahl der geschachtelten
Quantoren:
\[
\begin{array}{cc}
\mathrm{qr}\left(R\bar{x}\right)=\mathrm{qr}\left(x_{1}\dot{=}x_{2}\right)=0 & \mathrm{qr}\left(\psi_{1}\gamma\cdots\gamma\psi_{k}\right)=\max_{i=1}^{k}\mathrm{qr}\left(\psi_{i}\right)\\
\mathrm{qr}\left(\exists x\psi\right)=\mathrm{qr}\left(\forall x\psi\right)=\mathrm{qr}\left(\psi\right)+1
\end{array}
\]

\end{defn}

\begin{defn}
\label{def:m-equiv}Zwei $\sigma$-Strukturen $\mathfrak{A}$ und
$\mathfrak{B}$ heißen $m$-äquivalent ($\mathfrak{A}\equiv_{m}\mathfrak{B}$,
wenn für alle $\mathrm{FO}\left[\sigma\right]$-Sätze $\varphi$ mit
$\mathrm{qr}\left(\varphi\right)\leqslant m$ gilt:
\[
\mathfrak{A}\models\varphi\Longleftrightarrow\mathfrak{B}\models\varphi
\]

\end{defn}

\section{Logiken mit Fixpunkt-Erweiterung}

Wir führen eine Erweiterung ein, die es erlaubt, den iterativen Fixpunkt
einer selbstreferenziellen logischen Formel zu definieren.
\begin{defn}
Eine Logik $\mathcal{L}$ erweitert die Logik $\mathcal{L}'$, wenn
sie die Syntax und Semantik von $\mathcal{L}'$ übernimmt, und zusätzliche
Produktionen einführt.
\end{defn}
Als erstes definieren wir einen neuen Typ von Variablen.
\begin{defn}
Sei $\mathbf{var}_{2}$ die Menge aller Relationsvariablen. Jede solche
Variable $X\in\mathbf{var}_{2}$ besitzt eine Stelligkeit $\mathrm{ar}\left(X\right)=k\in\mathbb{N}_{\geqslant1}$;
diese wird auch durch $X/k\in\mathbf{var}_{2}$ notiert. Die Funktionen
$\mathrm{frei}$ und $\mathrm{var}$, so wie die Belegungen $\beta$,
werden auf $\mathbf{var}\uplus\mathbf{var}_{2}$ erweitert.
\begin{eqnarray*}
\mathrm{frei}\left(\varphi\right),\mathrm{var}\left(\varphi\right) & \subseteq & \mathbf{var}\uplus\mathbf{var}_{2}\\
\beta:\mathrm{frei}\left(\varphi\right) & \rightarrow & A\cup\bigcup_{k\in\mathbb{N}}A^{k}\\
\beta X & \subseteq & A^{\mathrm{ar}\left(X\right)}\,\mathrm{f\ddot{u}r}\,X\in\mathbf{var}_{2}
\end{eqnarray*}

\end{defn}
Wir möchten syntaktisch garantieren, dass die Iteration der Formel
eine monoton wachsende Relation berechnet. Dafür wird verlangt, dass
die selbstreferenzielle Relationsvariable nicht negiert vorkommt.
\begin{defn}
\textbf{Positivität}

Wir definieren die (nicht disjunkten) Mengen der $X$-positiven und
$X$-negativen $\mathcal{L}\left[\sigma\right]$-Formeln für $X\in\mathbf{var}_{2}$
wie folgt:
\begin{itemize}
\item Jeder $\mathcal{L}\left[\sigma\right]$-Ausdruck $\omega$ mit $X\notin\mathrm{frei}\left(\omega\right)$
ist sowohl $X$-positiv als auch $X$-negativ.
\item Für jede $X$-positive Formel $\varphi$ ist $\neg\varphi$ $X$-negativ,
und umgekehrt.
\item Für einen Junktor $\gamma\in\left\{ \wedge,\vee\right\} $ und $k\geqslant2$
$X$-positive (beziehungsweise $X$-negative) Formeln $\varphi_{1},\cdots,\varphi_{k}$
ist $\left(\varphi_{1}\gamma\cdots\gamma\varphi_{k}\right)$ ebenfalls
$X$-positiv (beziehungsweise $X$-negativ).
\item Für einen Quantor $Q\in\left\{ \exists,\forall\right\} $, eine Variable
$x\in\mathbf{var}$ und eine $X$-positive (beziehungsweise $X$-negative)
Formel $\varphi$ ist $Qx\varphi$ ebenfalls $X$-positiv (beziehungsweise
$X$-negativ).
\end{itemize}
\end{defn}
Nun definieren wir die Fixpunkt-Erweiterung.
\begin{defn}
\label{def:lfp}Für eine Logik $\mathcal{L}$ und eine relationale
Signatur $\sigma$ erweitert $\mathrm{LFP}\left(\mathcal{L}\right)\left[\sigma\right]$
die Logik $\mathcal{L}\left[\sigma\right]$ wie folgt:\end{defn}
\begin{elabeling}{00.00.0000}
\item [{(AV)}] Für eine Relationsvariable $X/k\in\mathbf{var}_{2}$ und
ein $k$-Tupel $\bar{x}$ von $X$-positiven $\mathrm{LFP}\left(\mathcal{L}\right)\left[\sigma\right]$-Termen
ist $X\bar{x}$ eine $X$-positive $\mathrm{LFP\left(\mathcal{L}\right)}\left[\sigma\right]$-Formel.
\begin{eqnarray*}
\mathrm{frei}\left(X\bar{x}\right) & \coloneqq & \left\{ X\right\} \cup\bigcup_{i=1}^{k}\mathrm{frei}\left(x_{i}\right)\\
\mathrm{var}\left(X\bar{x}\right) & \coloneqq & \left\{ X\right\} \cup\bigcup_{i=1}^{k}\mathrm{var}\left(x_{i}\right)\\
\left\llbracket X\bar{x}\right\rrbracket \left(\mathfrak{A},\beta\right) & \coloneqq & \left[\beta X\right]\left(\beta\bar{x}\right)\\
 & \mathrm{mit} & \beta X\subseteq A^{k},\\
 &  & \beta\bar{x}\in A^{k}
\end{eqnarray*}

\item [{(LFP)}] Für eine Relationsvariable $X/k\in\mathbf{var}_{2}$, eine
$X$-positive $\mathrm{LFP}\left(\mathcal{L}\right)\left[\sigma\right]$-Formel
$\psi$, ein Tupel $\bar{x}\in\mathbf{var}^{k}$ und ein $k$-Tupel
$\bar{y}$ von $X$-positiven $\mathrm{\mathrm{LFP}\left(\mathcal{L}\right)}\left[\sigma\right]$-Termen
ist $\varphi=\left[\mathrm{lfp}_{X,\bar{x}}\psi\right]\left(\bar{y}\right)$
eine $X$-positive $\mathrm{LFP}\left(\mathrm{\mathcal{L}}\right)\left[\sigma\right]$-Formel.
\begin{eqnarray*}
\mathrm{frei}\left(\varphi\right) & = & \mathrm{frei}\left(\psi\right)\backslash\left\{ X,x_{1},\cdots,x_{k}\right\} \cup\bigcup_{i=1}^{k}\mathrm{frei}\left(y_{i}\right)\\
\mathrm{var}\left(\varphi\right) & = & \mathrm{var}\left(\psi\right)\cup\left\{ X,x_{1},\cdots,x_{k}\right\} \cup\bigcup_{i=1}^{k}\mathrm{var}\left(y_{i}\right)
\end{eqnarray*}
Für eine Belegung $\beta:\mathrm{frei}\left(\varphi\right)\rightarrow A$
prüft $\varphi=\left[\mathrm{lfp}_{X,\bar{x}}\psi\right]\left(\bar{y}\right)$,
ob die Belegung des Tupels $\bar{y}$ im kleinsten Fixpunkt des Relationssymbols
$X$ liegt. 
\begin{eqnarray*}
\beta' & \coloneqq & \beta_{\mid\mathrm{frei}\left(\psi\right)\backslash\left\{ X,x_{1},\cdots,x_{k}\right\} }\\
\left\llbracket \left[\mathrm{lfp}_{X,\bar{x}}\psi\right]\left(\bar{y}\right)\right\rrbracket \left(\mathfrak{A},\beta\right) & \coloneqq & \left\llbracket X\bar{y}\right\rrbracket \left(\mathfrak{A},\beta\cup\left(X\mapsto\mathrm{lfp}_{X,\bar{x}}\left(\psi\right)\right)\right)
\end{eqnarray*}
Im folgenden wird eine Berechnung definiert, die den kleinsten Fixpunkt
$\mathrm{lfp}_{X,\bar{x}}\left(\psi\right)$ iterativ bestimmt.
\end{elabeling}
Ohne Beschränkung der Allgemeinheit sei $\left\{ x_{1},\cdots,x_{k}\right\} \subseteq\mathrm{frei}\left(\psi\right)$,
denn analog zu Definition \ref{def:fo} ist $\psi\equiv\left(\bar{x}=\bar{x}\wedge\psi\right)$.
Die nicht durch den Operator gebundenen Variablen $P\coloneqq\mathrm{frei}\left(\psi\right)\backslash\left\{ x_{1},\cdots,x_{k}\right\} \subseteq\mathrm{frei}\left(\varphi\right)$
heißen \textbf{Parameter} der Fixpunkt-Operation.

Für eine Parameter-Belegung $\beta:P\rightarrow A$ sei $F_{\beta}$
die folgende Abbildung: 
\begin{eqnarray*}
F_{\beta} & : & 2^{A^{k}}\rightarrow2^{A^{k}}\\
F_{\beta}\left(Y\right) & \coloneqq & \left\{ \bar{a}\in A^{k}\mid\mathfrak{A}\models\psi^{\beta\cup\left(X\mapsto Y\right)}\left[\bar{a}\right]\right\} 
\end{eqnarray*}
Das heißt: $F_{\beta}\left(Y\right)$ ist das Anfrageergebnis von
$\varphi$ auf $\mathfrak{A}$ unter der Belegung der Parameter mit
$\beta$ und der Variable $X$ mit der Relation $Y$.

Aus der $X$-Positivität folgt nach \cite{Gurevich1986,Libkin2012}
die Monotonie von $F_{\beta}$
\[
A\subseteq B\Rightarrow F_{\beta}\left(A\right)\subseteq F_{\beta}\left(B\right)
\]
und daher induktiv die Existenz eines Fixpunkts $F^{\infty}\left(\emptyset\right)$,
der nach höchstens $\left|A^{k}\right|$ Schritten erreicht wird:
\[
\emptyset\subseteq F_{\beta}\left(\emptyset\right)\subseteq\cdots\subseteq F_{\beta}^{\infty}\left(\emptyset\right)\subseteq A^{k}
\]


Für jeden anderen Fixpunkt $Y'$ gilt $\emptyset\subseteq Y'$, und
per Induktion auch $F^{n}\left(\emptyset\right)\subseteq F^{n}\left(Y'\right)=Y'$.
Daher ist $F^{\infty}\left(\emptyset\right)=\mathrm{lfp}_{X,\bar{x}}\left(\psi\right)$
der kleinste Fixpunkt.

Im folgenden wird die Logik $\mathrm{LFP}\left(\mathrm{FO}\right)$
durch $\mathrm{LFP}$ abgekürzt. Ferner werden wir uns auf das \emph{parameterfreie}
Fragment der Logik beschränken, was (bis auf einen Zuwachs in der
Anzahl der Variablen und Länge der Formel) die Allgemeinheit nicht
einschränkt.
\begin{defn}
\label{def:fp-paramfree}Eine $\mathrm{LFP}\left[\sigma\right]$-Formel
$\varphi$ ist \textbf{parameterfrei}, falls der Fixpunktoperator
stets alle Variablen bindet - das heißt, für jede Teilformel der Form
$\left[\mathrm{lfp}_{X,\bar{x}}\psi\right]\left(\bar{y}\right)$ gilt:
\[
\mathrm{frei}\left(\psi\right)\subseteq\left\{ X,x_{1},\cdots,x_{\mathrm{ar}\left(X\right)}\right\} 
\]
\end{defn}
\begin{prop}
\label{prop:fp-paramfree}Jede $\mathrm{LFP}\left[\sigma\right]$-Formel
$\varphi$ kann (unter Zuwachs der Länge $\left\Vert \varphi\right\Vert $
und Größe $\left|\mathrm{var}\left(\varphi\right)\right|$) in eine
parameterfreie $\mathrm{LFP}\left[\sigma\right]$-Formel $\varphi'$
übersetzt werden.\cite{Zaid,Grohe2005,Dziembowski96bounded-variablefixpoint}\end{prop}
\begin{example}
Die folgende $\mathrm{LFP}\left[\left\{ E\right\} \right]$-Formel
$\varphi\left(u,v\right)$ ist erfüllt, wenn $u$ und $v$ durch einen
Weg beliebiger Länge verbunden sind: 
\[
\varphi\left(u,v\right)\coloneqq\left[\mathrm{lfp}_{T,\left(x,y\right)}\,\left(\exists z\,\left(E\left(x,z\right)\wedge T\left(z,y\right)\right)\vee x\dot{=}y\right)\right]\left(u,v\right)
\]
\end{example}
\begin{defn}
Eine etwas robustere, aber äquivalente, Definition der Fixpunktlogik
verwendet den inflationären Fixpunktoperator. Anstelle der Positivität
einer Formel in einer Relationsvariable betrachten wir mit $\left[\mathrm{ifp}_{X,\bar{x}}\psi\right]\left(\bar{y}\right)$
implizit die Formel $\left[\mathrm{lfp}_{X,\bar{x}}\left(X\bar{x}\vee\psi\right)\right]\left(\bar{y}\right)$,
die uns eine inflationäre Iteration garantiert:
\[
F_{\beta}\left(Y\right)=Y\cup q_{\psi\left(\bar{x}\right)}^{\beta\cup\left(X\rightarrow Y\right)}\left(\mathfrak{A}\right)\supseteq Y
\]


In diesem Fall muss $\psi$ nicht mehr $X$-positiv sein.
\end{defn}

\section{Logiken mit numerischen Erweiterungen}


\subsection{Disjunkte Orakel}

Eine Erweiterung um ein numerisches Orakel fügt einer Logik eine Anzahl
von Relationssymbolen hinzu, die für $\mathfrak{A}\in\mathbf{FIN}\left(\sigma\right)$
eine feste Interpretation über einem von $A$ disjunkten numerischen
Universum $\left[0,\left|A\right|\right]$ erhalten.
\begin{defn}
\textbf{$\eta$-Orakel, $\mathcal{L}+\Upsilon$-Logik}

Sei $\eta$ eine relationale Signatur. Ein $\eta$-Orakel $\Upsilon:\mathbb{N}\rightarrow\mathbf{FIN}_{\leqslant}^{0}\left(\eta\right)$
ist eine Funktion, die jeder natürlichen Zahl $n$ eine geordnete
$\left(\eta\uplus\left\{ \leqslant\right\} \right)$-Struktur $\Upsilon\left(n\right)$
über $\left[0,n\right]$ zuweist.

Sei $\sigma$ eine von $\eta\uplus\left\{ \leqslant\right\} $ disjunkte
relationale Signatur und $\mathcal{L}$ eine Logik (zum Beispiel $\mathrm{FO}$
oder $\mathrm{LFP}$). Für ein $\eta$-Orakel $\Upsilon$ ist die
Syntax der $\left(\mathcal{L}+\Upsilon\right)\left[\sigma\right]$-Logik
die der Logik $\mathcal{L}\left[\sigma\uplus\eta\uplus\left\{ \leqslant\right\} \right]$.

Für eine endliche $\sigma$-Struktur $\mathfrak{A}$ mit $A\cap\left[0,\left|A\right|\right]=\emptyset$
und eine Belegung $\beta:\mathbf{var}\rightarrow A\uplus\left[0,\left|A\right|\right]$
werden $\left(\mathcal{L}+\Upsilon\right)$-Ausdrücke auf der disjunkten
Vereinigung von $\mathfrak{A}$ mit der entsprechenden Orakelstruktur
$\Upsilon\left(\left|A\right|\right)$ ausgewertet:
\[
\left\llbracket \varphi\right\rrbracket \left(\mathfrak{A},\beta\right)\coloneqq\left\llbracket \varphi\right\rrbracket \left(\mathfrak{A}\uplus\Upsilon\left(\left|A\right|\right),\beta\right)
\]
\end{defn}
\begin{notation}
Nach unserem Begriff der logischen Erweiterung ist die Bezeichnung
$\mathrm{LFP}\left(\mathcal{L}+\Upsilon\right)$ gleichbedeutend mit
$\mathrm{LFP}\left(\mathcal{L}\right)+\Upsilon$. Im folgenden werden
wir allgemein die erste Bezeichnung verwenden, aber weiterhin $\mathrm{LFP}\left(\mathrm{FO}\right)+\Upsilon$
durch $\mathrm{LFP}+\Upsilon$ abkürzen.\end{notation}
\begin{defn}
\textbf{Uniformität}

Wir nennen ein $\eta$-Orakel \textbf{$\mathcal{K}$-uniform} (für
eine Komplexitätsklasse $\mathcal{K}$) wenn die Berechnung der Repräsentation
von $\Upsilon\left(n\right)$ bei Eingabe von $\overset{n}{\overbrace{1\cdots1}}$
in $\mathcal{K}$ ist.

Insbesondere sei $P$ die Klasse der $\mathrm{poly}\left(n\right)$-zeitbeschränkten,
und $\mathrm{LOGSPACE}$ die Klasse der $\mathcal{O}\left(\log n\right)$-platzbeschränkten
Turingmaschinen. $P/\mathrm{poly}$ sei die Klasse der $\mathrm{poly}\left(n\right)$-zeitbeschränkten
Turingmaschinen, die eine $\mathrm{poly}\left(n\right)$-beschränkte
Orakel-Eingabe erhalten.
\end{defn}
Wir definieren die folgenden drei numerischen Orakel für die reine
Ordnung, für Arithmetik, und für nicht berechenbare Prädikate.
\begin{defn}
\textbf{\label{def:ord}}Sei $\mathbf{ORD}:\mathbb{N}\rightarrow\mathbf{FIN}_{<}^{0}\left(\emptyset\right)$
ein $\emptyset$-Orakel, so dass das für $n\in\mathbb{N}$ die geordnete
$\emptyset$-Struktur gilt: 
\[
\mathbf{ORD}\left(n\right)\coloneqq\left(\left[0,n\right],\leqslant_{\mid\left[0,n\right]}\right)\in\mathbf{FIN}_{<}^{\left[0,n\right]}\left(\emptyset\right)
\]

\end{defn}

\begin{defn}
\textbf{\label{def:bit}}Sei $\mathbf{BIT}:\mathbb{N}\rightarrow\mathbf{FIN}_{<}^{0}\left(\left\{ \mathtt{BIT}\right\} \right)$
ein $\left\{ \mathtt{BIT}\right\} $-Orakel, wobei das Prädikat $\mathtt{BIT}\left(a,b\right)$
ausdrückt, dass das $b$te Bit der Binärdarstellung von $a$ den Wert
$1$ hat. 
\begin{eqnarray*}
\mathcal{N}_{\mathrm{bit}} & \coloneqq & \left(\mathbb{N},\leqslant,\mathtt{BIT}^{\mathcal{N}}\right)\\
\mathtt{BIT}^{\mathcal{N}} & \coloneqq & \left\{ \left(a,b\right)\in\mathbb{N}^{2}\mid a=\Sigma_{i=0}^{\left\lceil \log a\right\rceil }x_{i}2^{i},\,\bar{x}\in\left\{ 0,1\right\} ^{\left\lceil \log a\right\rceil },\,x_{b}=1\right\} \\
\mathbf{BIT}\left(n\right) & \coloneqq & \left(\mathcal{N}_{\mathrm{bit}}\right)_{\mid\left[0,n\right]}\in\mathbf{FIN}_{<}^{\left[0,n\right]}\left(\left\{ \mathtt{BIT}\right\} \right)
\end{eqnarray*}

\end{defn}

\begin{defn}
\label{def:arb}Sei $\eta_{\mathrm{arb}}=\left\{ R_{X}\mid X\in\bigcup_{k\in\mathbb{N}}2^{\mathbb{N}^{k}}\right\} $
eine unendliche Signatur, die für jede beliebige Relation $X\subseteq\mathbb{N}^{k}$
mit $k\in\mathbb{N}$ auf den natürlichen Zahlen ein Symbol $R_{X}/k$
enthält, und sei $\mathcal{N}_{\mathrm{arb}}$ die $\eta_{\mathrm{arb}}$-Struktur
über $\mathbb{N}$, die diese Symbole interpretiert. Dann sei $\mathbf{ARB}:\mathbb{N}\rightarrow\mathbf{FIN}_{<}^{0}\left(\eta_{\mathrm{arb}}\right)$
ein $\eta_{\mathrm{arb}}$-Orakel, das die endlichen Anfangsstücke
dieser Relationen ausgibt:
\begin{eqnarray*}
\mathcal{N}_{\mathrm{arb}} & \coloneqq & \left(\mathbb{N},\leqslant,\left(R_{X}\mapsto X\right)_{R_{X}\in\eta_{\mathrm{arb}}}\right)\\
\mathbf{ARB}\left(n\right) & \coloneqq & \left(\mathcal{N}_{\mathrm{arb}}\right)_{\mid\left[0,n\right]}\in\mathbf{FIN}_{<}^{\left[0,n\right]}\left(\eta_{\mathrm{arb}}\right)
\end{eqnarray*}


Hierbei ist leicht nachweisbar: $\mathbf{ORD}$ und $\mathbf{BIT}$
sind $\mathrm{LOGSPACE}$-uniform, und $\mathbf{ARB}$ ist $P/\mathrm{poly}$-uniform.
\end{defn}

\subsection{Zähl-Erweiterungen}

Wir führen mehrere syntaktische Erweiterungen der Logik $\mathrm{FO}+\Upsilon$
ein, die es erlauben, erfüllende Belegungen einer Variable zu zählen:
Den Zählterm $\#$, den Zählquantor $\exists^{=}$, und den Majority-Quantor
$\exists^{\geqslant}$. Es wird nachgewiesen, dass alle drei Erweiterungen
die gleiche Ausdrucksstärke modulo einem festen Zuwachs der Formellänge
haben.
\begin{defn}
\textbf{Zählterm $\#$} (wie in \cite{AD2014}, und Abschnitt 8.4.2
von \cite{EbbinghausFlum} für Fixpunktlogik)

Der Zählterm ist eine zusätzliche Termproduktion, die die erfüllenden
Belegungen einer Formel zählt.

Sei $\mathcal{L}$ eine beliebige Logik, $\eta$ eine relationale
Signatur, und $\Upsilon:\mathbb{N}\rightarrow\mathbf{FIN}_{<}\left(\eta\right)$
ein $\eta$-Orakel.

Die $\left(\mathcal{L}+\Upsilon+\#\right)$-Logik erweitert die $\left(\mathcal{L}+\Upsilon\right)$-Logik
um die folgende Regel:
\begin{elabeling}{00.00.0000}
\item [{(TC)}] Für eine $\left(\mathcal{L}+\Upsilon+\#\right)\left[\sigma\right]$-Formel
$\varphi$ und eine Variable $x\in\mathbf{var}$ ist $\#x\varphi$
ein $\left(\mathcal{L}+\Upsilon+\#\right)\left[\sigma\right]$-Term.
\begin{eqnarray*}
\mathrm{frei}\left(\#x\varphi\right) & \coloneqq & \mathrm{frei}\left(\varphi\right)\backslash\left\{ x\right\} \\
\mathrm{var}\left(\#x\varphi\right) & \coloneqq & \mathrm{var}\left(\varphi\right)\cup\left\{ x\right\} 
\end{eqnarray*}
Auf einer endlichen Struktur $\mathfrak{A}\in\mathbf{FIN}^{\left(n\right)}\left(\sigma\right)$
mit $n\in\mathbb{N}$ und einer Belegung 
\[
\beta:\mathrm{frei}\left(\varphi\right)\backslash\left\{ x\right\} \rightarrow A\uplus\left[0,n\right]
\]
 sei 
\[
\left\llbracket \#x\varphi\right\rrbracket \left(\mathfrak{A},\beta\right)\coloneqq\left|\left\{ a\in A\mid\mathfrak{A}\models\varphi^{\beta\cup\binom{x}{a}}\right\} \right|
\]
die Anzahl der unterschiedlichen Werte $a\in A$, für die $\mathfrak{A}\models\varphi^{\beta\cup\binom{x}{a}}$
gilt.
\end{elabeling}
\end{defn}
\begin{example*}
Diese Erweiterung erlaubt die Definition vieler arithmetischer Operatoren
durch Terme, wie zum Beispiel die positive Differenz:
\begin{eqnarray*}
t_{\mathrm{DIFF}}\left(x,y\right) & \coloneqq & \#_{z}\left(\neg z\leqslant x\wedge z\leqslant y\right)\\
\left\llbracket t_{\mathrm{DIFF}}\right\rrbracket \left(\mathfrak{A},\left(a,b\right)\right) & = & \max\left(b-a,0\right)
\end{eqnarray*}
\end{example*}
\begin{defn}
\textbf{Zählquantor }$\exists^{=}$ (wie in \cite{Schweikardt:2005:AFL:1071596.1071602},
hier aber mit einem disjunkten numerischen Universum)

Der Zählquantor ist eine zusätzlicher Quantor, der die Zahl der erfüllenden
Belegungen einer Formel mit einer Variable vergleicht.

Sei $\mathcal{L}$ eine beliebige Logik, $\eta$ eine relationale
Signatur, und $\Upsilon:\mathbb{N}\rightarrow\mathbf{FIN}_{<}^{\left[0,n\right]}\left(\eta\right)$
ein $\eta$-Orakel.

Die $\mathcal{L}+\Upsilon+\exists^{=}$-Logik erweitert die $\mathcal{L}+\Upsilon$-Logik
um die folgende Regel:
\begin{elabeling}{00.00.0000}
\item [{(QC)}] Für eine $\left(\mathcal{L}+\Upsilon+\exists^{=}\right)\left[\sigma\right]$-Formel
$\varphi$ und zwei Variablen $x,y\in\mathbf{var}$ ist $\exists^{=y}x\varphi$
eine $\left(\mathcal{L}+\Upsilon+\exists^{=}\right)\left[\sigma\right]$-Formel.
\begin{eqnarray*}
\mathrm{frei}\left(\exists^{=y}x\varphi\right) & \coloneqq & \left\{ y\right\} \cup\left(\mathrm{frei}\left(\varphi\right)\backslash\left\{ x\right\} \right)\\
\mathrm{var}\left(\exists^{=y}x\varphi\right) & \coloneqq & \mathrm{var}\left(\varphi\right)\cup\left\{ x,y\right\} 
\end{eqnarray*}
Auf einer endlichen Struktur $\mathfrak{A}\in\mathbf{FIN}^{\left(n\right)}\left(\sigma\right)$
mit einer Belegung 
\[
\beta:\left(\mathrm{frei}\left(\varphi\right)\backslash\left\{ x\right\} \right)\cup\left\{ y\right\} \rightarrow A\cup\left[0,n\right]
\]
gelte: 
\[
\left\llbracket \exists^{=y}x\varphi\right\rrbracket \left(\mathfrak{A},\beta\right)\coloneqq\begin{cases}
1 & \mathrm{falls}\,\,\beta y=\left\{ a\in A\mid\mathfrak{A}\models\varphi^{\beta_{\backslash\left\{ x\right\} }\cup\binom{x}{a}}\right\} \\
0 & \mathrm{sonst}
\end{cases}
\]

\end{elabeling}
\end{defn}

\begin{defn}
\textbf{Majority-Quantor }$\exists^{\geqslant}$ (wie in \cite{EbbinghausFlum}
Abschnitt 3.4, hier aber mit $\exists^{\geqslant x}$ für $x\in\mathbf{var}$
anstelle von unendlich vielen Quantoren $\left(\exists^{\geqslant n}\right)_{n\in\mathbb{N}}$)

Der Majority-Quantor funktioniert wie der Zählquantor und prüft, ob
die Zahl der erfüllenden Belegungen mindestens den Wert einer Variable
erreicht.

Sei $\mathcal{L}$ eine beliebige Logik, $\eta$ eine relationale
Signatur, und $\Upsilon:\mathbb{N}\rightarrow\mathbf{FIN}_{<}^{\left[0,n\right]}\left(\eta\right)$
ein $\eta$-Orakel.

Die $\mathcal{L}+\Upsilon+\exists^{\geqslant}$-Logik erweitert die
$\mathcal{L}+\Upsilon$-Logik um die folgende Regel:
\begin{elabeling}{00.00.0000}
\item [{(QM)}] Für eine $\left(\mathcal{L}+\Upsilon+\exists^{\geqslant}\right)\left[\sigma\right]$-Formel
$\varphi$ und zwei Variablen $x,y\in\mathbf{var}$ ist $\exists^{\geqslant y}x\varphi$
eine $\left(\mathcal{L}+\Upsilon+\exists^{\geqslant}\right)\left[\sigma\right]$-Formel.
\begin{eqnarray*}
\mathrm{frei}\left(\exists^{\geqslant y}x\varphi\right)=\left\{ y\right\} \cup\left(\mathrm{frei}\left(\varphi\right)\backslash\left\{ x\right\} \right) &  & \mathrm{var}\left(\exists^{\geqslant y}x\varphi\right)=\mathrm{var}\left(\varphi\right)\cup\left\{ x,y\right\} 
\end{eqnarray*}
Auf einer endlichen Struktur $\mathfrak{A}\in\mathbf{FIN}^{\left(n\right)}\left(\sigma\right)$
mit einer Belegung 
\[
\beta:\left(\mathrm{frei}\left(\varphi\right)\backslash\left\{ x\right\} \right)\cup\left\{ y\right\} \rightarrow A\cup\left[0,n\right]
\]
 gilt: 
\[
\left\llbracket \exists^{\geqslant y}x\varphi\right\rrbracket \left(\mathfrak{A},\beta\right)\coloneqq\begin{cases}
1 & \mathrm{falls}\,\,\beta y\in\left[0,n\right],\,\beta y\leqslant\left\{ a\in A\mid\mathfrak{A}\models\varphi^{\beta_{\backslash\left\{ x\right\} }\cup\binom{x}{a}}\right\} \\
0 & \mathrm{sonst}
\end{cases}
\]

\end{elabeling}
\end{defn}
\begin{prop}
\label{prop:counting-equal}Die Logiken $\mathcal{L}+\Upsilon+\#$
und $\mathcal{L}+\Upsilon+\exists^{=}$ und $\mathcal{L}+\Upsilon+\exists^{\geqslant}$
sind äquivalent, modulo eines festen Zuwachses in $\left\Vert \varphi\right\Vert $
und $\left|\mathrm{var}\left(\varphi\right)\right|$.\end{prop}
\begin{proof}
Jede $\left(\mathcal{L}+\Upsilon+\#\right)\left[\sigma\right]$-Formel
$\varphi$ ist äquivalent zu einer $\left(\mathcal{L}+\Upsilon+\exists^{=}\right)\left[\sigma\right]$-Formel
$\varphi'$. Dazu ersetzen wir jede ,,pseudo-atomare`` Teilformel,
die einen Zählterm enthält, wie folgt:
\begin{casenv}
\item Falls $\varphi=y\dot{=}\#x\psi$ oder $\varphi=\#x\psi\dot{=}y$ für
$x,y\in\mathbf{var}$, so sei $\varphi'\coloneqq\exists^{=y}x\psi'$.
\item Falls $\varphi=\#x_{1}\psi_{1}\dot{=}\#x_{2}\psi_{2}$ für $x_{1},x_{2}\in\mathbf{var}$,
so sei $y\in\mathbf{var}\backslash\left(\mathrm{frei}\left(\psi_{1}\right)\cup\mathrm{frei}\left(\psi_{2}\right)\right)$
eine neue Variable, und
\[
\varphi'\coloneqq\exists y\left(\exists^{=y}x_{1}\psi_{1}'\wedge\exists^{=y}x_{2}\psi_{2}'\right)
\]

\item Falls $\varphi=R\bar{x}$ für $R/k\in\sigma\cup\eta\cup\left\{ \leqslant\right\} $
und ein $k$-Tupel von $\left(\mathcal{L}+\Upsilon+\#\right)\left[\sigma\right]$-Termen
$\bar{x}$, so sei $\bar{y}\in\left(\mathbf{var}\backslash\bigcup_{i=1}^{k}\mathrm{frei}\left(x_{i}\right)\right)^{k}$
ein Tupel von neuen Variablen, und:
\begin{eqnarray*}
\chi_{i} & \coloneqq & \begin{cases}
\exists^{=y_{i}}z_{i}\psi_{i}' & \mathrm{falls}\,x_{i}=\#z_{i}\psi_{i}\\
y_{i}=x_{i} & \mathrm{sonst}
\end{cases}\\
\varphi' & \coloneqq & \exists\bar{y}\left(R\bar{y}\wedge\bigwedge_{i=1}^{k}\chi_{i}\right)
\end{eqnarray*}

\end{casenv}
Jede $\left(\mathcal{L}+\Upsilon+\exists^{=}\right)\left[\sigma\right]$-Formel
$\varphi$ ist äquivalent zu einer $\left(\mathcal{L}+\Upsilon+\exists^{\geqslant}\right)\left[\sigma\right]$-Formel
$\varphi'$:
\begin{casenv}
\item Falls $\varphi=\exists^{=y}x\psi$, so sei $\psi'$ eine zu $\psi$
äquivalente $\left(\mathcal{L}+\Upsilon+\exists^{\geqslant}\right)\left[\sigma\right]$-Formel,
$z\in\mathbf{var}\backslash\mathrm{frei}\left(\psi\right)$ eine neue
Variable, und: 
\[
\varphi'\coloneqq\forall z\left(\exists^{\geqslant z}x\psi'\leftrightarrow\left(z\leqslant y\right)\right)
\]
Die Formel $\exists^{=y}x\psi$ ist mit $\beta\left(y\right)\in\left[0,n\right]$
erfüllt, genau dann wenn gilt: Die Formel $\exists^{\geqslant z}x\psi$
ist für alle $\beta\left(z\right)\in\left[0,n\right]$ erfüllt, genau
dann wenn $\beta\left(z\right)\leqslant\beta\left(y\right)$.
\end{casenv}
Schließlich ist jede $\left(\mathcal{L}+\Upsilon+\exists^{\geqslant}\right)\left[\sigma\right]$-Formel
$\varphi$ äquivalent zu einer $\left(\mathcal{L}+\Upsilon+\#\right)\left[\sigma\right]$-Formel
$\varphi'$:
\begin{casenv}
\item Falls $\varphi=\exists^{\geqslant y}x\psi$, so sei $\psi'$ eine
$\left(\mathcal{L}+\Upsilon+\exists^{\geqslant}\right)\left[\sigma\right]$-Formel
mit $\psi\equiv\psi'$, und:
\[
\varphi'\coloneqq y\leqslant\#x\psi
\]

\end{casenv}
\end{proof}
\begin{notation}
Im folgenden wird mit $\mathcal{L}+\Upsilon+C$ stets eine dieser
äquivalenten Zähl-Logiken bezeichnet. Die Logik $\mathcal{L}+\mathbf{ORD}+C$
bezeichnen wir kurz als $\mathcal{L}+C$.\end{notation}
\begin{example}
Die Logik $\mathrm{FO}+C$ kann ausdrücken, dass die $\sigma$-Struktur
eine gerade Größe hat. Bekanntlich ist diese $\sigma$-Eigenschaft
weder durch $\mathrm{FO}$ auf geordneten, noch $\mathrm{LFP}$ auf
ungeordneten Strukturen definierbar\cite{EbbinghausFlum,Libkin2012}:

\[
\varphi_{\mathrm{EVEN}}\coloneqq\exists y\,\left(y=\#_{z}\left(\neg z\leqslant y\wedge z\leqslant\#_{z}\,z=z\right)\right)
\]

\end{example}

\subsection{Nicht-disjunkte Orakel}

Eine alternative Erweiterung definiert über einer Struktur $\mathfrak{A}$
eine beliebige Bijektion $\pi:\left[1,n\right]\rightleftarrows A$
und interpretiert dann die numerischen Prädikate $R/k\in\eta$ über
dem Universum der Struktur selbst. Diese Erweiterung bezeichnen wir
(in Anlehnung an die disjunkte Erweiterung $\mathcal{L}+\Upsilon$,
und die Konkatenation $\mathfrak{A}\oplus\mathfrak{B}$ von Strukturen
mit dem gleichen Universum) mit $\mathcal{L}\oplus\Upsilon$.
\begin{defn}
\textbf{$\mathcal{L}\oplus\Upsilon$-Logik}

Für eine relationale Signatur $\eta$, ein $\eta$-Orakel $\Upsilon:\mathbb{N}\rightarrow\mathbf{FIN}_{<}^{1}\left(\eta\right)$,
eine von $\eta$ disjunkte relationale Signatur $\sigma$ und eine
Logik $\mathcal{L}\left[\sigma\right]$ sei die Syntax von $\mathcal{L}\oplus\Upsilon\left[\sigma\right]$
gleich der Syntax von $\mathcal{L}\left[\sigma\uplus\eta\uplus\left\{ \leqslant\right\} \right]$.

Für $\mathfrak{A}\in\mathbf{FIN}\left(\sigma\right)$ mit $n=\left|A\right|$
sei $\pi:\left[1,n\right]\rightleftarrows A$ eine beliebige Bijektion.
Sei $\mathfrak{A}_{\pi}\in\mathbf{FIN}\left(\sigma\uplus\eta\right)$
definiert durch:
\begin{eqnarray*}
\mathfrak{A}_{\pi} & \coloneqq & \mathfrak{A}\oplus\pi\Upsilon\left(n\right)\\
 & = & \left(A,\left(R^{\mathfrak{A}}\right)_{R\in\sigma},\left(\pi R^{\Upsilon\left(n\right)}\right)\right)
\end{eqnarray*}


Eine $k$-stellige $\mathcal{L}\oplus\Upsilon\left[\sigma\right]$-Formel
$\varphi$ heiße \textbf{invariant}, wenn für jede Struktur $\mathfrak{A}\in\mathbf{FIN}\left(\sigma\right)$,
jedes Paar von Bijektionen $\pi,\pi'\in\mathrm{Bij}\left(\left[1,\left|A\right|\right],A\right)$
und jedes Tupel $\bar{a}\in A^{k}$ gilt:
\begin{eqnarray*}
\mathfrak{A}_{\pi}\models\varphi\left[\bar{a}\right] & \Longleftrightarrow & \mathfrak{A}_{\pi'}\models\varphi\left[\bar{a}\right]
\end{eqnarray*}


Wir bezeichnen mit $\mathrm{inv}\left(\mathcal{L}\oplus\Upsilon\right)\left[\sigma\right]$
die Sprache der invarianten Formeln der $\left(\mathcal{L}\oplus\Upsilon\right)\left[\sigma\right]$-Logik.
\end{defn}

\begin{notation}
Die Logik $\mathrm{inv}\left(\mathrm{FO}\oplus\mathbf{ARB}\right)$
mit dem Orakel $\mathbf{ARB}\left(n\right)\coloneqq\left(\mathcal{N}_{\mathrm{arb}}\right)_{\left[1,n\right]}$
(mit $\mathcal{N}_{\mathrm{arb}}$ und $\eta_{\mathrm{arb}}$ wie
in Definition \ref{def:arb}) bezeichnen wir auch als die ,,arb-invariante
$\mathrm{FO}\left(\mathbf{ARB}\right)$-Logik`` in Anlehnung an \cite{Schweikardt13ashort,AMSS2012-locality}.
\end{notation}
Es ist zu beachten, dass die hier betrachteten Orakel-Strukturen das
Universum $\left[1,n\right]$ haben, und nicht $\left[0,n\right]$.
Dies schließt unter anderem die Zählterm-Erweiterung $\mathcal{L}\oplus\Upsilon+\#$
aus, weil ein Zählterm nicht den Wert $0$ erhalten kann und seine
Auswertung nicht vollständig definiert ist. Die Zählquantor-Erweiterungen
$\mathcal{L}\oplus\Upsilon+\exists^{=}$ und $\mathcal{L}\oplus\Upsilon+\exists^{\geqslant}$
haben dieses Problem nicht.

Nach dem Satz von Trakhtenbrot ist die endlichen Erfüllbarkeit von
$\mathrm{FO}\left[\left\{ \leqslant\right\} \right]$ unentscheidbar,
und daher auch die Invarianz und die Sprache $\mbox{inv}\left(\mathrm{FO}\oplus\mathbf{ARB}\right)\left[\sigma\right]$
in $\mathrm{FO}\oplus\mathbf{ARB}\left[\sigma\right]$.\cite{EbbinghausFlumThomas,Libkin2012,Schweikardt13ashort} 


\chapter{Schaltkreise}


\section{Grundlagen der Schaltkreise}
\begin{defn}
\textbf{Boolesche Basis:} 

Eine boolesche Basis $\mathbb{B}$ besteht aus beliebigen über Permutation
der Eingabe abgeschlossenen Relationen $\phi'\subseteq\left\{ 0,1\right\} ^{*}$.
Wir definieren dafür der Einfachheit halber die Relation $\phi\subseteq\mathbb{N}^{2}$
mit $\phi\coloneqq\left\{ \left(i,j\right)\in\mathbb{N}^{2}\mid0^{i}1^{j}\in\phi'\right\} $.
Als Beispiel seien die folgenden booleschen Junktoren gegeben: 
\begin{eqnarray*}
\mathtt{AND} & \coloneqq & \left\{ 0\right\} \times\mathbb{N}\\
\mathtt{OR} & \coloneqq & \mathbb{N}\times\left(\mathbb{N}\backslash\left\{ 0\right\} \right)\\
\mathtt{MAJ} & \coloneqq & \left\{ \left(m,n\right)\in\mathbb{N}\times\mathbb{N}\mid m\leqslant n\right\} \\
\mathtt{XOR} & \coloneqq & \mathbb{N}\times\left(\mathbb{N}\backslash2\mathbb{N}\right)
\end{eqnarray*}


Im folgenden stehe $\mathbb{B}_{\mathrm{std}}\coloneqq\left\{ \mathtt{AND},\mathtt{OR}\right\} $
für die Basis mit boolescher Konjunktion und Disjunktion, und $\mathbb{B}_{\mathrm{maj}}\coloneqq\mathbb{B}_{\mathrm{std}}\cup\left\{ \mathtt{MAJ}\right\} $
für die Basis mit Konjunktion, Disjunktion und Majority.
\end{defn}

\begin{defn}
\textbf{Schaltkreis}

Sei $\mathbb{B}$ eine boolesche Basis und $\sigma$ eine relationale
Signatur. Ein $\left(\sigma,\mathbb{B}\right)$-Schaltkreis $\mathcal{C}\coloneqq\left(G,W,\Sigma,\Omega,U\right)$
mit der Stelligkeit $k\coloneqq\mathrm{ar}\left(C\right)$ besteht
aus den folgenden Komponenten: 
\begin{enumerate}
\item Ein azyklischer Graph mit den Knoten $G$ (,,Gates``) und den Kanten
$W\subseteq G\times G$.
\item eine Gate-Markierung $\Sigma$ 
\begin{eqnarray*}
\Sigma:G & \rightarrow & \mathbb{B}\\
 & \cup & \left\{ \mathbf{0},\mathbf{1},\mathtt{NOT}\right\} \\
 & \cup & \left\{ R\bar{t}\mid R\in\sigma,\bar{t}\in U^{\mathrm{ar}\left(R\right)}\right\} 
\end{eqnarray*}

\item eine Ausgabefunktion\footnote{In Anderson und Dawar 2014\cite{AD2014} wird zusätzlich die Injektivität
von $\Omega$ verlangt; hier können aber mehrere Tupel dem gleichen
Output-Gate zugeteilt werden.} $\Omega:U^{k}\rightarrow G$ (bei $k=0$ ist $\Omega\left(\left\langle \right\rangle \right)\in G$
ein einziges Output-Gate, und wird mit $\Omega=\Omega\left(\left\langle \right\rangle \right)$
abgekürzt) und 
\item ein Universum $U$ (üblicherweise $U=\left[1,n\right]$).
\end{enumerate}
Hierbei haben alle mit $\phi\in\mathbb{B}$ markierten Gates mindestens
einen\footnote{Alle hier betrachteten Schaltkreise haben einen unbeschränkten Fan-In.}
Vorgänger, alle mit $R\bar{x}$, $\mathbf{0}$ oder $\mathbf{1}$
markierten Gates keinen\textbf{ }Vorgänger, und alle mit $\mathtt{NOT}$
markierten Gates genau\textbf{ }einen\textbf{ }Vorgänger.

Die mit $\mathbf{0}$ oder $\mathbf{1}$ markierten Gates heißen \textbf{Konstanten},
die mit $R\bar{x}$ markierten Gates heißen \textbf{Inputs}, und die
Gates im Bild von $\Omega$ heißen \textbf{Outputs}.
\end{defn}

\begin{defn}
\label{def:formal}Formal definieren wir den $k$-stelligen $\left(\sigma,\mathbb{B}\right)$-Schaltkreis
$\mathcal{C}=\left(G,W,\Sigma,\Omega,U\right)$ als eine relationale
$\tau_{\sigma,\mathbb{B},k}$-Struktur über dem Universum $G\uplus U$,
wobei gilt:
\begin{eqnarray*}
\tau_{\sigma,\mathbb{B},k} & \coloneqq & \left\{ W/2,\left(\Sigma_{s}/1\right)_{s\in\mathbb{B}\uplus\left\{ \mathbf{0},\mathbf{1},\mathtt{NOT}\right\} },\left(\Sigma_{R}/1+k\right)_{R/k\in\sigma},\Omega/k+1\right\} \\
W^{\mathcal{C}} & \coloneqq & W\\
\Sigma_{s}^{\mathcal{C}} & \coloneqq & \left\{ g\in G\mid\Sigma\left(g\right)=s\right\} \,\mathrm{f\ddot{u}r}\,s\in\mathbb{B}\uplus\left\{ \mathbf{0},\mathbf{1},\mathtt{NOT}\right\} \\
\Sigma_{R}^{\mathcal{C}} & \coloneqq & \left\{ g\bar{t}\mid\Sigma\left(g\right)=R\bar{t}\right\} \,\mathrm{f\ddot{u}r}\,R\in\sigma\\
\Omega^{\mathcal{C}} & \coloneqq & \left\{ \bar{t}g\mid\Omega\left(\bar{t}\right)=g\right\} 
\end{eqnarray*}

\end{defn}

\begin{defn}
\textbf{\label{def:circuit-eval}Auswertung von Schaltkreisen}

Der $\left(\sigma,\mathbb{B}\right)$-Schaltkreis $\mathcal{C}=\left(G,W,\Sigma,\Omega,U\right)$
wird auf einer $\sigma$-Struktur $\mathfrak{A}\in\mathbf{FIN}^{U}\left(\sigma\right)$
ausgewertet. Die Auswertung ist eine Abbildung $\mathcal{C}\left[\mathfrak{A}\right]:G\rightarrow\left\{ 0,1\right\} $,
die jedem Gate $g\in G$ den Wert $0$ oder $1$ zuweist, und ist
rekursiv wie folgt definiert:
\begin{casenv}
\item Für $\Sigma\left(g\right)=R\bar{t}$ gilt 
\[
\mathcal{C}\left[\mathfrak{A}\right]\left(g\right)\coloneqq\left[R^{\mathfrak{A}}\right]\bar{t}
\]

\item Für $\Sigma\left(g\right)\in\left\{ \mathbf{0},\mathbf{1}\right\} $
gilt
\[
\mathcal{C}\left[\mathfrak{A}\right]\left(g\right)\coloneqq\begin{cases}
1 & \mathrm{falls}\,\,\Sigma\left(v\right)=\mathbf{1}\\
0 & \mathrm{sonst}
\end{cases}
\]

\item Für $\Sigma\left(g\right)=\mathtt{NOT}$ und $\left(h,g\right)\in W$
gilt 
\[
\mathcal{C}\left[\mathfrak{A}\right]\left(g\right)\coloneqq1-\mathcal{C}\left[\mathfrak{A}\right]\left(h\right)
\]

\item Für $\Sigma\left(g\right)=\phi\in\mathbb{B}$ gilt: 
\begin{eqnarray*}
j_{1} & \coloneqq & \sum_{\left(h,g\right)\in W}\mathcal{C}\left[\mathfrak{A}\right]\left(h\right)\\
j_{0} & \coloneqq & \left|\left\{ h\mid\left(h,g\right)\in W\right\} \right|-j_{1}\\
\\
\mathcal{C}\left[\mathfrak{A}\right]\left(g\right) & \coloneqq & \left[\phi\right]\left(j_{0},j_{1}\right)
\end{eqnarray*}

\end{casenv}
Für einen $k$-stelligen Schaltkreis $\mathcal{C}$ und ein Tupel
$\bar{t}\in U^{k}$ sei die Ausgabe von $\mathcal{C}$ der Wert des
Outputs $\Omega\left(\bar{t}\right)$:
\[
\left\llbracket \mathcal{C}\right\rrbracket \left(\mathfrak{A},\bar{t}\right)\coloneqq\mathcal{C}\left[\mathfrak{A}\right]\left(\Omega\left(\bar{t}\right)\right)
\]
 
\end{defn}
Ferner sei $q_{\mathcal{C}}:\mathbf{FIN}^{U}\left(\sigma\right)\rightarrow U^{k}$
die Abbildung einer Struktur auf die Relation der Tupel, für die $\mathcal{C}$
den Wert $1$ ausgibt. 
\[
q_{\mathcal{C}}\left(\mathfrak{A}\right)\coloneqq\left\{ \bar{t}\in U^{k}\mid\left\llbracket \mathcal{C}\right\rrbracket \left(\mathfrak{A},\bar{t}\right)=1\right\} 
\]

\begin{example*}
Sei $\mathcal{C}_{4}=\left(G,W,\Sigma,\Omega,\left[4\right]\right)$
(siehe Abbildung \ref{fig:circuit}) ein $1$-stelliger $\left(\left\{ E\right\} ,\mathbb{B}_{\mathrm{std}}\right)$-Schaltkreis,
der alle Knoten eines gerichteten Graphen findet, die Teil eines einfachen
Kreises der Länge $2$ sind.

\begin{eqnarray*}
G & \coloneqq & \left\{ g_{i,j}\mid i,j\in\left[4\right],\,i\neq j\right\} \\
 & \cup & \left\{ g_{\left\{ i,j\right\} }\mid\left\{ i,j\right\} \subseteq\left[4\right],\,i\neq j\right\} \\
 & \cup & \left\{ g_{i}\mid i\in\left[4\right]\right\} 
\end{eqnarray*}
\begin{eqnarray*}
E & \coloneqq & \left\{ \left(g_{i,j},g_{\left\{ i,j\right\} }\right)\mid i,j\in\left[4\right],\,i\neq j\right\} \\
 & \cup & \left\{ \left(g_{\left\{ i,j\right\} },g_{i}\right)\mid i,j\in\left[4\right],\,i\neq j\right\} 
\end{eqnarray*}
\[
\Sigma\left(g\right)=\begin{cases}
E\,i\,j & \mathrm{f\ddot{u}r}\,\,g=g_{i,j}\\
\mathtt{AND} & \mathrm{f\ddot{u}r}\,\,g=g_{\left\{ i,j\right\} }\\
\mathtt{OR} & \mathrm{f\ddot{u}r}\,\,g=g_{i}
\end{cases}
\]
\[
\Omega\left(i\right)\coloneqq g_{i}
\]


\begin{figure}
\begin{centering}
\tikzstyle{every node}=[circle, draw=black,node distance=3em]
\begin{tikzpicture}

\node (E12) {$E 1 2$};
\node [right of=E12] (E21) {$E 2 1$};
\node [right of=E21] (E13) {$E 1 3$};
\node [right of=E13] (E31) {$E 3 1$};
\node [right of=E31] (E14) {$E 1 4$};
\node [right of=E14] (E41) {$E 4 1$};
\node [right of=E41] (E23) {$E 2 3$};
\node [right of=E23] (E32) {$E 3 2$};
\node [right of=E32] (E24) {$E 2 4$};
\node [right of=E24] (E42) {$E 4 2$};
\node [right of=E42] (E34) {$E 3 4$};
\node [right of=E34] (E43) {$E 4 3$};

\node [below of=E41,node distance=7em] (14) {$\wedge$};
\node [left of=14,node distance=4em] (13) {$\wedge$};
\node [left of=13,node distance=4em] (12) {$\wedge$};
\node [right of=14,node distance=4em] (23) {$\wedge$};
\node [right of=23,node distance=4em] (24) {$\wedge$};
\node [right of=24,node distance=4em] (34) {$\wedge$};

\node [below of=14,node distance=5em,label=below:$\Omega\left(2\right)$] (2) {$\vee$};
\node [left of=2,label=below:$\Omega\left(1\right)$] (1) {$\vee$};
\node [right of=2,label=below:$\Omega\left(3\right)$] (3) {$\vee$};
\node [right of=3,label=below:$\Omega\left(4\right)$] (4) {$\vee$};

\path [->]
		(E12) edge (12) (E21) edge (12)
		(E13) edge (13) (E31) edge (13)
		(E14) edge (14) (E41) edge (14)
		(E23) edge (23) (E32) edge (23)
		(E24) edge (24) (E42) edge (24)
		(E34) edge (34) (E43) edge (34)

		(12) edge (1) (12) edge (2)
		(13) edge (1) (13) edge (3)
		(14) edge (1) (14) edge (4)
		(23) edge (2) (23) edge (3)
		(24) edge (2) (24) edge (4)
		(34) edge (3) (34) edge (4)

;

\end{tikzpicture}
\par\end{centering}

\caption{\label{fig:circuit}Schaltkreis $\mathcal{C}_{4}$}


\end{figure}

\end{example*}

\section{Eigenschaften von Schaltkreisen}
\begin{defn}
\textbf{Größe und Tiefe}

Die Größe $\left|\mathcal{C}\right|$ eines Schaltkreises $\mathcal{C}=\left(G,W,\Sigma,\Omega,U\right)$
sei die Anzahl seiner Gates, $\left|G\right|$. Die Tiefe $T\left(\mathcal{C}\right)$
sei die maximale Länge eines Wegs durch den Graphen $\left(G,W\right)$.
\end{defn}

\begin{defn}
\textbf{Invarianz}

Ein $\left(\sigma,\mathbb{B}\right)$-Schaltkreis $\mathcal{C}$ mit
dem Universum $U$ heiße \textbf{invariant}, wenn für alle $\mathfrak{A}\in\mathbf{FIN}^{U}\left(\sigma\right)$,
alle $\bar{t}\in U^{\mathrm{ar}\left(\mathcal{C}\right)}$, und jede
Permutation $\pi\in\mathrm{Sym}_{U}$ gilt:
\[
\left\llbracket \mathcal{C}\right\rrbracket \left(\pi\mathfrak{A},\pi\bar{t}\right)=\left\llbracket \mathcal{C}\right\rrbracket \left(\mathfrak{A},\bar{t}\right)
\]


In diesem Fall definieren wir für jede Struktur $\mathfrak{A}\in\mathbf{FIN}^{\left(\left|U\right|\right)}\left(\sigma\right)$
und $\bar{a}\in A^{\mathrm{ar}\left(\mathcal{C}\right)}$ die Auswertung
von $\mathcal{C}$ implizit als die Auswertung auf $\pi\mathfrak{A}\in\mathbf{FIN}^{U}\left(\sigma\right)$
mit einer beliebigen Bijektion $\pi:A\rightleftarrows U$:
\[
\left\llbracket \mathcal{C}\right\rrbracket \left(\mathfrak{A},\bar{a}\right)\coloneqq\left\llbracket \mathcal{C}\right\rrbracket \left(\pi\mathfrak{A},\pi\bar{a}\right)
\]

\end{defn}

\begin{defn}
\textbf{Symmetrie}

Für einen Schaltkreis $\mathcal{C}=\left(G,W,\Sigma,\Omega,U\right)$,
eine Permutation $\pi\in\mathrm{Sym}_{U}$ und einen Automorphismus
$\rho\in\mathrm{Aut}_{\mathcal{C}}$ mit $\rho_{\mid U}=\pi$ nennen
wir $\rho$ von $\pi$ \textbf{induziert}. (Nach den formalen Definitionen
\ref{def:formal} und \ref{def:isomorphism} ist $\rho\in\mathrm{Aut}_{\mathcal{C}}\subseteq\mathrm{Sym}_{G\uplus U}$
eine Permutation des Universums von $\mathcal{C}$.) Wir können aus
der formalen Definition des Schaltkreises als $\tau_{\sigma,\mathbb{B},k}$-Struktur
ableiten, dass ein von $\pi$ induzierter Automorphismus $\rho$ die
folgenden Bedingungen erfüllt:
\begin{enumerate}
\item Die Kanten sind isomorph: $\rho W=W$.
\item Für alle Inputs $g$ mit $\Sigma\left(g\right)=R\bar{x}$ gilt $\Sigma\left(\rho g\right)=R\,\bar{x'}$,
mit $\bar{x'}=\pi\bar{x}$.
\item Für alle übrigen Gates gilt $\Sigma\left(\rho g\right)=\Sigma\left(g\right)$.
\item Für jedes Tupel $\bar{t}\in U^{k}$ gilt $\rho\Omega\left(\bar{x}\right)=\Omega\left(\pi\bar{t}\right)$.
\end{enumerate}
Ein Schaltkreis heiße \textbf{symmetrisch}, genau dann wenn jede Permutation
des Universums $\pi\in\mathrm{Sym}_{U}$ einen Automorphismus $\hat{\pi}\in\mathrm{Aut}_{\mathcal{C}}$
des Schaltkreises induziert. (In Zukunft betrachten wir der Einfachheit
halber nur den Teil $\hat{\pi}_{\mid G}$, der die Gates des Schaltkreises
permutiert, da der Rest des Automorphismus $\hat{\pi}=\hat{\pi}_{\mid G}\uplus\pi$
lediglich die Permutation $\pi$ ist.)\end{defn}
\begin{prop}
Symmetrie ist eine hinreichende, aber nicht notwendige, Bedingung
für die Invarianz eines Schaltkreises.\end{prop}
\begin{proof}
Sei $\mathcal{C}$ ein symmetrischer $k$-stelliger $\left(\sigma,\mathbb{B}\right)$-Schaltkreis
über $U$, und $\mathfrak{A}\in\mathbf{FIN}^{U}\left(\sigma\right)$.
Sei $\pi\in\mathrm{Sym}_{U}$ eine beliebige Permutation, und sei
$\bar{t}\in U^{k}$ ein beliebiges Tupel. Es ist zu zeigen, dass:
\begin{eqnarray*}
\left\llbracket \mathcal{C}\right\rrbracket \left(\mathfrak{A},\bar{t}\right) & = & \left\llbracket \mathcal{C}\right\rrbracket \left(\pi\mathfrak{A},\pi\bar{t}\right)
\end{eqnarray*}


Wegen der Symmetrie induziert $\pi$ einen Automorphismus $\hat{\pi}$
auf $\mathcal{C}$: 
\begin{eqnarray*}
\hat{\pi}\left(W\right) & = & W\\
\Sigma\left(\hat{\pi}g\right) & = & \begin{cases}
R\pi\bar{x} & \mathrm{f\ddot{u}r}\,\,\Sigma\left(g\right)=R\bar{x}\\
\Sigma\left(g\right) & \mathrm{sonst}
\end{cases}\\
\Omega\left(\pi\bar{x}\right) & = & \hat{\pi}\Omega\left(\bar{x}\right)\,\mathrm{f\ddot{u}r\,alle}\,\bar{x}\in U^{\mathrm{ar}\left(\mathcal{C}\right)}
\end{eqnarray*}


Per Induktion über die Tiefe\footnote{Die Tiefe $T:G\rightarrow\mathbb{N}$ sei die maximale Länge eines
Weges von einer Quelle zum Gate $g$.} $T\left(g\right)$ des Gates $g$ wird gezeigt: 
\begin{eqnarray*}
\mathcal{C}\left[\mathfrak{A}\right]\left(g\right)=\mathcal{C}\left[\pi\mathfrak{A}\right]\left(\hat{\pi}g\right) &  & \mathrm{f\ddot{u}r\,alle}\,g\in G
\end{eqnarray*}

\begin{description}
\item [{Induktionsanfang~$T\left(g\right)=0$:}] Sei $g\in G$ ein Input
mit $\Sigma\left(g\right)=R\bar{x}$. Per Definition von $\tau$ und
$\hat{\tau}$ gilt:
\begin{eqnarray*}
\Sigma\left(\hat{\pi}g\right) & = & R\pi\bar{x}\\
\pi\bar{x}\in\pi R^{\mathfrak{A}} & \Longleftrightarrow & \bar{x}\in\pi_{2}R^{\mathfrak{A}}
\end{eqnarray*}
 Es folgt: 
\begin{eqnarray*}
\mathcal{C}\left[\pi\mathfrak{A}\right]\left(\hat{\pi}g\right) & = & \left[\pi R^{\mathfrak{A}}\right]\left(\pi\bar{x}\right)\\
 & = & \left[R^{\mathfrak{A}}\right]\left(\bar{x}\right)\\
 & = & \mathcal{C}\left[\mathfrak{A}\right]\left(g\right)
\end{eqnarray*}
(Falls $\Sigma\left(g\right)\in\left\{ \mathbf{0},\mathbf{1}\right\} $,
folgt die Behauptung direkt aus $\Sigma\left(\hat{\pi}g\right)=\Sigma\left(g\right)$.)
\item [{Induktionsschritt~$n\mapsto n+1$:}]~

\begin{description}
\item [{Annahme:}] Für alle Gates $g\in G$ mit Tiefe $T\left(g\right)\leqslant n$
gilt $\mathcal{C}\left[\pi\mathfrak{A}\right]\left(\hat{\pi}g\right)=\mathcal{C}\left[\mathfrak{A}\right]\left(g\right)$.
\end{description}

So gilt für jedes Gatter $g'\in G$ mit $T\left(g'\right)=n+1$: 
\begin{enumerate}
\item Die Beschriftungen $\Sigma\left(\hat{\pi}g'\right)=\Sigma\left(g'\right)=\phi$
sind gleich.
\item $\mathcal{C}\left[\pi\mathfrak{A}\right]\left(\hat{\pi}g\right)=\mathcal{C}\left[\mathfrak{A}\right]\left(g\right)$
für alle $\left(g,g'\right)\in W$.
\end{enumerate}

Es folgt $\mathcal{C}\left[\pi\mathfrak{A}\right]\left(\hat{\pi}g'\right)=\mathcal{C}\left[\mathfrak{A}\right]\left(g'\right)$.

\end{description}
Schließlich gilt für jedes Tupel $\bar{t}\in U^{\mathrm{ar}\left(\mathcal{C}\right)}$:

\begin{eqnarray*}
\left\llbracket \mathcal{C}\right\rrbracket \left(\pi\mathfrak{A},\pi\bar{t}\right) & = & \mathcal{C}\left[\pi\mathfrak{A}\right]\left(\Omega\left(\pi\bar{t}\right)\right)\\
 & = & \mathcal{C}\left[\pi\mathfrak{A}\right]\left(\hat{\pi}\Omega\left(\bar{t}\right)\right)\\
 & = & \mathcal{C}\left[\mathfrak{A}\right]\left(\Omega\left(\bar{t}\right)\right)=\left\llbracket \mathcal{C}\right\rrbracket \left(\mathfrak{A},\bar{t}\right)
\end{eqnarray*}


Damit ist der Schaltkreis invariant.

Um die Umkehrrichtung zu widerlegen, wird als Gegenbeispiel der folgende
$0$-stellige Schaltkreis $\mathcal{C}_{2}$ (siehe Abbildung \ref{fig:symm})
über $U=\left\{ 1,2\right\} $ angeführt:
\begin{eqnarray*}
\mathcal{C} & \coloneqq & \left(G,W,\Sigma,\Omega,U\right)\\
G & \coloneqq & \left\{ g_{i,j}\mid i,j\in U\right\} \cup\left\{ g_{\wedge},g_{\wedge}'\right\} \\
W & \coloneqq & \left\{ \left(g_{1,1},g_{\wedge}\right),\left(g_{1,2},g_{\wedge}\right),\left(g_{2,1},g_{\wedge}'\right),\left(g_{2,2},g_{\wedge}'\right),\left(g_{\wedge},g_{\wedge}'\right)\right\} \\
\Sigma\left(g\right) & \coloneqq & \mathtt{AND}\\
\Omega & \coloneqq & g_{\wedge}'
\end{eqnarray*}


\begin{figure}
\begin{centering}
\begin{center}
\tikzstyle{every node}=[circle, draw=black]
\begin{tikzpicture}

\node [label=below:$\Omega$] (C) {$\wedge$};

\node [above left of=C,node distance=6em] (B1) {$\wedge$};


\node [above left of=B1,node distance=6em] (A1) {$E12$};
\node [right of=A1,node distance=5.5em] (A2) {$E11$};
\node [right of=B1,node distance=5.5em] (A3) {$E22$};
\node [right of=A3,node distance=5.5em] (A4) {$E21$};

\path [->] (A1) edge (B1) (A2) edge (B1) (A3) edge (C) (A4) edge (C)
			(B1) edge (C);
\end{tikzpicture}
\par\end{center}
\par\end{centering}

\caption{\label{fig:symm}Schaltkreis $\mathcal{C}_{2}$}
\end{figure}

\end{proof}
Der Schaltkreis ist invariant, und akzeptiert alle vollständigen $K_{2}$-Graphen.
Er ist aber nicht symmetrisch: Die Permutation $\left(\begin{array}{cc}
1 & 2\\
2 & 1
\end{array}\right)$ induziert keinen Automorphismus.


\begin{defn}
\textbf{\label{def:rigid}Rigidität}

Ein Schaltkreis $\mathcal{C}=\left(G,W,\Sigma,\Omega,U\right)$ sei
rigide, wenn er keine redundanten Gates besitzt. Formal dürfen nicht
$g,g'\in G$ existieren, so dass:
\begin{eqnarray*}
\Sigma\left(g\right) & = & \Sigma\left(g'\right)\\
\left\{ u\in G\mid\left(u,g\right)\in W\right\}  & = & \left\{ u\in G\mid\left(u,g'\right)\in W\right\} 
\end{eqnarray*}


Insbesondere heißt dies, das der Schaltkreis höchstens zwei Konstanten
$g_{0},g_{1}$ mit $\Sigma\left(g_{0}\right)=\mathbf{0}$ und $\Sigma\left(g_{1}\right)=\mathbf{1}$
enthält, und jede Input-Beschriftung $\Sigma\left(g\right)=R\bar{x}$
nur einmal vorkommt.
\end{defn}
Die Rigidität ist hier analog zu der Arbeit von Anderson und Dawar\cite{AD2014}
definiert, verlangt aber zusätzlich, dass zwei Gates nicht nur durch
die (hier nicht injektive) Output-Markierung $\Omega$ unterschieden
werden. Diese Einschränkung ist strenger, schränkt aber die Definition
nicht bedeutend ein:

Für zwei Gates $g,g'\in G$ mit den gleichen Vorgängern, der gleichen
Markierung $\Sigma\left(g\right)=\Sigma\left(g'\right)$ und $\Omega^{-1}\left(g\right)\neq\Omega^{-1}\left(g'\right)$
erlaubt die nicht-injektive Definition von $\Omega$, dass $g'$ entfernt
wird und für alle $\bar{t}\in\Omega^{-1}\left(g'\right)$ stattdessen
$\Omega\left(\bar{t}\right)\coloneqq g$ gesetzt wird.


\section{Eigenschaften von Schaltkreisfamilien}
\begin{defn}
Eine $\left(\sigma,\mathbb{B}\right)$-\textbf{Schaltkreisfamilie}
$\bar{\mathcal{C}}=\left(\mathcal{C}_{n}\right)_{n\in\mathbb{N}}$
sei eine Sequenz von invarianten Schaltkreisen $\mathcal{C}_{n}=\left(G_{n},W_{n},\Sigma_{n},\Omega_{n},U_{n}\right)$
mit der gleichen Stelligkeit $\mathrm{ar}\left(\mathcal{C}_{n}\right)=k$
und den Universen $U_{n}=\left[1,n\right]$.

Die von der Schaltkreisfamilie berechnete $\sigma$-Anfrage $q_{\bar{\mathcal{C}}}$
sei wie folgt: 
\[
q_{\bar{\mathcal{C}}}\left(\mathfrak{A}\right)\coloneqq q_{\mathcal{C}_{\left|A\right|}}\left(\mathfrak{A}\right)
\]

\end{defn}

\begin{defn}
Für eine Komplexitätsklasse $\mathcal{K}$ sei eine Schaltkreisfamilie
$\bar{\mathcal{C}}$ $\mathcal{K}$-uniform, wenn die Berechnung einer
Repräsentation von $\mathcal{C}_{n}$ bei Eingabe des Worts $\overset{n}{\overbrace{1\cdots1}}$
in $\mathcal{K}$ ist.
\end{defn}

\begin{defn}
\textbf{Beschränkte Größe}

Für eine Funktion $f:\mathbb{N}\rightarrow\mathbb{N}$ habe eine Schaltkreisfamilie
$\bar{\mathcal{C}}$ $f$-\textbf{Größe}, wenn für ein $n_{0}\in\mathbb{N}$
und alle $n\geqslant n_{0}$ gilt, dass $\left|\mathcal{C}_{n}\right|\leqslant f\left(n\right)$.
Für eine Klasse von Funktionen $\mathcal{F}\subseteq\mathrm{Abb}\left(\mathbb{N},\mathbb{N}\right)$
mit $f\in\mathcal{F}$ habe $\bar{C}$ $\mathcal{F}$-Größe.

Insbesondere sei $\mathrm{poly}\left(n\right)=n^{\mathcal{O}\left(1\right)}$
die Klasse aller polynomiell beschränkten Funktionen.\end{defn}
\begin{rem*}
Statt ,,$\mathrm{poly}\left(n\right)$-groß`` wird in \cite{AD2014}
der Begriff ,,$\mathrm{P}/\mathrm{poly}$-uniform`` verwendet:

Eine $\mathrm{P/poly}$-Turingmaschine arbeitet in Polynomialzeit
und erhält für eine Eingabe der Länge $n$ eine polynomiell beschränkte
Orakel-Eingabe $\Upsilon\left(n\right)\in\left\{ 0,1\right\} ^{f\left(n\right)}$,
$f\left(n\right)\in\mathrm{poly}\left(n\right)$. Unter Voraussetzung
einer geeigneten Kodierung kann $\Upsilon\left(n\right)$ jede $\mathrm{poly}\left(n\right)$-große
Schaltkreisfamilie repräsentieren\cite{arora-barak}. Daher sind die
Begriffe ,,$\mathrm{poly}\left(n\right)$-groß`` und ,,$P/\mathrm{poly}$-uniform``
äquivalent.\end{rem*}
\begin{defn}
\textbf{Beschränkte Tiefe}

Für eine Funktion $f:\mathbb{N}\rightarrow\mathbb{N}$ habe eine Schaltkreisfamilie
$\bar{\mathcal{C}}$ $f$-\textbf{Tiefe}, wenn $T\left(\mathcal{C}_{n}\right)\leqslant f\left(n\right)$
für ein $n_{0}\in\mathbb{N}$ und alle $n\geqslant n_{0}$. Für eine
Klasse $\mathcal{F}\subseteq\mathrm{Abb}\left(\mathbb{N},\mathbb{N}\right)$
sei der Begriff ,,$\mathcal{F}$-tief`` analog zu ,,$\mathcal{F}$-groß``
definiert.
\end{defn}

\begin{defn}
Benennung von Schaltkreisklassen

Sei $\sigma$ eine beliebige relationale Signatur.
\begin{itemize}
\item Mit $\mathrm{SBC}\left[\sigma\right]$ bezeichnen wir die Klasse der
Anfragen, die von einer symmetrischen\textbf{ $\left(\sigma,\mathbb{B}_{\mathrm{std}}\right)$}-Schaltkreisfamilie
beschrieben werden.
\item $\left(\mathrm{SBC}+\mathbf{MAJ}\right)\left[\sigma\right]$ sei die
Klasse der Anfragen, die von einer symmetrischen\textbf{ $\left(\sigma,\mathbb{B}_{\mathrm{maj}}\right)$}-Schaltkreisfamilie
beschrieben werden. (Zur Erinnerung: $\mathbb{B}_{\mathrm{maj}}=\mathbb{B}_{\mathrm{std}}\uplus\left\{ \mathtt{MAJ}\right\} $,
wobei $\mathtt{MAJ}$ der Majority-Operator ist.)
\end{itemize}
Für eine Komplexitätsklasse $\mathcal{K}$ bezeichne $\mathrm{SBC}^{\mathcal{K}}$
(beziehungsweise $\left(\mathrm{SBC}+\mathbf{MAJ}\right)^{\mathcal{K}}$
die Klasse der Anfragen, die von einer entsprechenden $\mathcal{K}$-uniformen
Schaltkreisfamilie beschrieben werden.

Für jede dieser Klassen schreiben wir ,,$\mathrm{SAC}^{0}$`` anstelle
von ,,$\mathrm{SBC}$``, um die Klasse auf Schaltkreisfamilien mit
konstanter Tiefe und $\mathrm{poly}\left(n\right)$-Größe zu beschränken.
\end{defn}

\chapter{Von Formeln zu Schaltkreisfamilien}


\section{Logik erster Stufe}

Wir weisen zunächst nach, dass die Logik der ersten Stufe durch symmetrische,
$\mathrm{LOGSPACE}$-uniforme Schaltkreisfamilien konstanter Tiefe
beschrieben wird. 
\[
\mathrm{FO}\subseteq\left(\mathrm{SAC}^{0}\right)^{\mathrm{LOGSPACE}}
\]

\begin{lem}
\label{lem:fo-circuit}Jede $\mathrm{FO}\left[\sigma\right]$-Formel
$\varphi\left(\bar{x}\right)$ definiert eine $\sigma$-Anfrage $q$,
die von einer symmetrischen $\mathrm{LOGSPACE}$-uniformen Schaltkreis-Familie
$\bar{\mathcal{C}^{\varphi}}$ mit $\left\Vert \varphi\right\Vert $-Tiefe
und $\left\Vert \varphi\right\Vert n^{\mathtt{MF}\left(\varphi\right)}$-Größe
berechnet wird.\end{lem}
\begin{proof}
Sei $\sigma$ eine relationale Signatur, und sei $\varphi\left(\bar{x}\right)$
eine $k$-stellige $\mathrm{FO}\left[\sigma\right]$-Formel.

Per induktiver Konstruktion über den Aufbau von $\varphi$ wird der
$k$-stellige Schaltkreis $\mathcal{C}_{n}^{\varphi}$ über dem Universum
$U\coloneqq\left[1,n\right]$ definiert, so dass $\left\llbracket \varphi\right\rrbracket \left(\mathfrak{A},\bar{t}\right)\Leftrightarrow\left\llbracket \mathcal{C}_{n}^{\varphi}\right\rrbracket \left(\mathfrak{A},\bar{t}\right)$
für alle $n\in\mathbb{N}$, $\mathfrak{A}\in\mathbf{FIN}^{\left[1,n\right]}\left(\sigma\right)$
und $\bar{t}\in\left[1,n\right]^{k}$ gilt. Für eine beliebige Permutation
$\pi\in\mathrm{Sym}_{U}$ wird ein Automorphismus $\hat{\pi}$ angegeben,
und damit die Symmetrie nachgewiesen.
\begin{casenv}
\item Falls $\varphi\left(\bar{x}\right)=R\bar{y}$ für $R/m\in\sigma$
und $\bar{y}\in\mathrm{frei}\left(\varphi\right)^{m}$, so besteht
$\mathcal{C}_{n}^{\varphi}$ aus $n^{k}$ Gates.

\begin{description}
\item [{Schaltkreis:}] 
\[
\mathcal{C}_{n}^{\varphi}\coloneqq\left(\left\{ g_{\bar{t}}\mid\bar{t}\in U^{k}\right\} ,\emptyset,\Sigma,\Omega,U\right)
\]
Für jedes Tupel $\bar{t}\in U^{k}$ sei $\beta_{\bar{t}}\coloneqq\left(\bar{x}\mapsto\bar{t}\right)$
die Belegung der Variablen $\bar{x}$ mit $\bar{t}$:
\begin{eqnarray*}
\Sigma\left(g_{\bar{t}}\right) & \coloneqq & R\beta_{\bar{t}}\left(\bar{y}\right)\\
\Omega\left(\bar{t}\right) & \coloneqq & g_{\bar{t}}
\end{eqnarray*}

\item [{Korrektheit:}] 
\[
\begin{array}{cccccc}
\left\llbracket R\bar{x}\right\rrbracket \left(\mathfrak{A},\bar{t}\right) & = & \left[R^{\mathfrak{A}}\right]\left(\beta_{\bar{t}}\bar{y}\right) & = & \mathcal{C}_{n}^{\varphi}\left[\mathfrak{A}\right]\left(g_{\bar{t}}\right)= & \left\llbracket \mathcal{C}_{n}^{\varphi}\right\rrbracket \left(\mathfrak{A},\bar{t}\right)\end{array}
\]

\item [{Symmetrie:}] Sei $\hat{\pi}g_{\bar{t}}\coloneqq g_{\pi\bar{t}}$
für alle Tupel $\bar{t}\in U^{k}$. Per Definition ist $\pi\beta_{\bar{t}}\left(\bar{y}\right)=\beta_{\pi\bar{t}}\left(\bar{y}\right)$
und daher 
\begin{eqnarray*}
\Sigma\left(\hat{\pi}g_{\bar{t}}\right) & = & \pi\Sigma\left(g_{\bar{t}}\right)\\
\Omega\left(\pi\bar{t}\right) & = & \hat{\pi}\Omega\left(\bar{t}\right)
\end{eqnarray*}

\item [{Größe:}] Der Schaltkreis hat die Tiefe $0$ und die Größe $n^{k}=n^{\mathtt{MF}\left(\varphi\right)}$.
\end{description}
\item Falls $\varphi\left(\bar{x}\right)=y_{1}\dot{=}y_{2}$, so besteht
$\mathcal{C}_{n}^{\varphi}$ aus $n^{k}$ isolierten Gates (hier ist
$k\in\left\{ 1,2\right\} $).

\begin{description}
\item [{Schaltkreis:}] 
\[
\mathcal{C}_{n}^{\varphi}\coloneqq\left(\left\{ g_{\bar{t}}\mid\bar{t}\in U^{k}\right\} ,\emptyset,\Sigma,\Omega,U\right)
\]
Für jedes Tupel $\bar{t}\in U^{k}$ sei $\beta_{\bar{t}}\coloneqq\left(\bar{x}\mapsto\bar{t}\right)$
die entsprechende Belegung:
\begin{eqnarray*}
\Sigma\left(g_{\bar{t}}\right) & \coloneqq & \begin{cases}
\mathbf{1} & \mathrm{falls}\,\,\beta\left(y_{1}\right)=\beta\left(y_{2}\right)\\
\mathbf{0} & \mathrm{sonst}
\end{cases}\\
\Omega\left(\bar{t}\right) & \coloneqq & g_{\bar{t}}
\end{eqnarray*}

\item [{Korrektheit:}] 
\begin{eqnarray*}
\left\llbracket y_{1}\dot{=}y_{2}\right\rrbracket \left(\mathfrak{A},\bar{t}\right)=1 & \Leftrightarrow & \left(\beta_{\bar{t}}y_{1}=\beta_{\bar{t}}y_{2}\right)\\
 & \Leftrightarrow & \mathcal{C}_{n}^{\varphi}\left[\mathfrak{A}\right]\left(g_{\bar{t}}\right)=1\\
 & \Leftrightarrow & \left\llbracket \mathcal{C}_{n}^{\varphi}\right\rrbracket \left(\mathfrak{A},\bar{t}\right)=1
\end{eqnarray*}

\item [{Symmetrie:}] Sei $\hat{\pi}\left(g_{\bar{t}}\right)\coloneqq g_{\pi\bar{t}}$.
Es gilt $\beta_{\bar{t}}\left(x\right)=\beta_{\bar{t}}\left(x'\right)$
genau dann wenn $\beta_{\pi\bar{t}}\left(x\right)=\beta_{\pi\bar{t}}\left(x\right)$,
und daher ist $\Sigma\left(\hat{\pi}g_{\bar{t}}\right)=\Sigma\left(g_{\pi\bar{t}}\right)$.
\item [{Größe:}] Der Schaltkreis hat die Tiefe $0$ und die Größe $n^{k}=n^{\mathtt{MF}\left(\varphi\right)}$.
\end{description}
\item Falls $\varphi\left(\bar{x}\right)=\varphi_{1}\left(\bar{y_{1}}\right)\wedge\cdots\wedge\varphi_{m}\left(\bar{y_{m}}\right)$
mit $\mathrm{ar}\left(\varphi_{i}\right)=k_{i}$, so besteht $\mathcal{C}_{n}^{\varphi}$
aus der disjunkten Vereinigung aller $\mathcal{C}_{n}^{\varphi_{i}}$
für $1\leqslant i\leqslant m$ mit der folgenden Erweiterung.

\begin{description}
\item [{Schaltkreis:}] 
\begin{eqnarray*}
\mathcal{C}_{n}^{\varphi_{i}} & = & \left(G_{i},W_{i},\Sigma_{i},\Omega_{i},U\right)\\
\mathcal{C}_{n}^{\varphi} & \coloneqq & \left(G,W,\Sigma,\Omega,U\right)
\end{eqnarray*}
Es werden neue Outputs für jedes $k$-Tupel aus $U$ hinzugefügt:
\begin{eqnarray*}
G & \coloneqq & \biguplus_{i=1}^{m}G_{i}\uplus\left\{ g_{\bar{t}}\mid\bar{t}\in U^{k}\right\} 
\end{eqnarray*}
Die Outputs werden entsprechend mit denen von $\mathcal{C}_{n}^{\varphi_{i}}$
verknüpft, wobei $\rho_{i}:U^{k}\rightarrow U^{k_{i}}$ ein $k$-Tupel
$\bar{t}$ wie folgt auf die in $\varphi_{i}$ frei vorkommenden Variablen
reduziere:
\begin{eqnarray*}
\mathrm{Sei}\,\,\,\bar{j} & \in & \left[1,k\right]^{k_{i}}\\
\mathrm{so}\,\mathrm{dass}\,\,\,\bar{y_{i}} & = & \left(x_{\left(j_{1}\right)},\cdots,x_{\left(j_{k_{i}}\right)}\right)
\end{eqnarray*}
\begin{eqnarray*}
\mathrm{dann}\,\,\,\rho_{i}\left(t_{1},\cdots,t_{k}\right) & \coloneqq & \left(t_{\left(j_{1}\right)},\cdots,t_{\left(j_{k_{i}}\right)}\right)
\end{eqnarray*}
\begin{eqnarray*}
W & \coloneqq & \bigcup_{i=1}^{m}W_{i}\cup W_{\mathtt{AND}}\\
W_{\mathtt{AND}} & \coloneqq & \left\{ \left(\Omega_{i}\left(\rho_{i}\bar{t}\right),g_{\bar{t}}\right)\mid1\leqslant i\leqslant m,\,\bar{t}\in U^{k}\right\} 
\end{eqnarray*}
Die Gates werden entsprechend beschriftet:
\begin{eqnarray*}
\Sigma\left(g\right) & \coloneqq & \begin{cases}
\Sigma_{i}\left(g\right) & \mathrm{f\ddot{u}r}\,\,g\in G_{i}\\
\mathtt{AND} & \mathrm{sonst}
\end{cases}\\
\Omega\left(\bar{t}\right) & \coloneqq & g_{\bar{t}}\,\,\mathrm{f\ddot{u}r\,alle\,\,}\bar{t}\in U^{k}
\end{eqnarray*}

\item [{Korrektheit:}] Es gilt für $\bar{t}\in U^{k}$: 
\begin{eqnarray*}
\left\llbracket \varphi_{1}\wedge\cdots\wedge\varphi_{m}\right\rrbracket \left(\mathfrak{A},\bar{t}\right) & = & \min_{1\leqslant i\leqslant m}\left\llbracket \varphi_{i}\right\rrbracket \left(\mathfrak{A},\bar{t}\right)\\
 & = & \min_{1\leqslant i\leqslant m}\mathcal{C}_{n}^{\varphi_{i}}\left[\mathfrak{A}\right]\left(\Omega_{i}\left(\rho_{i}\bar{t}\right)\right)\\
 & = & \mathcal{C}_{n}^{\varphi}\left[\mathfrak{A}\right]\left(g_{\bar{t}}\right)
\end{eqnarray*}

\item [{Symmetrie:}] Es existieren bereits die Automorphismen $\hat{\pi_{i}}$
für jeden Schaltkreis $\mathcal{C}_{n}^{\varphi_{i}}$. Der Automorphismus
$\hat{\pi}$ erweitert diese wie folgt:
\[
\hat{\pi}\left(g\right)\coloneqq\begin{cases}
\hat{\pi}_{i}\left(g\right) & \mathrm{f\ddot{u}r}\,g\in G_{i}\\
g_{\pi\bar{t}} & \mathrm{f\ddot{u}r}\,g=g_{\bar{t}}
\end{cases}
\]
Für die Gates und Kanten der Schaltkreise $\mathcal{C}_{n}^{\varphi_{i}}$
ist $\hat{\pi}$ per Annahme bereits korrekt.

\begin{enumerate}
\item Für jede neue Kante $\left(\Omega_{i}\left(\rho_{i}\bar{t}\right),g_{\bar{t}}\right)\in W_{\mathtt{AND}}$
gilt nach Voraussetzung: 
\begin{eqnarray*}
\left(\hat{\pi}\Omega_{i}\left(\rho_{i}\bar{t}\right),\hat{\pi}g_{\bar{t}}\right) & = & \left(\hat{\pi}_{i}\Omega_{i}\left(\rho_{i}\bar{t}\right),\hat{\pi}g_{\bar{t}}\right)\\
 & = & \left(\Omega_{i}\left(\rho_{i}\pi\bar{t}\right),g_{\pi\bar{t}}\right)\\
 & \in & W_{\mathtt{AND}}
\end{eqnarray*}
(Die Reduktion $\rho_{i}:U^{k}\rightarrow U^{k_{i}}$ ist ein Homomorphismus
und kommutiert mit der Permutation $\pi$.)
\item Es gilt $\Sigma\left(\hat{\pi}g_{\bar{t}}\right)=\Sigma\left(g_{\bar{t}}\right)=\mathtt{AND}$.
\item Es gilt $\hat{\pi}\Omega\left(\bar{t}\right)=\hat{\pi}g_{\bar{t}}=g_{\pi\bar{t}}=\Omega\left(\pi\bar{t}\right)$.
\end{enumerate}
\item [{Größe:}] Der Schaltkreis hat die Tiefe $T\left(\mathcal{C}_{n}^{\varphi}\right)$
und die Größe $\left|\mathcal{C}_{n}^{\varphi}\right|$: 
\begin{eqnarray*}
T\left(\mathcal{C}_{n}^{\varphi}\right) & = & 1+\max_{i=1}^{m}T\left(\mathcal{C}_{n}^{\psi_{i}}\right)\\
 & \overset{\mathrm{Ann.}}{\leqslant} & 1+\max_{i=1}^{m}\left\Vert \psi_{i}\right\Vert \\
 & \leqslant & 1+\sum_{i=1}^{m}\left\Vert \psi_{i}\right\Vert \leqslant\left\Vert \varphi\right\Vert 
\end{eqnarray*}
 
\begin{eqnarray*}
\left|\mathcal{C}_{n}^{\varphi}\right| & = & n^{k}+\sum_{i=1}^{m}\left|\mathcal{C}_{n}^{\psi_{i}}\right|\\
 & \overset{\mathrm{Ann.}}{\leqslant} & n^{k}+\sum_{i=1}^{m}\left\Vert \psi_{i}\right\Vert n^{\mathtt{MF}\left(\psi_{i}\right)}\\
 & \leqslant & n^{\mathtt{MF}\left(\varphi\right)}+\sum_{i=1}^{m}\left\Vert \psi_{i}\right\Vert n^{\mathtt{MF}\left(\varphi\right)}\\
 & \leqslant & n^{\mathtt{MF}\left(\varphi\right)}\left(1+\sum_{i=1}^{m}\left\Vert \psi_{i}\right\Vert \right)\leqslant n^{\mathtt{MF}\left(\varphi\right)}\left\Vert \varphi\right\Vert 
\end{eqnarray*}

\end{description}
\item Falls $\varphi\left(\bar{x}\right)=\varphi_{1}\vee\cdots\vee\varphi_{\ell}$,
so ist der Schaltkreis analog zu Fall 3 mit $\Sigma\left(g_{\bar{t}}\right)=\mathtt{OR}$.
\item Falls $\varphi\left(\bar{x}\right)=\neg\psi$, so wird der Schaltkreis
$\mathcal{C}_{n}^{\psi}$ wie folgt erweitert:

\begin{description}
\item [{Schaltkreis:}] 
\begin{eqnarray*}
\mathcal{C}_{n}^{\psi} & = & \left(G',W',\Sigma',\Omega',U\right)\\
\mathcal{C}_{n}^{\varphi} & \coloneqq & \left(G,W,\Sigma,\Omega,U\right)
\end{eqnarray*}
Für jedes Tupel $\bar{t}\in U^{k}$ wird ein neues Gate $g_{\bar{t}}$
eingefügt. Die Gates werden mit den Outputs von $\mathcal{C}_{n}^{\varphi'}$
verknüpft. 
\begin{eqnarray*}
G & \coloneqq & G'\uplus\left\{ g_{\bar{t}}\mid\bar{t}\in U^{k}\right\} \\
W & \coloneqq & W'\cup W_{\mathtt{NOT}}\\
W_{\mathtt{NOT}} & \coloneqq & \left\{ \left(\Omega'\left(\bar{t}\right),g_{\bar{t}}\right)\mid\bar{t}\in U^{k}\right\} \\
\Sigma\left(g\right) & \coloneqq & \begin{cases}
\Sigma'\left(g\right) & \mathrm{falls}\,\,g\in G'\\
\mathtt{NOT} & \mathrm{sonst}
\end{cases}\\
\Omega\left(\bar{t}\right) & \coloneqq & g_{\bar{t}}
\end{eqnarray*}

\item [{Korrektheit:}] 
\begin{eqnarray*}
\left\llbracket \neg\psi\right\rrbracket \left(\mathfrak{A},\bar{t}\right) & = & 1-\left\llbracket \psi\right\rrbracket \left(\mathfrak{A},\bar{t}\right)\\
 & = & 1-\mathcal{C}_{n}^{\psi}\left[\mathfrak{A}\right]\left(\Omega'\left(\bar{t}\right)\right)\\
 & = & \mathcal{C}_{n}^{\varphi}\left[\mathfrak{A}\right]\left(g_{\bar{t}}\right)
\end{eqnarray*}

\item [{Symmetrie:}] Es existiert bereits der Automorphismus $\hat{\pi'}$.
Dieser wird wie folgt erweitert:
\[
\hat{\pi}\left(g\right)\coloneqq\begin{cases}
\hat{\pi'}\left(g\right) & \mathrm{falls}\,\,g\in G'\\
g_{\pi\bar{t}} & \mathrm{falls}\,\,g=g_{\bar{t}}
\end{cases}
\]
Dann gilt:
\begin{eqnarray*}
\hat{\pi}W_{\mathtt{NOT}} & = & \left\{ \left(\hat{\pi}\Omega'\left(\bar{t}\right),\hat{\pi}g_{\bar{t}}\right)\mid\bar{t}\in U^{k}\right\} \\
 & = & \left\{ \left(\Omega'\left(\pi\bar{t}\right),g_{\pi\bar{t}}\right)\mid\bar{t}\in U^{k}\right\} =W_{\mathtt{NOT}}\\
\Sigma\left(\hat{\pi}g_{\bar{t}}\right) & = & \Sigma\left(g_{\bar{t}}\right)=\mathtt{NOT}
\end{eqnarray*}

\item [{Größe:}] Der Schaltkreis hat die Tiefe $T\left(\mathcal{C}_{n}^{\varphi}\right)$
und die Größe $\left|\mathcal{C}_{n}^{\varphi}\right|$: 
\begin{eqnarray*}
T\left(\mathcal{C}_{n}^{\varphi}\right) & = & 1+T\left(\mathcal{C}_{n}^{\psi}\right)\\
 & \leqslant & 1+\left\Vert \psi\right\Vert \leqslant\left\Vert \varphi\right\Vert 
\end{eqnarray*}
\begin{eqnarray*}
\left|\mathcal{C}_{n}^{\varphi}\right| & = & n^{k}+\left|\mathcal{C}_{n}^{\psi}\right|\\
 & \overset{\mathrm{Ann.}}{\leqslant} & n^{k}+\left\Vert \psi\right\Vert n^{\mathtt{MF}\left(\psi\right)}\\
 & \leqslant & n^{\mathtt{MF}\left(\varphi\right)}+\left\Vert \psi\right\Vert n^{\mathtt{MF}\left(\varphi\right)}\\
 & \leqslant & \left\Vert \varphi\right\Vert n^{\mathtt{MF}\left(\varphi\right)}
\end{eqnarray*}

\end{description}
\item \label{case:fo-ex}Falls $\varphi\left(\bar{x}\right)=\exists y_{1}\cdots\exists y_{m}\psi\left(z_{1},\cdots,z_{k+m}\right)$,
so wird der Schaltkreis $\mathcal{C}_{n}^{\varphi'}$ wie folgt erweitert:

\begin{description}
\item [{Schaltkreis:}] 
\begin{eqnarray*}
\mathcal{C}_{n}^{\varphi} & \coloneqq & \left(G,W,\Sigma,\Omega,U\right)\\
\mathcal{C}_{n}^{\varphi'} & \coloneqq & \left(G',W',\Sigma',\Omega',U\right)
\end{eqnarray*}
Sei $\rho:U^{k+m}\rightarrow U^{k}$ die Abbildung, die aus $\bar{z}$
die gebundenen Variablen $\bar{y}$ entferne:
\begin{eqnarray*}
\mathrm{Sei}\,\,\,\bar{i} & \in & \left[1,k\right]^{k}\\
\mathrm{so}\,\mathrm{dass}\,\,\,\bar{x} & = & \left(z_{\left(i_{1}\right)},\cdots,z_{\left(i_{k}\right)}\right)\\
\mathrm{dann}\,\,\,\rho\left(t_{1},\cdots,t_{k}\right) & \coloneqq & \left(t_{\left(i_{1}\right)},\cdots,t_{\left(i_{k}\right)}\right)
\end{eqnarray*}

\end{description}

Es werden neue Outputs eingefügt.
\begin{eqnarray*}
G & \coloneqq & G'\uplus\left\{ g_{\bar{t}}\mid\bar{t}\in U^{k}\right\} 
\end{eqnarray*}
Jedes Gate $\Omega'\left(\bar{u}\right)$ mit $\bar{u}\in U^{k+m}$
wird mit dem Gate $g_{\rho\bar{u}}$ verknüpft.
\begin{eqnarray*}
W & \coloneqq & W'\cup W_{\exists}\\
W_{\exists} & \coloneqq & \left\{ \left(\Omega'\left(\bar{u}\right),g_{\rho\bar{u}}\right)\mid\bar{u}\in U^{k+m}\right\} 
\end{eqnarray*}



Die neuen Outputs werden mit $\mathtt{OR}$ markiert.
\begin{eqnarray*}
\Sigma\left(g\right) & \coloneqq & \begin{cases}
\Sigma'\left(g\right) & \mathrm{f\ddot{u}r}\,g\in G'\\
\mathtt{OR} & \mathrm{sonst}
\end{cases}
\end{eqnarray*}
\[
\Omega\left(\bar{t}\right)\coloneqq g_{\bar{t}}
\]

\begin{description}
\item [{Korrektheit:}] Für $\bar{t}\in U^{k}$ gilt: 
\begin{eqnarray*}
\left\llbracket \varphi\right\rrbracket \left(\mathfrak{A},\bar{t}\right) & = & \max_{\begin{subarray}{c}
\bar{u}\in U^{k+m}\\
\rho\bar{u}=\bar{t}
\end{subarray}}\left\llbracket \psi\right\rrbracket \left(\mathfrak{A},\bar{u}\right)=1\\
 & = & \max_{\begin{subarray}{c}
\bar{u}\in U^{k+m}\\
\rho\bar{u}=\bar{t}
\end{subarray}}\left(\mathcal{C}_{n}^{\varphi}\left[\mathfrak{A}\right]\left(\Omega'\left(\bar{u}\right)\right)\right)\\
 & = & \mathcal{C}_{n}^{\varphi}\left[\mathfrak{A}\right]\left(g_{\bar{t}}\right)
\end{eqnarray*}

\item [{Symmetrie:}] Es existiert bereits der Automorphismus $\hat{\pi'}$.
Dieser wird wie folgt erweitert:
\[
\hat{\pi}\left(g\right)\coloneqq\begin{cases}
\hat{\pi'}\left(g\right) & \mathrm{f\ddot{u}r}\,\,g\in G'\\
g_{\pi\bar{t}} & \mathrm{f\ddot{u}r}\,\,g=g_{\bar{t}}
\end{cases}
\]
Auf den Gates von $\mathcal{C}_{n}^{\varphi'}$ ist $\hat{\pi}$ per
Annahme treu zu $\pi$.

\begin{enumerate}
\item Für die neuen Kanten $\left(\Omega'\left(\bar{u}\right),g_{\rho\bar{u}}\right)\in W$
gilt: 
\[
\left(\hat{\pi}\Omega'\left(\bar{u}\right),\hat{\pi}g_{\rho\bar{u}}\right)=\left(\Omega'\left(\pi\bar{u}\right),g_{\rho\pi\bar{u}}\right)\in W
\]

\item $\hat{\pi}\Sigma\left(g_{\bar{t}}\right)=\Sigma\left(g_{\bar{t}}\right)=\mathtt{OR}$.
\item $\Omega\left(\pi\bar{t}\right)=g_{\pi\bar{t}}=\hat{\pi}g_{\bar{t}}=\hat{\pi}\Omega\left(\bar{t}\right)$.
\end{enumerate}
\item [{Größe:}] Der Schaltkreis hat die Tiefe $T\left(\mathcal{C}_{n}^{\varphi}\right)$
und die Größe $\left|\mathcal{C}_{n}^{\varphi}\right|$:
\begin{eqnarray*}
T\left(\mathcal{C}_{n}^{\varphi}\right) & = & 1+T\left(\mathcal{C}_{n}^{\psi}\right)\\
 & \leqslant & 1+\left\Vert \psi\right\Vert \leqslant\left\Vert \varphi\right\Vert 
\end{eqnarray*}
\begin{eqnarray*}
\left|\mathcal{C}_{n}^{\varphi}\right| & = & n^{k}+\left|\mathcal{C}_{n}^{\psi}\right|\\
 & \overset{\mathrm{Ann.}}{\leqslant} & n^{k}+\left\Vert \psi\right\Vert n^{\mathtt{MF}\left(\psi\right)}\\
 & \leqslant & n^{\mathtt{MF}\left(\varphi\right)}+\left\Vert \psi\right\Vert n^{\mathtt{MF}\left(\varphi\right)}\\
 & \leqslant & \left\Vert \varphi\right\Vert n^{\mathtt{MF}\left(\varphi\right)}
\end{eqnarray*}

\end{description}
\item \label{case:fo-forall}Falls $\varphi\left(\bar{x}\right)=\forall y_{1}\cdots\forall y_{m}\psi\left(\bar{z}\right)$,
so sei der Schaltkreis analog zu Fall 8 mit $\Sigma\left(g_{\bar{t}}\right)\coloneqq\mathtt{AND}$.\end{casenv}
\begin{description}
\item [{Speicherplatz}] Die beschriebene Konstruktion wird von dem $\left\Vert \varphi\right\Vert \left|\mathrm{var}\left(\varphi\right)\right|\log n$-platzbeschränkten
Algorithmus \ref{alg:fo-circ} berechnet.


Jeder Aufruf von $\mathtt{Berechne}\left(\varphi\left(\bar{x}\right)\right)$
iteriert über Variablen $\bar{t}\in U^{\mathrm{var}\left(\varphi\right)}$,
die $\mathrm{var}\left(\varphi\right)\log n$ Bits belegen. Da die
maximale Tiefe der Rekursion durch $\left\Vert \varphi\right\Vert $
beschränkt ist, werden insgesamt $\left\Vert \varphi\right\Vert \left|\mathrm{var}\left(\varphi\right)\right|\log n$
Bits benötigt.


(Hierbei werden ohne Details eine passende Kodierung der Formel $\varphi$
und ein Algorithmus zur platz-effizienten Berechnung von $\mathrm{frei}\left(\varphi\right)$
vorausgesetzt.)

\end{description}
\end{proof}
\begin{algorithm}
\begin{lyxcode}
Berechne($\varphi\left(\bar{x}\right)$):
\begin{lyxcode}
Für~jedes~$\bar{t}\in\left[1,n\right]^{\mathrm{ar}\left(\bar{x}\right)}$:
\begin{lyxcode}
Gib~Gate~$g_{\varphi\left(\bar{t}\right)}$~und~$\Omega_{\varphi}\left(\bar{t}\right)\coloneqq g_{\varphi\left(\bar{t}\right)}$~aus.

Gib~$\Sigma_{\varphi}\left(g_{\varphi\left(\bar{t}\right)}\right)$~entsprechend~der~Konstruktion~aus.
\end{lyxcode}
Für~jede~direkte~Teilformel~$\psi\left(\bar{y}\right)$:
\begin{lyxcode}
Berechne($\psi\left(\bar{y}\right)$).

Für~jedes~$\bar{t}\in\left[1,n\right]^{\mathrm{ar}\left(\bar{x}\right)}$:
\begin{lyxcode}
Für~jedes~$\bar{t}'\in\left[1,n\right]^{\mathrm{ar}\left(\bar{y}\right)}$:
\begin{lyxcode}
Falls~$t_{i}=t'_{j}$~für~alle~$i\in\left[1,\mathrm{ar}\left(\bar{x}\right)\right],j\in\left[1,\mathrm{ar}\left(\bar{y}\right)\right]$~mit~$x_{i}=y_{j}$:
\begin{lyxcode}
Verknüpfe~$\Omega_{\psi}\left(\bar{t}'\right)$~mit~$g_{\varphi\left(\bar{t}\right)}$.
\end{lyxcode}
\end{lyxcode}
\end{lyxcode}
\end{lyxcode}
\end{lyxcode}
\end{lyxcode}
\caption{\label{alg:fo-circ}Berechnung von $\mathcal{C}_{n}^{\varphi}$ für
$\mathrm{FO}\left[\sigma\right]$-Formeln.}
\end{algorithm}



\section{Disjunkte numerische Erweiterungen}

Wir betrachten eine beliebige numerische Erweiterung $\mathcal{L}+\Upsilon$,
und weisen nach, dass eine Schaltkreis-Konstruktion für $\mathcal{L}$
angepasst werden kann, ohne die asymptotische Tiefe und Größe zu verändern.

Die neue Schaltkreisfamilie ist $\mathcal{K}$-uniform (mit $\mathcal{K}\supseteq\mathrm{LOGSPACE}$),
wenn sowohl die Konstruktion für $\mathcal{L}$ als auch das Orakel
$\mathcal{K}$-uniform sind.
\begin{lem}
\label{lem:oracle-circuit}Sei $\mathcal{L}$ eine Logik, $\mathbb{B}$
eine boolesche Basis und $\mathcal{K}\supseteq\mathrm{LOGSPACE}$
eine Komplexitätsklasse, so dass für jede $\mathcal{L}\left[\sigma\right]$-Formel
eine symmetrische $\mathcal{K}$-uniforme $\left(\sigma,\mathbb{B}\right)$-Schaltkreisfamilie
mit $t\left(n\right)$-Tiefe und $s\left(n\right)$-Größe (mit $s\mathrm{\left(n\right)\in\mathrm{poly}\left(n\right)}$)
existiert, die die gleiche Anfrage beschreibt.

Sei $\eta$ eine von $\sigma$ disjunkte Signatur und $\Upsilon$
ein $\mathcal{K}$-uniformes $\eta$-Orakel.

Dann existiert auch für jede $\left(\mathcal{L}+\Upsilon\right)\left[\sigma\right]$-Formel
eine ebensolche Schaltkreisfamilie mit der Tiefe $t'\left(n\right)\coloneqq t\left(2n+1\right)$
und der Größe $s'\left(n\right)\coloneqq s\left(2n+1\right)$.
\end{lem}
Insbesondere folgt dann aus der Kombination mit Lemma \ref{lem:fo-circuit}:
\begin{eqnarray*}
\mathrm{FO}+\mathbf{BIT} & \subseteq & \left(\mathrm{SAC}^{0}\right)^{\mathrm{LOGSPACE}}\\
\mathrm{FO}+\mathbf{ARB} & \subseteq & \left(\mathrm{SAC}^{0}\right)^{P/\mathrm{poly}}
\end{eqnarray*}

\begin{proof}
Sei $\varphi$ eine $\left(\mathcal{L}+\Upsilon\right)\left[\sigma\right]$-Formel.
Für $n\in\mathbb{N}$ und $\mathfrak{A}\in\mathbf{FIN}^{\left(n\right)}\left(\sigma\right)$
wird $\varphi$ als $\mathcal{L}\left[\sigma\uplus\eta\uplus\left\{ \leqslant\right\} \right]$-Formel
auf der disjunkt vereinigten $\left(\sigma\uplus\eta\uplus\left\{ \leqslant\right\} \right)$-Struktur
$\mathfrak{A}\uplus\Upsilon\left(n\right)$ ausgewertet, wobei $\Upsilon\left(n\right)\in\mathbf{FIN}_{<}^{\left[0,n\right]}\left(\eta\right)$
das Universum $\left[0,n\right]$ hat.

Der Schaltkreis $\mathcal{C}_{n}$ wird aber auf einer umbenannten
$\sigma$-Struktur $\mathfrak{A}'\coloneqq\pi\mathfrak{A}\in\mathbf{FIN}^{\left[1,n\right]}\left(\sigma\right)$
mit für $\pi:A\rightleftarrows\left[1,n\right]$ ausgewertet. Um $\mathfrak{A}'$
disjunkt mit $\Upsilon\left(n\right)$ zu vereinigen, werden wir zuerst
das Universum $\left[0,n\right]$ durch eine Umbenennung nach $\left[n+1,2n+1\right]$
,,verschieben``:
\begin{eqnarray*}
\Upsilon'\left(n\right) & \coloneqq & \rho\Upsilon\left(n\right)\\
\rho & : & \left[0,n\right]\rightarrow\left[n+1,2n+1\right]\\
\rho\left(i\right) & \coloneqq & i+n+1
\end{eqnarray*}


Nun betrachten wir die disjunkte Vereinigung (wobei die Prädikate
aus $\eta\uplus\left\{ \leqslant\right\} $ nur auf $\left[n+1,2n+1\right]$
definiert sind): 
\[
\mathfrak{A}'\uplus\Upsilon'\left(n\right)\in\mathbf{FIN}^{\left[1,2n+1\right]}\left(\sigma\uplus\eta\uplus\left\{ \leqslant\right\} \right)
\]


Weil $\Upsilon\left(n\right)\cong\Upsilon'\left(n\right)$ und $\mathfrak{A}\cong\mathfrak{A}'$,
gilt auch $\mathfrak{A}\uplus\Upsilon\left(n\right)\cong\mathfrak{A}'\uplus\Upsilon'\left(n\right)$
(denn der Isomorphismus ist unter disjunkter Vereinigung abgeschlossen):
\[
\left\llbracket \varphi\right\rrbracket \left(\mathfrak{A}\uplus\Upsilon\left(n\right),\beta\right)=\left\llbracket \varphi\right\rrbracket \left(\mathfrak{A}'\uplus\Upsilon'\left(n\right),\beta\right)
\]


Per Voraussetzung können wir in $\mathcal{K}$ einen $\left(\sigma\uplus\eta\uplus\left\{ \leqslant\right\} ,\mathbb{B}\right)$-Schaltkreis
$\mathcal{C}_{2n+1}^{\varphi}$ über $U'=\left[1,2n+1\right]$ berechnen.
Dieser arbeitet korrekt auf $\mathfrak{A}'\uplus\Upsilon'\left(n\right)$
und hat offensichtlich die geforderte Größe $s'\left(n\right)=s\left(2n+1\right)$
und Tiefe $t'\left(n\right)=t\left(2n+1\right)$.

Anschließend konstruieren wir daraus den $\left(\sigma,\mathbb{B}\right)$-Schaltkreis
$\dot{\mathcal{C}_{n}^{\varphi}}\coloneqq\left(G,W,\dot{\Sigma},\dot{\Omega},U\right)$
über $U\coloneqq\left[1,n\right]$, indem alle Inputs $\Sigma\left(g\right)=R\bar{t}$
mit $\bar{t}\notin U^{*}$ oder $R\notin\sigma$ durch Konstanten
$\dot{\Sigma}\left(g\right)\in\left\{ \mathbf{0},\mathbf{1}\right\} $
ersetzt werden, und die Ausgangsfunktion auf $\dot{\Omega}=\Omega_{\mid U}$
reduziert wird. Das ist eine einfache Iteration über die Gates $G$
des Schaltkreises, die nur einen Zähler der Größe $\log\left(s'\left(n\right)\right)\in\log\left(\mathrm{poly}\left(n\right)\right)=\mathcal{O}\left(\log n\right)$
benötigt, und somit in $\mathrm{LOGSPACE}$ bleibt.
\begin{casenv}
\item Für $\Sigma\left(g\right)=R\bar{t}$ mit $R/k\in\sigma$ werden die
,,überschüssigen`` Inputs einfach auf $\mathbf{0}$ gesetzt:
\begin{eqnarray*}
\dot{\Sigma}\left(g\right) & \coloneqq & \begin{cases}
R\bar{t} & \mathrm{falls}\,\,\bar{t}\in U^{k}\\
\mathbf{0} & \mathrm{sonst}
\end{cases}
\end{eqnarray*}

\item Für $\Sigma\left(g\right)=R\bar{t}$ mit $\sigma/k\in\eta\uplus\left\{ \leqslant\right\} $
wird die numerische Relation $R^{\Upsilon'\left(n\right)}$ fest in
den Schaltkreis eingebaut:
\begin{eqnarray*}
\dot{\Sigma}\left(g\right) & \coloneqq & \begin{cases}
\mathbf{1} & \mathrm{falls}\,\,\bar{t}\in R^{\Upsilon'\left(n\right)}\\
\mathbf{0} & \mathrm{sonst}
\end{cases}
\end{eqnarray*}

\end{casenv}
Sei nun $\pi\in\mathrm{Sym}_{U}$ eine beliebige Permutation.

Wir betrachten die Erweiterung $\pi'\coloneqq\pi\cup\mathbf{id}_{\left[n+1,2n+1\right]}$,
die die Elemente von $\Upsilon'\left(n\right)$ auf sich selbst abbildet.
Offensichtlich ist $\pi'\in\mathrm{Sym}_{U'}$ eine Permutation von
$U'=\left[1,2n+1\right]$.

Aus der Symmetrie des Schaltkreises $\mathcal{C}_{2n+1}^{\varphi}$
bezüglich $\mathrm{Sym}_{U'}$ (siehe Lemma \ref{lem:fo-circuit})
folgt die Existenz eines von $\pi'$ induzierten Automorphismus $\hat{\pi}$.

Es wird nun nachgewiesen, dass $\hat{\pi}$ auch ein von $\pi$ induzierter
Automorphismus in $\dot{\mathcal{C}_{n}^{\varphi}}$ ist. Dazu müssen
nur $\dot{\Sigma}$ und $\dot{\Omega}$ betrachtet werden, da der
Graph $\left(G,W\right)$ unverändert bleibt. Ferner betrachten wir
nur die nicht-konstanten Inputs von $\mathcal{C}_{2n+1}^{\varphi}$,
denn ansonsten bleibt $\Sigma$ unverändert.
\begin{casenv}
\item Für $\Sigma\left(g\right)=R\bar{t}$ mit $R/k\in\sigma$ gilt:

\begin{casenv}
\item Falls $\bar{t}\in U^{k}$:
\[
\dot{\Sigma}\left(\hat{\pi}g\right)=\Sigma\left(\hat{\pi}g\right)=R\pi\bar{t}
\]

\item Sonst:
\[
\dot{\Sigma}\left(\hat{\pi}g\right)=\mathbf{0}=\dot{\Sigma}\left(g\right)
\]

\end{casenv}
\item Für $\Sigma\left(g\right)=R\bar{t}$ mit $R/k\in\eta\uplus\left\{ \leqslant\right\} $
gilt:

\begin{casenv}
\item Falls $\bar{t}\in R^{\Upsilon'\left(n\right)}\subseteq\left[n+1,2n+1\right]^{k}$,
dann ist $\pi'\bar{t}=\bar{t}$:
\[
\dot{\Sigma}\left(\hat{\pi}g\right)=\mathbf{1}=\dot{\Sigma}\left(g\right)
\]

\item Sonst:
\[
\dot{\Sigma}\left(\hat{\pi}g\right)=\mathbf{0}=\dot{\Sigma}\left(g\right)
\]

\end{casenv}
\end{casenv}
Außerdem gilt ist $U^{k}$ bezüglich $\pi'$ abgeschlossen: 
\[
\hat{\pi}\dot{\Omega}\left(\bar{t}\right)=\hat{\pi}\Omega\left(\bar{t}\right)=\Omega\left(\pi'\bar{t}\right)=\dot{\Omega}\left(\pi'\bar{t}\right)
\]
 Damit ist $\bar{\dot{\mathcal{C}^{\varphi}}}$ eine symmetrische,
$\mathcal{K}$-uniforme Schaltkreisfamilie mit Tiefe $t'\left(n\right)=t\left(2n+1\right)$
und Größe $s'\left(n\right)=s\left(2n+1\right)$, die $q$ berechnet.
\end{proof}

\section{Logiken mit Zählquantoren}

Wir betrachten die Logik $\mathcal{L}+\Upsilon+C$, und weisen nach,
dass die Konstruktion von Lemma \ref{lem:oracle-circuit} angepasst
werden kann, indem Majority-Gates hinzugefügt werden.
\begin{lem}
\label{lem:counting-circuit}Sei $\mathcal{L}$ eine Logik, $c\in\mathbb{N}$
eine Konstante, $\mathbb{B}$ eine boolesche Basis und $\mathcal{K}\supseteq\mathrm{LOGSPACE}$
eine Komplexitätsklasse.

Es gelte die Voraussetzung dass für jede $\mathcal{L}\left[\sigma\right]$-Formel
eine symmetrische, $\mathcal{K}$-uniforme $\left(\sigma,\mathbb{B}\right)$-Schaltkreisfamilie
mit $\left\Vert \varphi\right\Vert n^{c\left\Vert \varphi\right\Vert }$-Tiefe
und $\left\Vert \varphi\right\Vert n^{\left\Vert \varphi\right\Vert }$-Größe
existiert, die die gleiche Anfrage beschreibt.

Sei $\eta$ eine von $\sigma$ disjunkte Signatur und $\Upsilon$
ein $\mathcal{K}$-uniformes $\eta$-Orakel.

Dann existiert für jede $\left(\mathcal{L}+\Upsilon+C\right)\left[\sigma\right]$
eine ebensolche $\left(\sigma,\mathbb{B}\cup\left\{ \mathtt{MAJ}\right\} \right)$-Schaltkreisfamilie
mit der Tiefe $\left\Vert \varphi\right\Vert \left(2n+1\right){}^{t\left\Vert \varphi\right\Vert }+\left\Vert \varphi\right\Vert $
und der Größe $\left\Vert \varphi\right\Vert \left(2n+1\right)^{\left\Vert \varphi\right\Vert }+2n\left\Vert \varphi\right\Vert $. 
\end{lem}
Insbesondere folgt aus der Kombination mit Lemma \ref{lem:fo-circuit}
und Lemma \ref{lem:oracle-circuit} (mit $c=0$ und der Tiefenbeschränkung
$\mathcal{O}\left(1\right)$):

\begin{eqnarray*}
\mathrm{FO}+\mathbf{BIT}+C & \subseteq & \left(\mathrm{SAC}^{0}+\mathbf{MAJ}\right)^{\mathrm{LOGSPACE}}\\
\mathrm{FO}+\mathbf{ARB}+C & \subseteq & \left(\mathrm{SAC}^{0}+\mathbf{MAJ}\right)^{P/\mathrm{poly}}
\end{eqnarray*}
Wir werden in diesem Fall konkret mit $\exists^{\geqslant}$-Quantoren
arbeiten, denn per Satz \ref{prop:counting-equal} sind diese gleich
ausdrucksstark mit $\exists^{=}$-Quantoren und $\#$-Termen.
\begin{proof}
Sei $\varphi$ eine $\left(\mathcal{L}+\Upsilon+\exists^{\geqslant}\right)\left[\sigma\right]$-Formel,
und sei $n\in\mathbb{N}$ die Eingabegröße. Wir gehen analog zu Lemma
\ref{lem:oracle-circuit} für $\mathcal{L}+\Upsilon$ vor und erzeugen
einen $\left(\sigma\uplus\eta\uplus\left\{ \leqslant\right\} ,\mathbb{B}\cup\left\{ \mathtt{MAJ}\right\} \right)$-Schaltkreis
über $U'=\left[1,2n+1\right]$, wobei wir die folgende induktive Konstruktion
verwenden:
\begin{casenv}
\item Falls $\varphi\left(\bar{x}\right)$ eine $\left(\mathcal{L}+\Upsilon\right)\left[\sigma\right]$-Formel
ohne $\exists^{\geqslant}$-Quantor ist, so existiert der $\left(\sigma\uplus\eta\uplus\left\{ \leqslant\right\} ,\mathbb{B}\right)$-Schaltkreis
$\mathcal{C}_{2n+1}^{\varphi}$ schon per Voraussetzung.
\item Falls $\varphi\left(\bar{x}\right)=\exists^{\geqslant x_{i}}y_{j}\psi\left(\bar{y}\right)$
mit $\bar{x}\in\mathbf{var}^{k}$, so nehmen wir an, dass die Behauptung
für $\psi$ gilt. 


Sei $\mathcal{C}_{2n+1}^{\psi}$ der symmetrische Schaltkreis für
die Formel $\psi$ mit der Tiefe $t\leqslant\left\Vert \psi\right\Vert \left(2n+1\right)^{c\left\Vert \psi\right\Vert }+\left\Vert \psi\right\Vert $
und der Größe $s\leqslant\left\Vert \psi\right\Vert \left(2n+1\right)^{\left\Vert \psi\right\Vert }+2n\left\Vert \psi\right\Vert $.
\[
\mathcal{C}_{2n+1}^{\psi}=\left(G_{\psi},W_{\psi},\Sigma_{\psi},\Omega_{\psi},U'\right)
\]
Wir erzeugen den folgenden Schaltkreis $\mathcal{C}_{2n+1}^{\varphi}$:
\begin{eqnarray*}
\mathcal{C}_{2n+1}^{\varphi} & \coloneqq & \left(G,W,\Sigma,\Omega,U'\right)
\end{eqnarray*}
Es wird für jedes Tupel $\bar{t}\in\left[1,2n+1\right]^{k}$ ein neuer
Output $g_{\bar{t}}$ eingefügt; ferner werden $2n$ Konstanten eingefügt:
\begin{eqnarray*}
G & = & G_{\psi}\uplus\left\{ g_{\bar{t}}\mid\bar{t}\in U'^{k}\right\} \uplus\left\{ 0_{j},1_{j}\mid1\leqslant j\leqslant n\right\} \\
W & = & W_{\psi}\uplus W_{\mathrm{maj}}\uplus W_{\mathrm{pad}}
\end{eqnarray*}
Die neuen Outputs werden mit $\mathtt{MAJ}$ markiert, falls $t_{i}$
(der Wert der Variable $x_{i}$) einer der numerischen Werte (im Bereich
$\rho\left[0,n\right]=\left[n+1,2n+1\right]$) ist, und sonst mit
$\mathbf{0}$. 
\[
\begin{array}{ccc}
\Sigma\left(0_{j}\right)=\mathbf{0}, & \Sigma\left(0_{j}\right)=\mathbf{1}, & \Sigma\left(g_{\bar{t}}\right)=\begin{cases}
\mathtt{MAJ} & \mathrm{falls}\,\,t_{i}\in\rho\left[0,n\right]\\
\mathbf{0} & \mathrm{sonst}
\end{cases}\end{array}
\]
\[
\Omega\left(\bar{t}\right)=g_{\bar{t}}
\]
Seien $\tau_{1},\tau_{2}:U^{k}\rightarrow U^{k-1}$ die folgenden
Abbildungen, die den Wert $t_{i}$ aus $\bar{t}$ beziehungsweise
$u_{j}$ aus $\bar{u}$ entfernen:
\begin{eqnarray*}
\tau_{1}\left(t_{1},\cdots,t_{k}\right) & = & \left(t_{1},\cdots t_{i-1},t_{i+1},\cdots,t_{k}\right)\\
\tau_{2}\left(t_{1},\cdots,t_{k}\right) & = & \left(t_{1},\cdots t_{j-1},t_{j+1},\cdots,t_{k}\right)
\end{eqnarray*}
Es gilt also $\tau_{1}\left(\bar{t}\right)=\tau_{2}\left(\bar{u}\right)$
genau dann wenn $\bar{t}$ und $\bar{u}$ in den gemeinsamen freien
Variablen von $\varphi$ und $\psi$ übereinstimmen. Das Majority-Gate
$g_{\bar{t}}$ soll prüfen, ob $t_{i}\leqslant\rho f\left(\tau_{1}\left(\bar{t}\right)\right)$,
wobei $f:U^{k-1}\rightarrow\left[0,n\right]$ die Anzahl der $\psi$
erfüllenden Belegungen von $y_{j}$ bei der Belegung der übrigen freien
Variablen mit $\tau_{1}\left(\bar{t}\right)$ sei: 
\begin{eqnarray*}
f\left(\tau_{1}\left(\bar{t}\right)\right) & \coloneqq & \left|\left\{ u_{j}\mid\bar{u}\in q_{\mathcal{C}_{2n+1}^{\psi}}\left(\mathfrak{A}\uplus\rho\Upsilon\left(n\right)\right),\,\tau_{2}\left(\bar{u}\right)=\tau_{1}\left(\bar{t}\right)\right\} \right|
\end{eqnarray*}
Dazu wird jedes Gate $g_{\bar{t}}$ mit $t_{i}\in\left[n+1,2n+1\right]$
zunächst mit den entsprechenden Outputs von $\mathcal{C}_{2n+1}^{\psi}$
verknüpft: 
\[
W_{\mathrm{maj}}=\left\{ \left(\Omega_{\psi}\left(\bar{u}\right),g_{\bar{t}}\right)\mid\bar{t},\bar{u}\in U'^{k},\,\tau_{1}\left(\bar{t}\right)=\tau_{2}\left(\bar{u}\right),\,u_{j}\in\left[1,n\right]\right\} 
\]
Momentan hat es genau $n$ Eingänge (für jeden Wert $u_{j}\in\left[1,n\right]$).
Daher gibt es $1$ aus, wenn $f\left(\bar{t}\right)\geqslant\frac{n}{2}$.
Es soll aber berechnen, ob $f\left(\bar{t}\right)\geqslant\rho^{-1}t_{i}$.
Dazu fügen wir die Kanten $W_{\mathrm{pad}}$ ein, um die Eingänge
der Majority-Gates mit Konstanten aufzufüllen. Ein Majority-Gate mit
$k$ zusätzlichen $\mathbf{0}$-Eingängen entscheidet $f\left(\bar{t}\right)\geqslant\frac{n+k}{2}$,
eines mit $k'$ zusätzlichen $\mathbf{1}$-Eingängen berechnet $f\left(\bar{t}\right)\geqslant\frac{n-k'}{2}$.
Es folgt:
\begin{eqnarray*}
\rho^{-1}t_{i} & \in & \left\{ \frac{n+k}{2},\frac{n-k'}{2}\right\} \\
k=2\rho^{-1}t_{i}-n & \mbox{oder} & k'=n-2\rho^{-1}t_{i}
\end{eqnarray*}
Jedes Majority-Gate $g_{\bar{t}}$ muss entweder $k=2\rho^{-1}t_{i}-n$
$\mathbf{0}$-Eingänge oder $k'=n-2\rho^{-1}t_{i}$ $\mathbf{1}$-Eingänge
erhalten:
\begin{eqnarray*}
W_{\mathrm{pad}} & = & \left\{ \left(0_{j},g_{\bar{t}}\right)\mid\bar{t}\in U'^{k},\,t_{i}\in\rho\left[0,n\right],\,1\leqslant j\leqslant2\rho^{-1}t_{i}-n\right\} \\
 & \cup & \left\{ \left(1_{j},g_{\bar{t}}\right)\mid\bar{t}\in U'^{k},\,t_{i}\in\rho\left[0,n\right],\,1\leqslant j\leqslant n-2\rho^{-1}t_{i}\right\} 
\end{eqnarray*}
\begin{eqnarray*}
\overset{n+k=2\rho^{-1}t_{i}}{\overbrace{x_{1}\cdots x_{n}\underset{k=2\rho^{-1}t_{i}-n}{\underbrace{\mathbf{0}\mathbf{0}\cdots\mathbf{0}}}}} &  & \overset{n+k'=2n-2\rho^{-1}t_{i}}{\overbrace{x_{1}\cdots x_{n}\underset{k'=n-2\rho^{-1}t_{i}}{\underbrace{\mathbf{1}\mathbf{1}\cdots\mathbf{1}}}}}
\end{eqnarray*}
Der neue Schaltkreis hat die Tiefe 
\[
t+1\leqslant\left\Vert \psi\right\Vert n^{c\left\Vert \psi\right\Vert }+\left\Vert \psi\right\Vert +1<\left\Vert \varphi\right\Vert n^{c\left\Vert \varphi\right\Vert }+\left\Vert \varphi\right\Vert 
\]
 und die Größe 
\begin{eqnarray*}
s+n^{k}+2n & \leqslant & \left(\left\Vert \psi\right\Vert +1\right)n^{\left\Vert \varphi\right\Vert }+2n\left(\left\Vert \psi\right\Vert +1\right)\\
 & \leqslant & \left\Vert \varphi\right\Vert n^{\left\Vert \varphi\right\Vert }+2n\left\Vert \varphi\right\Vert 
\end{eqnarray*}


\item Falls $\varphi\left(\bar{x}\right)$ eine andere $\left(\mathcal{L}+\Upsilon+\exists^{\geqslant}\right)\left[\sigma\right]$-Formel
ist, so seien $\psi_{1}\left(\bar{y}_{1}\right),\cdots,\psi_{m}\left(\bar{y}_{m}\right)$
alle größten\footnote{d.h. solche, die nicht selbst in einer Teilformel der gleichen Form
enthalten sind.} Teilformeln von $\varphi$ der Form $\psi_{i}=\exists^{\geqslant u_{i}}v_{i}\chi_{i}$.
Wir ersetzen diese Teilformeln durch neue Atome $R_{1}\bar{y}_{1},\cdots,R_{m}\bar{y}_{m}$
und erhalten eine $\left(\mathcal{L}+\Upsilon\right)\left[\sigma\uplus\left\{ R_{1},\cdots,R_{m}\right\} \right]$-Formel
$\varphi'$, die per Voraussetzung zu einer $\left(\sigma\uplus\eta\uplus\left\{ \leqslant\right\} ,\mathbb{B}\right)$-Schaltkreisfamilie
$\mathcal{C}_{2n+1}^{\varphi'}$ wird. Per Annahme existiert für jede
der Teilformeln $\psi_{1},\cdots,\psi_{m}$ ein Schaltkreis $\mathcal{C}_{2n+1}^{\psi_{i}}$.
(In der Implementierung fügen wir den Zählquantor effektiv als Subroutine
in die bestehende Konstruktion ein.)


Wir erzeugen den Schaltkreis $\mathcal{C}_{2n+1}^{\varphi}$ aus der
disjunkten Vereinigung wie folgt:
\begin{eqnarray*}
\mathcal{C}_{2n+1}^{\psi_{i}} & = & \left(G_{i},W_{i},\Sigma_{i},\Omega_{i},\left[1,2n+1\right]\right)\\
\mathcal{C}_{2n+1}^{\varphi'} & = & \left(G',W',\Sigma',\Omega',\left[1,2n+1\right]\right)\\
\mathcal{C}_{2n+1}^{\varphi} & \coloneqq & \left(G,W,\Sigma,\Omega',\left[1,2n+1\right]\right)
\end{eqnarray*}
\begin{eqnarray*}
G & \coloneqq & G'\uplus\biguplus_{i=1}^{m}G_{i}\\
W & \coloneqq & W'\uplus\biguplus_{i=1}^{m}W_{i}\uplus\\
 &  & \uplus\left\{ \left(\Omega_{i}\left(\bar{t}\right),g\right)\mid g\in G',\,\Sigma'\left(g\right)=R_{i}\bar{t}\right\} 
\end{eqnarray*}
Die Output-Gates der Schaltkreise $\mathcal{C}_{2n+1}^{\psi_{i}}$
werden mit den $R_{i}\bar{t}$-Inputs des Schaltkreises $\mathcal{C}_{2n+1}^{\varphi'}$
verbunden, und deren Beschriftung zu $\mathtt{AND}$ geändert. 
\begin{eqnarray*}
\Sigma\left(g\right) & \coloneqq & \begin{cases}
\mathtt{AND} & \mathrm{falls}\,g\in G',\,\Sigma'\left(g\right)=R_{i}\bar{y}_{i}\\
\Sigma'\left(g\right) & \mathrm{sonst,\,falls}\,g\in G'\\
\Sigma_{i}\left(g\right) & \mathrm{sonst,\,falls}\,g\in G_{i}
\end{cases}
\end{eqnarray*}
Die Tiefe von $\mathcal{C}_{2n+1}^{\psi_{i}}$ ist $\left\Vert \psi_{i}\right\Vert \left(2n+1\right)^{c\left\Vert \psi_{i}\right\Vert }+\left\Vert \psi_{i}\right\Vert $
und die Größe ist $\left\Vert \psi_{i}\right\Vert \left(2n+1\right)^{\left\Vert \psi_{i}\right\Vert }+2n\left\Vert \psi_{i}\right\Vert $.
Der Schaltkreis $\mathcal{C}_{2n+1}^{\varphi'}$ hat per Voraussetzung
die Tiefe $\left\Vert \varphi'\right\Vert \left(2n+1\right)^{c\left\Vert \varphi'\right\Vert }$
und die Größe $\left\Vert \varphi'\right\Vert \left(2n+1\right)^{\left\Vert \varphi'\right\Vert }$.
Zusätzlich ist $\left\Vert \varphi\right\Vert \geqslant\left\Vert \varphi'\right\Vert ,\sum_{i=1}^{m}\left\Vert \psi_{i}\right\Vert $,
da die 


Daher hat der neue Schaltkreis die Tiefe
\begin{eqnarray*}
t' & \leqslant & \left\Vert \varphi'\right\Vert \left(2n+1\right)^{c\left\Vert \varphi'\right\Vert }+\max\left\Vert \psi_{i}\right\Vert \left(2n+1\right)^{c\left\Vert \psi_{i}\right\Vert }+\left\Vert \psi_{i}\right\Vert +1\\
 & \leqslant & \left\Vert \varphi\right\Vert \left(2n+1\right)^{c\left\Vert \varphi\right\Vert }+\left\Vert \varphi\right\Vert 
\end{eqnarray*}
\begin{eqnarray*}
s' & \leqslant & \left\Vert \varphi'\right\Vert \left(2n+1\right)^{\left\Vert \varphi'\right\Vert }+\sum_{i=1}^{m}\left(\left\Vert \psi_{i}\right\Vert \left(2n+1\right)^{\left\Vert \psi_{i}\right\Vert }+2n\left\Vert \psi_{i}\right\Vert \right)\\
 & \leqslant & \left\Vert \varphi\right\Vert \left(2n+1\right)^{\left\Vert \varphi\right\Vert }+2n\left\Vert \varphi\right\Vert 
\end{eqnarray*}


\end{casenv}
\begin{description}
\item [{Symmetrie:}] Der neue Schaltkreis ist offensichtlich nicht symmetrisch
bezüglich $\mathrm{Sym}_{\left[1,2n+1\right]}$, denn die Anzahl der
konstanten Vorgänger jedes Majority-Gates $g_{\bar{t}}$ hängt von
dem Wert $t_{i}$ ab. Allerdings ist er symmetrisch bezüglich der
Permutationen, die die Werte in $\left[n+1,2n+1\right]$ fixieren,
denn für alle Werte $t_{i}\in\left[1,n\right]$ ist das Gate $g_{\bar{t}}$
eine $\mathbf{0}$-Konstante. 


Sei $\pi\in\mathrm{Sym}_{U}$ beliebig, und $\pi'\coloneqq\pi\cup\mathbf{id}_{\left[n+1,2n+1\right]}$
deren Erweiterung auf $U'$. Nun erweitern wir den Automorphismus
$\hat{\pi}$ von $\mathcal{C}_{2n+1}^{\psi}$ wie folgt: 
\begin{eqnarray*}
\hat{\pi}\left(0_{i}\right) & \coloneqq & 0_{i}\\
\hat{\pi}\left(1_{i}\right) & \coloneqq & 1_{i}\\
\hat{\pi}\left(g_{\bar{t}}\right) & \coloneqq & g_{\pi'\bar{t}}
\end{eqnarray*}

\begin{enumerate}
\item Nun gilt für jede Kante $\left(\Omega_{\psi}\left(\bar{u}\right),g_{\bar{t}}\right)\in W_{\mathrm{maj}}$
mit $\bar{t},\bar{u}\in U'^{k}$ und $\tau_{1}\left(\bar{t}\right)=\tau_{2}\left(\bar{u}\right)$:
\begin{eqnarray*}
\left(\hat{\pi}\Omega_{\psi}\left(\bar{u}\right),\hat{\pi}g_{\bar{t}}\right) & \overset{\mathrm{Ann.}}{=} & \left(\Omega_{\psi}\left(\pi'\bar{u}\right),\hat{\pi}g_{\bar{t}}\right)\\
 & = & \left(\Omega_{\psi}\left(\pi'\bar{u}\right),g_{\pi'\bar{t}}\right)
\end{eqnarray*}
Und weil $\pi'\bar{t},\pi'\bar{u}\in U'^{k}$ und $\tau_{1}\left(\pi'\bar{t}\right)=\tau_{2}\left(\pi'\bar{u}\right)$
gilt, folgt:
\[
\left(\Omega_{\psi}\left(\pi'\bar{u}\right),g_{\pi'\bar{t}}\right)\in W_{\mathtt{MAJ}}
\]

\item Für jede Kante $\left(0_{j},g_{\bar{t}}\right)\in W_{\mathrm{pad}}$
(mit $\bar{t}\in U'^{k}$ und $t_{i}\in\left[n+1,2n+1\right]$, und
$j\in\left[1,2t_{i}-3n-2\right]$):
\begin{eqnarray*}
\left(\hat{\pi}0_{j},\hat{\pi}g_{\bar{t}}\right) & = & \left(0_{j},g_{\pi'\bar{t}}\right)
\end{eqnarray*}
Und weil $\pi't_{i}=t_{i}$, gilt immer noch $j\in\left[1,2\pi't_{i}-3n-2\right]$,
und daher $\left(\hat{\pi}0_{j},\hat{\pi}g_{\bar{t}}\right)\in W_{\mathrm{pad}}$.
Das gleiche gilt analog für die Kanten $\left(\hat{\pi}1_{j},\hat{\pi}g_{\bar{t}}\right)$.
\item Für $\Sigma$:
\begin{eqnarray*}
\Sigma\left(\hat{\pi}0_{j}\right) & = & \Sigma\left(0_{j}\right)\\
\Sigma\left(\hat{\pi}1_{j}\right) & = & \Sigma\left(1_{j}\right)\\
\Sigma\left(\hat{\pi}g_{\bar{t}}\right) & = & \Sigma\left(g_{\pi'\bar{t}}\right)\\
 & = & \begin{cases}
\mathtt{MAJ} & \mathrm{falls}\,\,\pi't_{i}\in\left[n+1,2n+1\right]\\
\mathbf{0} & \mathrm{sonst}
\end{cases}\\
 & = & \Sigma\left(g_{\bar{t}}\right)
\end{eqnarray*}

\item Für $\Omega$ ist $\hat{\pi}\Omega\left(\bar{t}\right)=\hat{\pi}g_{\bar{t}}=g_{\pi'\bar{t}}=\Omega\left(\pi'\bar{t}\right)$
per Definition gegeben.
\end{enumerate}
\end{description}
Nach der Erzeugung von $\mathcal{C}_{2n+1}^{\varphi}$ wird der Schaltkreis
auf die bereits beschriebene Weise zu $\dot{\mathcal{C}_{n}^{\varphi}}$
umgewandelt, in dem die nicht-konstanten Inputs mit Elementen aus
$\left[n+1,2n+1\right]$ zu Konstanten werden. Der neue Schritt fügt
keine nicht-konstanten Inputs hinzu, so dass sich hierbei nichts ändert.

Da der Schaltkreis $\mathcal{C}_{2n+1}^{\varphi}$ für jede Permutation
$\pi\cup\mathbf{id}_{\left[n+1,2n+1\right]}$ mit $\pi\in\mathrm{Sym}_{\left[1,n\right]}$
einen Automorphismus besitzt, ist der Schaltkreis $\dot{\mathcal{C}_{n}^{\varphi}}$
symmetrisch (siehe Lemma \ref{lem:oracle-circuit}).
\end{proof}

\section{Fixpunktlogik}

Die Fixpunktlogik $\mathrm{LFP}\left[\sigma\right]$ ist echt ausdrucksstärker
als die Logik $\mathrm{FO}\left[\sigma\right]$. Beispielsweise ist
die Erreichbarkeit über einen Pfad beliebiger Länge nicht erststufig
definierbar \cite{Immerman1982,Libkin2012}. In $\mathrm{LFP}\left[\left\{ E\right\} \right]$
wird diese Klasse durch die folgende Formel definiert:
\[
\varphi\left(u,v\right)\coloneqq\left[\mathrm{lfp}_{R,\left(x,y\right)}\,\left(\exists z\,\left(E\left(x,z\right)\wedge R\left(z,y\right)\right)\vee x=y\right)\right]\left(u,v\right)
\]
Jede $\mathrm{LFP}\left[\sigma\right]$-Formel $\varphi$ ist aber
äquivalent zu einer Familie von $\mathrm{FO}\left[\sigma\right]$-Formeln
$\left(\varphi_{n}\right)_{n\in\mathbb{N}}$ mit einer konstanten
Anzahl Variablen, so dass $\varphi_{n}$ auf allen Strukturen der
Größe $n$ äquivalent zu $\varphi$ ist. (Dies ist vergleichbar zum
$k$-Variablen-Fragment der infinitären Logik $L_{\infty\omega}^{k}$,
welches die Fixpunktlogik einschließt\cite{Dawar1995c,Kolaitis1992,Kolaitis1992b}.
In unserer Definition hat jedoch jede einzelne Formel $\varphi_{n}$
eine endliche Länge.)

Leider sind diese Formeln noch zu lang: Wenn das Symbol $R$ mehr
als einmal in $\psi$ vorkommt, ist $\left\Vert \psi_{i+1}\right\Vert \geqslant2\left\Vert \psi_{i}\right\Vert $,
und daher wächst die Formellänge mit $\left\Vert \varphi\right\Vert \geqslant2^{n^{k}}$
exponentiell für $k=\mathrm{ar}\left(R\right)$. Mit $\mathcal{C}_{n}^{\varphi}=\mathcal{C}_{n}^{\varphi_{n}}$
könnten wir nicht die gewünschte $\mathrm{poly}\left(n\right)$-Größe
ableiten.

Die booleschen Schaltkreise haben jedoch nicht dieselbe Einschränkung
wie $\mathrm{FO}\left[\sigma\right]$: Die Berechnung einer Teilformel
$\psi_{i}\left(\bar{z}\right)$ kann mehrfach verwendet werden, ohne
den Schaltkreis $\mathcal{C}_{n}^{\psi_{i}}$ zu vervielfältigen.
\begin{lem}
\label{lem:lfp-circ}Sei $\mathcal{L}$ eine Logik, $\sigma$ eine
relationale Signatur und $\mathbb{B}$ eine boolesche Basis, so dass
jede $\mathcal{L}\left[\sigma\right]$-Formel $\varphi$ eine Anfrage
beschreibt, die auch durch eine $\mathcal{K}$-uniforme (mit $P\subseteq\mathcal{K}$),
symmetrische $\left(\sigma,\mathbb{B}\right)$-Schaltkreisfamilie
mit konstanter $t$-Tiefe und polynomiell beschränkter $s\left(n\right)$-Größe
beschreibbar ist.

Dann existiert eine $\mathcal{K}$-uniforme symmetrische $\left(\sigma,\mathbb{B}\right)$-Schaltkreisfamilie
$\bar{\mathcal{C}^{\varphi}}$ mit $m+n^{k}\left(t+1\right)$-Tiefe
und $1+n^{k}\left(s\left(n\right)+m\right)$-Größe, so dass $q_{\bar{\mathcal{C}^{\varphi}}}\left(\mathfrak{A}\right)=q_{\varphi}\left(\mathfrak{A}\right)$
für alle $\mathfrak{A}\in\mathbf{FIN}\left(\sigma\right)$ gilt.
\end{lem}
In Kombination mit dem Rest dieses Kapitels folgt dann:
\begin{eqnarray*}
\mathrm{LFP}+\mathbf{ORD} & \subseteq & \mathrm{SBC}^{P}\\
\mathrm{LFP}+\mathbf{ARB} & \subseteq & \mathrm{SBC}^{P/\mathrm{poly}}
\end{eqnarray*}
\begin{eqnarray*}
\mathrm{LFP}+C & \subseteq & \left(\mathrm{SBC}+\mathbf{MAJ}\right)^{P}\\
\mathrm{LFP}+\mathbf{ARB}+C & \subseteq & \left(\mathrm{SBC}+\mathbf{MAJ}\right)^{P/\mathrm{poly}}
\end{eqnarray*}

\begin{proof}
Per Definition existiert bereits eine $\left(\sigma,\mathbb{B}\right)$-Schaltkreisfamilie
für jede $\mathcal{L}\left[\sigma\right]$-Formel.

Sei nun $\varphi=\left(Q_{i}z_{i}\right)_{i\in\left[1,m\right]}\varphi'$
und $\varphi'=\left[\mathrm{lfp}_{X,\bar{x}}\psi\right]\left(\bar{y}\right)$
für eine Relationsvariable $X/k\in\mathbf{var}_{2}$, eine $k$-stellige
parameterfreie $\mathcal{L}\left[\sigma\uplus\left\{ X\right\} \right]$-Formel
$\psi\left(\bar{x}\right)$ und ein Tupel von $\mathrm{LFP}\left(\mathcal{L}\right)\left[\sigma\right]$-Termen
$\bar{y}\in\mathbf{var}^{k}$.

Per Voraussetzung existiert eine $\mathcal{K}$-uniforme, $k$-stellige,
symmetrische $\left(\sigma\cup\left\{ X\right\} \right)$-Schaltkreisfamilie
$\left(\mathcal{C}_{n}^{\psi}\right)_{n\in\mathbb{N}}$, die auf einer
$\left(\sigma\cup\left\{ X\right\} \right)$-Struktur $\mathfrak{A}'\coloneqq\mathfrak{A}\cup\left(A,\left(X\mapsto Y\right)\right)$
die Anfrage $q_{\mathcal{C}_{n}^{\psi}}\left(\mathfrak{A}'\right)=q_{\psi^{\left(X\mapsto Y\right)}}\left(\mathfrak{A}\right)$
berechnet. (Hier wird die Relationsvariable $X$ als neues Symbol
in die Signatur mit aufgenommen.)
\[
\mathcal{C}_{n}^{\psi}=\left(G_{\psi},W_{\psi},\Sigma_{\psi},\Omega_{\psi},U\right)
\]
Wir werden für jede Eingabegröße $n\in\mathbb{N}$ einen neuen Schaltkreis
für $\mathcal{C}_{n}^{\varphi'}$ bauen, der den Schaltkreis $\mathcal{C}_{n}^{\psi}$
genau $n^{k}$-mal iteriert.
\begin{description}
\item [{Schaltkreis:}] Es wird eine Sequenz $\left(\mathcal{D}^{i}\right)_{i\in\mathbb{N}}$
von $k$-stelligen $\left(\sigma,\mathbb{B}\right)$-Schaltkreisen
definiert.
\[
\mathcal{D}^{i}\coloneqq\left(G_{i},W_{i},\Sigma_{i},\Omega_{i},U\right)
\]
 Für $i=0$ nehmen wir nur eine $\mathbf{0}$-Konstante:
\begin{eqnarray*}
\mathcal{D}^{0} & \coloneqq & \left(\left\{ g_{0}\right\} ,\emptyset,\Sigma_{0},\Omega_{0},U\right)\\
\Sigma_{0}\left(g_{0}\right)=\mathbf{0} &  & \Omega\left(\bar{t}\right)=g_{0}
\end{eqnarray*}
Für $i\in\mathbb{N}_{\geqslant1}$ fügen wir eine neue Kopie von $\mathcal{C}_{n}^{\psi}$
in $\mathcal{D}^{i}$ ein:
\begin{eqnarray*}
G_{i+1} & \coloneqq & G_{i}\uplus G_{\psi}\\
W_{i+1} & \coloneqq & W_{i}\uplus W_{\psi}\uplus W'
\end{eqnarray*}
$\mathcal{D}^{i}$ verbindet alle mit $X\bar{u}$ markierten Inputs
mit dem Output $\Omega_{i}\left(\bar{u}\right)$, und markiert sie
mit ,,$\mathtt{AND}$``. (Hier wäre ,,$\mathtt{OR}$`` äquivalent,
da jedes dieser Gates nur einen Vorgänger bekommt.) 
\[
\Sigma_{i+1}\left(g\right)\coloneqq\begin{cases}
\Sigma_{i}\left(g\right) & \mathrm{falls}\,\,g\in G_{i}\\
\mathtt{AND} & \mathrm{falls}\,\,g\in G_{\psi},\,\Sigma_{\psi}\left(g\right)=X\bar{u}\\
\Sigma_{\psi}\left(g\right) & \mathrm{sonst}
\end{cases}
\]
\[
W'\coloneqq\left\{ \left(\Omega_{i}\left(\bar{u}\right),g\right)\mid g\in G_{\psi},\,\Sigma_{\psi}\left(g\right)=X\bar{u}\right\} 
\]
Die Outputs von $\mathcal{C}_{n}^{\psi}$ werden zu den Outputs von
$\mathcal{D}^{i+1}$: 
\[
\Omega_{i+1}=\Omega_{\psi}
\]
Schließlich sei $\mathcal{C}_{n}^{\varphi}\coloneqq\mathcal{D}^{n^{k}}$.
\item [{Korrektheit:}] Es wird induktiv bewiesen, dass $\mathcal{D}^{i}$
auf $\mathfrak{A}\in\mathbf{FIN}\left(\sigma\right)$ die $\sigma$-Anfrage
$q_{\mathcal{D}^{i}}\left(\mathfrak{A}\right)=F^{i}\left(\emptyset\right)$
berechnet.
\[
q_{\mathcal{D}^{0}}\left(\mathfrak{A}\right)=F^{0}\left(\emptyset\right)=\emptyset
\]
\begin{eqnarray*}
q_{\mathcal{D}^{i+1}}\left(\mathfrak{A}\right) & = & q_{\mathcal{C}_{n}^{\psi}}\left(\mathfrak{A}\cup\left(A,\left(X\mapsto q_{\mathcal{D}^{i}}\left(\mathfrak{A}\right)\right)\right)\right)\\
 & \overset{\mathrm{Ann.}}{=} & q_{\mathcal{C}_{n}^{\psi}}\left(\mathfrak{A}\cup\left(A,\left(X\mapsto F^{i}\left(\emptyset\right)\right)\right)\right)\\
 & = & q_{\psi^{\left(X\mapsto F^{i}\left(\emptyset\right)\right)}}\left(\mathfrak{A}\right)\\
 & \overset{\mathrm{Def.\ref{def:lfp}}}{=} & F^{i+1}\left(\emptyset\right)
\end{eqnarray*}
Daher berechnet $\mathcal{C}_{n}^{\varphi}=\mathcal{D}^{n^{k}}$ die
Anfrage $q_{\mathcal{C}_{n}^{\varphi}}\left(\mathfrak{A}\right)=F^{n^{k}}\left(\emptyset\right)=F^{\infty}\left(\emptyset\right)$.
\item [{Symmetrie:}] Sei $\pi\in\mathrm{Sym}_{U}$ beliebig. Per Annahme
ist $\mathcal{C}_{n}^{\psi}$ symmetrisch, also existiert der Automorphismus
$\hat{\pi}$.


Sei $\hat{\pi}_{0}\coloneqq\mathbf{id}_{\left\{ g_{0}\right\} }$.
Per Annahme existiere für $i\in\mathbb{N}$ ein von $\pi$ induzierter
Automorphismus $\hat{\pi}_{i}$ in $\mathcal{D}^{i}$. Sei dann $\hat{\pi}_{i+1}$
die folgende Abbildung in $\mathcal{D}^{i+1}$:
\begin{eqnarray*}
\\
\hat{\pi}_{i+1}\left(g\right) & \coloneqq & \begin{cases}
\hat{\pi}_{i}\left(g\right) & \mathrm{falls}\,g\in G_{i}\\
\hat{\pi}\left(g\right) & \mathrm{sonst}
\end{cases}
\end{eqnarray*}

\begin{enumerate}
\item Es gilt $\left(\hat{\pi}_{i+1}\right)_{\mid G_{i}}=\hat{\pi}_{i}$,
und $\left(\hat{\pi}_{i+1}\right)_{\mid G_{\psi}}=\hat{\pi}$; damit
sind die Bedingungen für $W_{i}\cup W_{\psi}$, $\Sigma_{i}$, $\Omega_{i+1}=\Omega_{\psi}$
und alle internen Gates $g\in G_{\psi}$ mit $\Sigma_{\psi}\notin\left\{ X\bar{u}\mid\bar{u}\in U^{m}\right\} $
bereits erfüllt.
\item Für die ehemaligen Inputs mit $\Sigma\left(g\right)=X\bar{u}$ gilt
$\Sigma_{i+1}\left(\hat{\pi}g\right)=\Sigma_{i+1}\left(g\right)=\mathtt{AND}$.
\item Für jede neue Kante $\left(\Omega_{i}\left(\bar{u}\right),g\right)\in W'$
mit $g\in G_{\psi}$ und $\Sigma_{\psi}\left(g\right)=X\bar{u}$:
\begin{eqnarray*}
\left(\hat{\pi}_{i+1}\Omega_{i}\left(\bar{u}\right),\hat{\pi}_{i+1}g\right) & = & \left(\hat{\pi}_{i}\Omega_{i}\left(\bar{u}\right),\hat{\pi}g\right)\\
 & = & \left(\Omega_{i}\left(\pi\bar{u}\right),\hat{\pi}g\right)
\end{eqnarray*}
Per Definition ist $\Sigma_{\psi}\left(\hat{\pi}g\right)=X\pi\bar{u}$,
und daher:
\[
\left(\Omega_{i}\left(\pi\bar{u}\right),\hat{\pi}g\right)\in W'
\]

\end{enumerate}

Daher ist $\mathcal{D}^{i+1}$ ebenfalls symmetrisch, und es folgt
die Symmetrie von $\mathcal{C}_{n}^{\varphi}=\mathcal{D}^{n^{k}}$.

\item [{Größe:}] Es wird induktiv bewiesen, dass $T\left(\mathcal{D}^{i}\right)\leqslant i\left(t+1\right)$,
und $\left|\mathcal{D}^{i}\right|\leqslant1+i\cdot s\left(n\right)$
\begin{eqnarray*}
T\left(\mathcal{D}^{0}\right) & = & 0\\
T\left(\mathcal{D}^{i+1}\right) & = & T\left(\mathcal{D}^{i}\right)+T\left(\mathcal{C}_{n}^{\psi}\right)+1\\
 & \leqslant & T\left(\mathcal{D}^{i}\right)+t+1\\
 & \overset{\mathrm{Ann.}}{\leqslant} & i\left(t+1\right)+t+1=\left(i+1\right)\left(t+1\right)
\end{eqnarray*}
\begin{eqnarray*}
\left|\mathcal{D}^{0}\right| & = & 1\\
\left|\mathcal{D}^{i+1}\right| & = & \left|\mathcal{D}^{i}\right|+\left|\mathcal{C}_{n}^{\psi}\right|\\
 & \leqslant & \left|\mathcal{D}^{i}\right|+s\left(n\right)\\
 & \overset{\mathrm{Ann.}}{\leqslant} & 1+i\cdot s\left(n\right)+s\left(n\right)=1+\left(i+1\right)s\left(n\right)
\end{eqnarray*}
Damit gilt $T\left(\mathcal{C}_{n}^{\varphi'}\right)=T\left(\mathcal{D}^{n^{k}}\right)\leqslant n^{k}\left(t+1\right)$
und $\left|\mathcal{C}_{n}^{\varphi'}\right|=\left|\mathcal{D}^{n^{k}}\right|=1+n^{k}s\left(n\right)$.
\end{description}
Um jetzt noch aus $\mathcal{C}_{n}^{\varphi'}$ den Schaltkreis $\mathcal{C}_{n}^{\varphi}$
zu erzeugen, muss nur für jeden Quantor $Q_{i}z_{i}$ Fall \ref{case:fo-ex}
oder \ref{case:fo-forall} aus dem Beweis von Lemma \ref{lem:fo-circuit}
angewendet werden. Dieser erzeugt in jedem Schritt höchstens $n^{k}$
neue Gates und vergrößert die Tiefe um $1$, so dass wir die Tiefe
$n^{k}\left(t+1\right)+m$ und Größe $n^{k}\left(s\left(n\right)+m\right)+1$
erhalten.
\end{proof}

\chapter{Partitionen und Träger}

Unsere Konstruktion der logischen Formel aus einer Schaltkreisfamilie
wird voraussetzen, dass jedes Gate $g$ unter allen Bijektionen $\pi:A\rightleftarrows U$
ausgewertet wird. Wir stehen zunächst vor dem Problem, dass es $\left|\mathrm{Bij}\left(A,U\right)\right|=n!\in\Omega\left(2^{n}\right)$
solche Bijektionen gibt. Um sie für jedes Gate auf eine $\mathrm{poly}\left(n\right)$-beschränkte
Zahl zu reduzieren, möchten wir gerne nachweisen, dass die $n!$ Bijektionen
bezüglich jedem Gate in $\frac{n!}{\left(n-k\right)!}$ verschiedene
Äquivalenzklassen der Größe $\left(n-k\right)!$ (mit $k\in\mathcal{O}\left(1\right)$)
fallen (und einen effizienten Algorithmus finden, der die Repräsentanten
dieser Äquivalenzklassen erzeugt).

In dem Ergebnis von Martin Otto in 1997\cite{Otto1997} setzt er eine
lokale polynomielle Beschränkung der Orbits jedes Gates voraus, und
leitet für diese Schaltkreisfamilien eine Charakterisierung durch
das variablen-beschränkte Fragment der infinitären Logik ($L_{\infty\omega}^{\omega}$)
her.

Das Ergebnis von Anderson und Dawar 2014\cite{AD2014} betrachtet
symmetrische Schaltkreisfamilien mit polynomieller Größe (und daher
automatisch polynomiell beschränkten Orbits). Hier wird für jedes
Gate nachgewiesen, dass sein Wert nur von $\mathcal{O}\left(1\right)$
vielen Elementen des Universums $U$ abhängt, und daraus eine Charakterisierung
durch die Fixpunktlogik abgeleitet.

Hierfür werden zunächst die Begriffe der Partition, des Stabilisators
und des Trägers eingeführt.


\section{Partitionen einer Menge}

Sei $U$ ein beliebiges Universum. Wir führen die \textbf{Partition
}als Zerlegung von $U$ in disjunkte Teilmengen ein.
\begin{defn}
Sei $\mathcal{P}\coloneqq\left\{ P_{1},\cdots,P_{k}\right\} $ eine
Menge von disjunkten nicht-leeren Mengen. Wir nennen $\mathcal{P}$
eine Partition von $U$, wenn $\biguplus_{i=1}^{k}P_{i}=U$. Sei $\mathrm{Part}_{U}$
die Menge aller Partitionen von $U$. Sei $\sim_{\mathcal{P}}$ eine
Äquivalenzrelation auf $U$, deren Äquivalenzklassen von $\mathcal{P}$
repräsentiert werden.
\end{defn}
Die Permutationen $\mathrm{Sym}_{U}$ werden auf natürliche Weise
auf $\mathcal{P}\in\mathrm{Part}_{U}$ erweitert:
\begin{eqnarray*}
\pi\mathcal{P} & \coloneqq & \left\{ \pi P_{i}\mid P_{i}\in\mathcal{P}\right\} \in\mathrm{Part}_{U}
\end{eqnarray*}
Als nächstes wird die \textbf{Feinheit} als Relation auf $\mathrm{Part}_{U}$
eingeführt.
\begin{defn}
\label{def:feinheit}Sei $\mathcal{P}\preceq\mathcal{P}'$ (,,$\mathcal{P}$
ist mindestens so fein wie $\mathcal{P}'$``) genau dann wenn jedes
$P_{i}\in\mathcal{P}$ eine Teilmenge eines $P'_{j}\in\mathcal{P}'$
ist.

Dies ist äquivalent zu der Teilmengenbeziehung von $\sim_{\mathcal{P}}$
und $\sim_{\mathcal{P}'}$: 
\begin{eqnarray*}
\mathcal{P}\preceq\mathcal{P}' & \Leftrightarrow & \mathrm{f.a.}\,P\in\mathcal{P}\,\mathrm{ex.\,}P'\in\mathcal{P}'\,\mathrm{s.d.}\,P\subseteq P'\\
 & \Leftrightarrow & \mathrm{f.a.}\,u,u'\in U\,\mathrm{gilt}\,u\sim_{\mathcal{P}}u'\,\Rightarrow u\sim_{\mathcal{P}'}u'\\
 & \Leftrightarrow & \left(\sim_{\mathcal{P}}\right)\subseteq\left(\sim_{\mathcal{P}'}\right)
\end{eqnarray*}


Genau wie die Teilmengenbeziehung der Äquivalenzrelation bildet $\preceq$
eine Halbordnung auf $\mathrm{Part}_{U}$.

Daher bildet $\mathrm{Part}_{U}$ einen vollständigen Verband (siehe
\cite{Klein-Barmen1935}) mit den folgenden Infimum- und Supremum-Operationen
$\sqcap$ und $\sqcup$:
\begin{eqnarray*}
\mathcal{A}\sqcap\mathcal{B} & \coloneqq & \max_{\preceq}\left\{ \mathcal{P}\in\mathrm{Part}_{U}\mid\mathcal{P}\preceq\mathcal{A}\,\mathrm{und}\,\mathcal{P}\preceq\mathcal{B}\right\} \\
\mathcal{A}\sqcup\mathcal{B} & \coloneqq & \min_{\preceq}\left\{ \mathcal{P}\in\mathrm{Part}_{U}\mid\mathcal{A}\preceq\mathcal{P}\,\mathrm{und}\,\mathcal{B}\preceq\mathcal{P}\right\} 
\end{eqnarray*}


($\mathcal{A}\sqcap\mathcal{B}$ sei die gröbste feinere Partition
als $\mathcal{A}$ und $\mathcal{B}$, und $\mathcal{A}\sqcup\mathcal{B}$
die feinste gröbere Partition als $\mathcal{A}$ und $\mathcal{B}$.)\end{defn}
\begin{prop}
\label{prop:part-eq}Wenn $\left[x\right]_{\sim}$ die Äquivalenzklasse
$\left\{ y\mid x\sim y\right\} $ ist, und $\mathcal{P}_{1},\mathcal{P}_{2}\in\mathrm{Part}_{U}$
wie folgt sind, 
\begin{eqnarray*}
\mathcal{P}_{1} & \coloneqq & \left\{ \left[x\right]_{\sim_{\mathcal{A}}\cap\sim_{\mathcal{B}}}\mid x\in U\right\} \\
\mathcal{P}_{2} & \coloneqq & \left\{ \left[x\right]_{\sim^{*}}\mid x\in U\right\} \\
 &  & \mathrm{wobei}\,\sim\coloneqq\left(\sim_{\mathcal{A}}\right)\cup\left(\sim_{\mathcal{B}}\right)
\end{eqnarray*}
dann ist $\mathcal{P}_{1}=\mathcal{A}\sqcap\mathcal{B}$ und $\mathcal{P}_{2}=\mathcal{A}\sqcup\mathcal{B}$.\end{prop}
\begin{proof}
Die Eigenschaft $\mathcal{P}_{1}\preceq\mathcal{A},\mathcal{B}\preceq\mathcal{P}_{2}$
folgt offensichtlich aus $\left(\sim_{\mathcal{A}}\cap\sim_{\mathcal{B}}\right)\subseteq\sim_{\mathcal{A}},\sim_{\mathcal{B}}\subseteq\left(\sim_{\mathcal{A}}\cup\sim_{\mathcal{B}}\right)^{*}$.
Ferner muss jede Relation $\sim_{\mathcal{P}}$ mit $\left(\sim_{\mathcal{P}}\right)\subseteq\left(\sim_{\mathcal{A}}\right)$
und $\left(\sim_{\mathcal{A}}\right)\subseteq\left(\sim_{\mathcal{B}}\right)$
auch in $\left(\sim_{\mathcal{A}}\right)\cap\left(\sim_{\mathcal{B}}\right)$
enthalten sein, und jede mit $\left(\sim_{\mathcal{P}}\right)\supseteq\left(\sim_{\mathcal{A}}\right)$,
$\left(\sim_{\mathcal{P}}\right)\supseteq\left(\sim_{\mathcal{B}}\right)$
muss auch $\left(\sim_{\mathcal{A}}\right)\cup\left(\sim_{\mathcal{B}}\right)$
(und dessen Abschluss) enthalten.\end{proof}
\begin{defn}
Die feinste und gröbste Partition von $U$ seien $\mathcal{P}_{\min}\left(U\right)\coloneqq\left\{ \left\{ u_{1}\right\} ,\cdots,\left\{ u_{n}\right\} \right\} $
und $\mathcal{P}_{\max}\left(U\right)\coloneqq\left\{ U\right\} $.
\end{defn}

\section{Stabilisatoren einer Partition}

Wir führen die Stabilisatoren von Elementen, Teilmengen und Partitionen
eines Universums $U$ ein.
\begin{defn}
Der Stabilisator eines Elements $u\in U$ in $U$ sei die Untergruppe
$\mathrm{Stab}_{U}\left(u\right)\subseteq\mathrm{Sym}_{U}$ aller
Permutationen, die $u$ fixieren: 
\[
\mathrm{Stab}_{U}\left(u\right)\coloneqq\left\{ \pi\in\mathrm{Sym}_{U}\mid\pi u=u\right\} 
\]


Der Punktstabilisator\textbf{ }einer Teilmenge $X\subseteq U$ in
$U$ sei die Untergruppe $\mathrm{Stab}_{U}\left(X\right)\subseteq\mathrm{Sym}_{U}$
der Permutationen, die jedes Element $x\in X$ fixieren:
\begin{eqnarray*}
\mathrm{Stab}_{U}\left(X\right) & \coloneqq & \left\{ \pi\in\mathrm{Sym}_{U}\mid\pi x=x\,\,\mathrm{f.a.}\,\,x\in X\right\} \\
 & = & \bigcap_{x\in X}\mathrm{Stab}_{U}\left(x\right)
\end{eqnarray*}


Der Mengenstabilisator von $X$ in $U$ sei die Untergruppe $\mathrm{Stab}_{U}\left\{ X\right\} \subseteq\mathrm{Sym}_{U}$
der Permutationen, die die Menge $X$ als ganzes fixieren.
\begin{eqnarray*}
\mathrm{Stab}_{U}\left\{ X\right\}  & \coloneqq & \left\{ \pi\in\mathrm{Sym}_{U}\mid\pi X=X\right\} \\
 & = & \bigcup_{\pi\in\mathrm{Sym}_{X}}\left(\pi\cup\mathbf{id}_{U\backslash X}\right)\left(\mathrm{Stab}_{U}\left(X\right)\right)
\end{eqnarray*}

\end{defn}

\begin{defn}
Die obige Definition wird auf Partitionen $\mathcal{P}\in\mathrm{Part}_{U}$
erweitert:

Der Punktstabilisator\textbf{ }von $\mathcal{P}$ in $U$ sei die
Untergruppe $\mathrm{Stab}_{U}\left(\mathcal{P}\right)\subseteq\mathrm{Sym}_{U}$
aller Permutationen, die jede Menge $P_{i}\in\mathcal{P}$ fixieren:
\begin{eqnarray*}
\mathrm{Stab}_{U}\left(\mathcal{P}\right) & \coloneqq & \left\{ \pi\in\mathrm{Sym}_{U}\mid\pi P_{i}=P_{i}\,\mathrm{f\ddot{u}r}\,\mathrm{alle}\,P_{i}\in\mathcal{P}\right\} \\
 & = & \bigcap_{P_{i}\in\mathcal{P}}\mathrm{Stab}_{U}\left\{ P_{i}\right\} 
\end{eqnarray*}


Der Mengenstabilisator von $\mathcal{P}$ in $U$ sei die Untergruppe
$\mathrm{Stab}_{U}\left\{ \mathcal{P}\right\} \subseteq\mathrm{Sym}_{U}$
aller Permutationen, die die Partition als ganzes fixieren: 
\begin{eqnarray*}
\mathrm{Stab}_{U}\left\{ \mathcal{P}\right\}  & \coloneqq & \left\{ \pi\in\mathrm{Sym}_{U}\mid\pi\mathcal{P}=\mathcal{P}\right\} 
\end{eqnarray*}
Diese Gruppe wird durch $\mathrm{Stab}_{U}\left(\mathcal{P}\right)$
und alle Permutationen von gleich-mächtigen Elementen von $\mathcal{P}$
erzeugt: Sei $\mathcal{P}_{\mid i}\coloneqq\left\{ P_{j}\in\mathcal{P}\mid\left|P_{j}\right|=i\right\} $
für $i\in\left[1,\left|U\right|\right]$, dann gilt: 
\[
\mathrm{Stab}_{U}\left\{ \mathcal{P}\right\} =\bigcup_{\begin{subarray}{c}
i\in\left[1,\left|U\right|\right]\\
\pi\in\mathrm{Sym}_{\mathcal{P}_{\mid i}}
\end{subarray}}\pi\mathrm{Stab}_{U}\left(\mathcal{P}\right)
\]


Die Feinheit von Partitionen ist äquivalent zu der Teilmengenbeziehung
ihrer Stabilisatoren.\end{defn}
\begin{prop}
\label{prop:feinheit-stab}Für zwei Partitionen $\mathcal{P},\mathcal{P}'\in\mathrm{Part}_{U}$
gilt $\mathcal{P}\preceq\mathcal{P}'$ genau dann wenn $\mathrm{Stab}_{U}\left(\mathcal{P}\right)\subseteq\mathrm{Stab}_{U}\left(\mathcal{P}'\right)$.\end{prop}
\begin{proof}
Sei $\pi\in\mathrm{Stab}_{U}\left(\mathcal{P}\right)$ beliebig, so
besteht $\pi$ aus einer Folge von Transpositionen:
\[
\pi=\left(u_{1}v_{1}\right)\circ\cdots\circ\left(u_{k}v_{k}\right)
\]


Jede Transposition $\left(u_{i}v_{i}\right)$ vertauscht Elemente
einer Menge $P_{i}\in\mathcal{P}$; daher gilt $u_{i}\sim_{\mathcal{P}}v_{i}$.
Per Definition \ref{def:feinheit} gilt $\left(\sim_{\mathcal{P}}\right)\subseteq\left(\sim_{\mathcal{P}'}\right)$,
und daher $u_{i}\sim_{\mathcal{P}'}v_{i}$ und $\left(u_{i}v_{i}\right)\in\mathrm{Stab}_{U}\left(\mathcal{P}'\right)$
für alle $i\in\left[1,k\right]$. Aus der Abgeschlossenheit des Stabilisators
folgt $\pi\in\mathrm{Stab}_{U}\left(\mathcal{P}'\right)$.

Umgekehrt impliziert auch $\mathrm{Stab}_{U}\left(\mathcal{P}\right)\subseteq\mathrm{Stab}_{U}\left(\mathcal{P}'\right)$,
dass für jedes Paar $u\sim_{\mathcal{P}}v$ die Transposition $\left(uv\right)\in\mathrm{Stab}_{U}\left(\mathcal{P}\right)$
auch in $\mathrm{Stab}_{U}\left(\mathcal{P}'\right)$ enthalten ist,
und daher $u\sim_{\mathcal{P}'}v$ gilt. Aus $\left(\sim_{\mathcal{P}}\right)\subseteq\left(\sim_{\mathcal{P}'}\right)$
folgt $\mathcal{P}\preceq\mathcal{P}'$.
\end{proof}

\section{Träger}


\subsection{Trägerpartitionen einer Permutationsgruppe}
\begin{defn}
\label{def:traeger}Sei $G\subseteq\mathrm{\mathrm{Sym}}_{U}$ eine
Untergruppe und $\mathcal{P}$ eine Partition von $U$. $\mathcal{P}$
sei eine \textbf{Trägerpartition} von\textbf{ }$G$ genau dann wenn
$\mathrm{Stab}_{U}\left(\mathcal{P}\right)\subseteq G$.
\end{defn}
Wenn die Partition $\mathcal{P}$ eine Trägerpartition von $G$ ist,
dann ist sie es auch von jeder Obermenge $G'\supseteq G$. Außerdem
sind per Satz \ref{prop:feinheit-stab} alle feineren $\mathcal{P}'\preceq\mathcal{P}$
Trägerpartitionen von $G$. Somit ist $\mathcal{P}_{\min}=\left\{ \left\{ u_{1}\right\} ,\cdots,\left\{ u_{n}\right\} \right\} $
mit $\mathrm{Stab}_{U}\left(\mathcal{P}_{\min}\right)=\left\{ \mathbf{id}\right\} $
eine triviale Trägerpartition jeder Untergruppe $G\subseteq\mathrm{Sym}_{U}$,
und alle $\mathcal{P}\in\mathrm{Part}_{U}$ sind Trägerpartitionen
der Gruppe $\mathrm{Sym}_{U}=\mathrm{Stab}_{U}\left(\mathcal{P}_{\max}\right)$.
\begin{prop}
\label{prop:traeger-abschluss}Wenn $\mathcal{A}$ und $\mathcal{B}$
Trägerpartitionen von $G$ sind, so sind es auch $\mathcal{A}\sqcap\mathcal{B}$
und $\mathcal{A}\sqcup\mathcal{B}$.\end{prop}
\begin{proof}
Per Definition ist $\mathcal{A}\sqcap\mathcal{B}\preceq\mathcal{A}$
und $\mathcal{A}\sqcap\mathcal{B}\preceq\mathcal{B}$, und daher folgt
die Tatsache direkt aus Satz \ref{prop:feinheit-stab}.

Für $\mathcal{P}\coloneqq\mathcal{A}\sqcup\mathcal{B}$ gilt:
\begin{enumerate}
\item Jede Permutation $\pi\in\mathrm{Stab}_{U}\left(\mathcal{P}\right)$
ist eine Folge von Transpositionen $\pi=\left(u_{1}v_{1}\right)\circ\cdots\circ\left(u_{k}v_{k}\right)$,
so dass wir nur Transpositionen betrachten müssen.
\item Die Äquivalenzrelation $\sim_{\mathcal{P}}$ ist per Satz \ref{prop:part-eq}
die transitive Hülle von $\sim\coloneqq\left(\sim_{\mathcal{A}}\cup\sim_{\mathcal{B}}\right)$.
Daher existiert für alle $u\sim_{\mathcal{P}}v$ eine Folge von $\ell\leqslant\left|U\right|$
Elementen $\bar{w}\in U^{\ell}$ mit
\[
u\sim w_{1}\sim\cdots\sim w_{\ell}\sim v
\]

\end{enumerate}
Sei nun $\left(uv\right)\in\mathrm{Stab}_{U}\left(\mathcal{P}\right)$
eine beliebige Transposition. $\left(uv\right)$ lässt sich mit dem
entsprechenden $\bar{w}\in\left(U\backslash\left\{ u,v\right\} \right)^{*}$
in die folgenden Transpositionen zerlegen:
\begin{eqnarray*}
\left(uv\right) & = & \left(\begin{array}{c}
u\\
v
\end{array}\left(\begin{array}{c}
w_{i}\\
w_{i}
\end{array}\right)_{1\leqslant i\leqslant\ell}\begin{array}{c}
v\\
u
\end{array}\right)\\
 & = & \left(\begin{array}{c}
w_{1}\\
v
\end{array}\left(\begin{array}{c}
w_{i}\\
w_{i-1}
\end{array}\right)_{1<i\leqslant\ell}\begin{array}{c}
v\\
w_{\ell}
\end{array}\right)\circ\left(\begin{array}{c}
u\\
w_{1}
\end{array}\left(\begin{array}{c}
w_{i}\\
w_{i+1}
\end{array}\right)_{1\leqslant i<\ell}\begin{array}{cc}
w_{\ell} & v\\
v & u
\end{array}\right)\\
 &  & \left(vw_{\ell}\right)\left(w_{\ell}w_{\ell-1}\right)\cdots\left(w_{2}w_{1}\right)\circ\left(uw_{1}\right)\left(w_{1}w_{2}\right)\cdots\left(w_{\ell-1}w_{\ell}\right)\left(w_{\ell}v\right)
\end{eqnarray*}


Weil $\sim=\left(\sim_{\mathcal{A}}\cup\sim_{\mathcal{B}}\right)$,
ist jede der Transpositionen entweder in $\mathrm{Stab}_{U}\left(\mathcal{A}\right)$
oder in $\mathrm{Stab}_{U}\left(\mathcal{B}\right)$ enthalten, und
beide sind Teilmengen von $G$. Also ist $\left(uv\right)\in G$,
und es folgt $\mathrm{Stab}_{U}\left(\mathcal{P}\right)\subseteq G$.\end{proof}
\begin{cor}
Jede Gruppe $G\subseteq\mathrm{Sym}_{U}$ besitzt eine eindeutige
gröbste Trägerpartition.\end{cor}
\begin{proof}
Angenommen, $\mathcal{P}$ und $\mathcal{P}'$ seien zwei gröbste
Trägerpartitionen von $G$. Nun ist $\mathcal{P}\sqcup\mathcal{P}'$
nach Lemma \ref{prop:traeger-abschluss} ebenfalls eine Trägerpartition
von $G$, und es gilt $\mathcal{P},\mathcal{P}'\preceq\mathcal{P}\sqcup\mathcal{P}'$.

Da aber per Definition $\mathcal{P}$ und $\mathcal{P}'$ aber per
Definition gröbste Träger von $G$ sind, muss $\mathcal{P}=\mathcal{P}\sqcup\mathcal{P}'=\mathcal{P}'$
gelten.\end{proof}
\begin{defn}
Für jede Gruppe $G\subseteq\mathrm{Sym}_{U}$ sei $\mathrm{SP}\left(G\right)$
der gröbste Träger von $G$.
\end{defn}
Wir betrachten nun die Konjugations-Operation $\pi G\pi^{-1}$ einer
Permutation $\pi$ auf einer Untergruppe $G\subseteq\mathrm{Sym}_{U}$,
und weisen nach, dass $\pi\mathrm{SP}\left(G\right)=\mathrm{SP}\left(\pi G\pi^{-1}\right)$.
\begin{prop}
\label{prop:konjugation}Wenn eine Partition $\mathcal{P}$ ein Träger
einer Gruppe $G\subseteq\mathrm{Sym}_{U}$ ist, dann ist $\pi\mathcal{P}$
ein Träger von $\pi G\pi^{-1}$ für alle $\pi\in\mathrm{Sym}_{U}$.\end{prop}
\begin{proof}
Seien $\rho\in\mathrm{Stab}_{U}\left(\pi\mathcal{P}\right)$ und $P_{i}\in\mathcal{P}$
beliebig. $\pi^{-1}\rho\pi$ fixiert $P_{i}$:
\begin{eqnarray*}
\left(\pi^{-1}\rho\pi\right)P_{i} & = & \pi^{-1}\left(\rho\left(\pi P_{i}\right)\right)\\
 & = & \pi^{-1}\pi P_{i}\\
 & = & P_{i}
\end{eqnarray*}


Daraus folgt $\left(\pi^{-1}\rho\pi\right)\in\mathrm{Stab}_{U}\left(\mathcal{P}\right)\subseteq G$,
und schließlich gilt:
\begin{eqnarray*}
\rho & = & \left(\pi\pi^{-1}\right)\rho\left(\pi\pi^{-1}\right)\\
 & = & \pi\left(\pi^{-1}\rho\pi\right)\pi^{-1}\\
 & \in & \pi G\pi^{-1}
\end{eqnarray*}


Damit $\pi\mathcal{P}$ ein Träger der konjugierten Gruppe $\pi G\pi^{-1}$.\end{proof}
\begin{cor}
\label{cor:sp-konjugation}Für jede Gruppe $G\subseteq\mathrm{Sym}_{U}$
und jede Permutation $\pi\in\mathrm{Sym}_{U}$ ist $\pi\mathrm{SP}\left(G\right)=\mathrm{SP}\left(\pi G\pi^{-1}\right)$.\end{cor}
\begin{proof}
Nach Lemma \ref{prop:konjugation} ist $\pi\mathrm{SP}\left(G\right)$
eine Trägerpartition von $\pi G\pi^{-1}$, und daher gilt $\pi\mathrm{SP}\left(G\right)\preceq\mathrm{SP}\left(\pi G\pi^{-1}\right)$.

Umgekehrt ist auch $\pi^{-1}\mathrm{SP}\left(\pi G\pi^{-1}\right)$
eine Trägerpartition von $\pi^{-1}\pi G\pi\pi^{-1}=G$. Es folgt $\pi^{-1}\mathrm{SP}\left(\pi G\pi^{-1}\right)\preceq\mathrm{SP}\left(G\right)$
und daher $\mathrm{SP}\left(\pi G\pi^{-1}\right)\preceq\pi\mathrm{SP}\left(G\right)$.\end{proof}
\begin{prop}
Jede Gruppe $G$ ist Obermenge des Punkt- und Teilmenge des Mengenstabilisators
von $\mathrm{SP}\left(G\right)$:
\[
\mathrm{Stab}_{U}\left(\mathrm{SP}\left(G\right)\right)\subseteq G\subseteq\mathrm{Stab}_{U}\left\{ \mathrm{SP}\left(G\right)\right\} 
\]
\end{prop}
\begin{proof}
Per Definition \ref{def:traeger} gilt bereits $\mathrm{Stab}_{U}\left(\mathrm{SP}\left(G\right)\right)\subseteq G$.

Sei nun $\pi\in G$ beliebig. Weil $\pi G\pi^{-1}=G$, folgt nach
Korollar \ref{cor:sp-konjugation}: 
\[
\pi\mathrm{SP}\left(G\right)=\mathrm{SP}\left(\pi G\pi^{-1}\right)=\mathrm{SP}\left(G\right)
\]


Weil $\pi$ die Partition $\mathrm{SP}\left(G\right)$ auf sich selbst
abbildet, gilt per Definition $\pi\in\mathrm{Stab}_{U}\left\{ \mathrm{SP}\left(G\right)\right\} $.
\end{proof}

\subsection{Trägermengen im Schaltkreis}

Wir erweitern die Begriffe ,,Stabilisator`` und ,,Träger`` auf
die Gates eines rigiden (Definition \ref{def:rigid}), symmetrischen
Schaltkreises. $\mathcal{C}=\left(G,W,\Sigma,\Omega,U\right)$.
\begin{defn}
Für jedes Gate $g\in G$ sei der Stabilisator von $g$ wie folgt definiert:
\[
\mathrm{Stab}_{\mathcal{C}}\left(g\right)\coloneqq\left\{ \pi\in\mathrm{Sym}_{U}\mid\hat{\pi}g=g\right\} 
\]


Eine Menge $X\subseteq U$ sei eine Trägermenge von $g$, wenn jede
Permutation, die die Elemente von $X$ fixiert, einen Automorphismus
in $\mathcal{C}$ induziert, der $g$ fixiert: 
\[
\mathrm{Stab}_{U}\left(X\right)\subseteq\mathrm{Stab}_{\mathcal{C}}\left(g\right)
\]

\end{defn}
Da für $X\subseteq X'$ offensichtlich $\mathrm{Stab}_{U}\left(X'\right)\subseteq\mathrm{Stab}_{U}\left(X\right)$
gilt (je mehr Elemente fixiert werden, um so weniger Permutationen
lassen wir zu), ist hier vor allem die kleinste Trägermenge des Gates
interessant.
\begin{prop}
Wenn $X,X'\subseteq U$ zwei Trägermengen von $g\in G$ sind, dann
ist $X\cap X'$ ebenfalls eine Trägermenge von $g$.\end{prop}
\begin{proof}
Sei $\mathcal{P}\coloneqq\left\{ \left\{ x\right\} \mid x\in X\right\} \cup\left\{ U\backslash X\right\} $
und $\mathcal{P}'\coloneqq\left\{ \left\{ x\right\} \mid x\in X'\right\} \cup\left\{ U\backslash X'\right\} $.
Offensichtlich gilt $\mathrm{Stab}_{U}\left(\mathcal{P}\right)=\mathrm{Stab}_{U}\left(X\right)\subseteq\mathrm{Stab}_{\mathcal{C}}\left(g\right)$
und $\mathrm{Stab}_{U}\left(\mathcal{P}'\right)=\mathrm{Stab}_{U}\left(X'\right)\subseteq\mathrm{Stab}_{\mathcal{C}}\left(g\right)$.

Daher sind $\mathcal{P}$ und $\mathcal{P}'$ beide Trägerpartitionen
von $\mathrm{Stab}_{\mathcal{C}}\left(g\right)$. Per Satz \ref{prop:traeger-abschluss}
ist auch $\mathcal{P}\sqcup\mathcal{P}'=\left\{ \left\{ x\right\} \mid x\in X\cap X'\right\} \cup\left\{ U\backslash\left(X\cap X'\right)\right\} $
eine Trägerpartition, und per $\mathrm{Stab}_{U}\left(\mathcal{P}\sqcup\mathcal{P}'\right)=\mathrm{Stab}_{U}\left(X\cap X'\right)$
ist auch $X\cap X'$ eine Trägermenge von $g$.\end{proof}
\begin{cor}
Jedes Gate $g\in G$ besitzt eine eindeutige kleinste Trägermenge.\end{cor}
\begin{prop}
Sei $\mathcal{P}\coloneqq\mathrm{SP}\left(\mathrm{Stab}_{\mathcal{C}}\left(g\right)\right)$
die gröbste Trägerpartition des Stabilisators eines Gates $g$, und
sei $P_{\max}=\max_{\left|\cdot\right|}\mathcal{P}$. Dann ist $X\coloneqq U\backslash P_{\max}$
die kleinste Trägermenge von $g$.\end{prop}
\begin{proof}
Sei $X'$ mit $\left|X'\right|<\left|X\right|$ eine kleinere Trägermenge
von $g$. Per Definition ist $\mathcal{P}'\coloneqq\left\{ \left\{ x\right\} \mid x\in X'\right\} \cup\left\{ U\backslash X'\right\} $
eine Trägerpartition von $\mathrm{Stab}_{\mathcal{C}}\left(g\right)$,
denn $\mathrm{Stab}_{U}\left(\mathcal{P}'\right)=\mathrm{Stab}_{U}\left(X'\right)\subseteq\mathrm{Stab}_{\mathcal{C}}\left(g\right)$.

Per Definition ist $U\backslash X=P_{\max}$ eine größte Menge in
$\mathrm{SP}\left(\mathrm{Stab}_{\mathcal{C}}\left(g\right)\right)$.
Per Annahme ist $\left|X'\right|<\left|X\right|$ und daher $\left|U\backslash X'\right|>\left|U\backslash X\right|$.
Weil aber $\mathcal{P}'\preceq\mathrm{SP}\left(\mathrm{Stab}_{\mathcal{C}}\left(g\right)\right)$
ist, muss $\mathrm{SP}\left(\mathrm{Stab}_{\mathcal{C}}\left(g\right)\right)$
eine Obermenge von $U\backslash X'$ als Element enthalten, und deren
Größe ist mindestens $\left|U\backslash X'\right|>\left|U\backslash X\right|$;
es entsteht ein Widerspruch.\end{proof}
\begin{defn}
Sei $\mathrm{sp}\left(g\right)$ die kleinste Trägermenge von $g$,
und sei $\mathrm{sp}\left(\mathcal{C}\right)=\max_{g\in G}\left|\mathrm{sp}\left(g\right)\right|$
die maximale Größe aller kleinsten Trägermengen.
\end{defn}

\section{Obere Schranken für die Größe von Trägern}

Das Ergebnis von Anderson und Dawar beruht auf einem Theorem, das
eine konstante obere Schranke $\mathrm{S}\left(\mathcal{C}_{n}\right)\in\mathcal{O}\left(1\right)$
für jede symmetrischen Schaltkreisfamilie $\left(\mathcal{C}_{n}\right)_{n\in\mathbb{N}}$
polynomieller Größe nachweist. Diese konstante Größe führt zu einer
polynomiell beschränkten Anzahl von Permutationen $\left|\mathrm{Sym}_{\mathrm{S}\left(g\right)}\right|=\left|\mathrm{S}\left(g\right)\right|!\leqslant n^{\left|S\left(g\right)\right|}$
jeder Trägermenge eines Gates.

Wir stellen hierfür das sogenannte Support-Theorem vor:
\begin{thm}
\textbf{\label{thm:Support-Theorem}Support-Theorem} (Theorem 21 aus
\cite{AD2014})

Für $\epsilon\in\mathbb{R}_{\left[\frac{2}{3},1\right]}$ und einen
rigiden symmetrischen Schaltkreis $\mathcal{C}=\left(G,W,\Sigma,\Omega,U\right)$
mit $\left|U\right|>2^{\frac{56}{\epsilon^{2}}}$, gilt: Wenn die
maximalen Orbit-Größe mit $s\coloneqq\max_{g\in G}\mathrm{Orb}_{\mathcal{C}}\left(g\right)\leqslant2^{n^{1-\epsilon}}$
subexponentiell ist, dann ist $\mathrm{sp}\left(\mathcal{C}\right)\leqslant\frac{33}{\epsilon}\frac{\log s}{\log n}$.\end{thm}
\begin{cor}
\label{cor:korollar-23}(Korollar 23 aus \cite{AD2014})

Für jede symmetrische, rigide $\left(\sigma,\mathbb{B}\right)$-Schaltkreisfamilie
mit $\mathrm{poly}\left(n\right)$-Größe gilt $\mathrm{sp}\left(\mathcal{C}_{n}\right)\in\mathcal{O}\left(1\right)$.\end{cor}
\begin{proof}
Die $\mathrm{poly}\left(n\right)$-Größe des Schaltkreises $\mathcal{C}_{n}=\left(G,W,\Sigma,\Omega,U\right)$
impliziert für jedes $\epsilon<1$ und hinreichend große $n\in\mathbb{N}$
offensichtlich: 
\[
s\coloneqq\max_{g\in G}\mathrm{Orb}_{\mathcal{C}}\left(g\right)\leqslant\left|\mathcal{C}_{n}\right|\leqslant n^{c}<2^{n^{1-\epsilon}}
\]
Damit ist $\mathrm{sp}\left(\mathcal{C}\right)\leqslant\frac{33}{\epsilon}\frac{\log s}{\log n}\leqslant\frac{33}{\epsilon}\frac{k\log n}{\log n}=\frac{33k}{\epsilon}\in\mathcal{O}\left(1\right)$. 
\end{proof}

\chapter{Von Schaltkreisfamilien zu Formeln}


\section{Berechnung von rigiden Schaltkreisen}

Um die Eindeutigkeit der im symmetrischen Schaltkreis induzierten
Automorphismen zu gewährleisten, wird nun gefordert, dass der Schaltkreis
\emph{rigide }gemäß Definition \ref{def:rigid} ist.

Die Rigidität kann nicht in jeder booleschen Basis $\mathbb{B}$ problemlos
hergestellt werden, ohne die Tiefe zu verändern - während redundante
Vorgänger von $\mathtt{AND}$- und $\mathtt{OR}$-Gates ohne Beschränkung
der Annahme entfernt werden können, ist dies zum Beispiel bei $\mathtt{MAJ}$-
und $\mathtt{XOR}$-Gates nicht möglich.

In \cite{AD2014} werden redundante Gates $H=\left(g_{1},\cdots,g_{k}\right)$
,,in Reihe`` geschaltet, so dass jedes Gate $g_{i}\in H\backslash\left\{ g_{1}\right\} $
durch ein $\mathtt{AND}$-Gate mit dem Vorgänger $g_{i-1}$ ersetzt
wird. Dies vergrößert jedoch die Tiefe des Schaltkreises unbeschränkt.

Um die Tiefe als Parameter zu erhalten, werden wir stattdessen die
Definition des Schaltkreises auf Multigraphen erweitern:
\begin{defn}
\textbf{Multimenge}

Eine Multimenge $\mathcal{W}:W\rightarrow\mathbb{N}$ sei eine Abbildung
einer Menge auf $\mathbb{N}$, wobei $\mathcal{W}\left(x\right)$
die Vielfachheit von $x$ in $\mathcal{W}$ angibt.
\end{defn}
Nach der in Definition \ref{def:relation} eingeführten Notation entspricht
für eine gewöhnliche Relation $W\subseteq G^{2}$ die Funktion $\left[W\right]:G^{2}\rightarrow\left\{ 0,1\right\} $
gerade der äquivalenten Multimenge. Die Größe der Multimenge $\left|\mathcal{W}\right|\coloneqq\sum_{w\in\mathcal{W}}\mathcal{W}\left(x\right)$
sei die Summe der Vielfachheiten aller Elemente.
\begin{defn}
\textbf{Multischaltkreis}

Ein $\left(\sigma,\mathbb{B}_{\mathrm{std}}\right)$-Multischaltkreis
$\mathcal{C}=\left(G,\mathcal{W},\Sigma,\Omega,U\right)$ ist analog
zum $\left(\sigma,\mathbb{B}\right)$-Schaltkreis definiert, aber
$\left(G,\mathcal{W}\right)$ bildet einen azyklischen Multigraphen:
\[
\mathcal{W}:G\times G\rightarrow\mathbb{N}
\]


Formal beschreiben wir den Multischaltkreis durch eine $\tau_{\sigma,\mathbb{B},k}$-Struktur
$\mathcal{C}$ über einem Universum $G\uplus U\uplus\left[0,\left|\mathcal{W}\right|\right]$
ausgewertet:
\begin{eqnarray*}
\tau_{\sigma,\mathbb{B},k}' & \coloneqq & \left\{ W/3,\left(\Sigma_{s}/1\right)_{s\in\mathbb{B}\uplus\left\{ \mathbf{0},\mathbf{1},\mathtt{NOT}\right\} },\left(\Sigma_{R}/1+k\right)_{R/k\in\sigma},\Omega/k+1\right\} \\
\mathrm{ar}\left(W\right) & \coloneqq & 3\\
W^{\mathcal{C}} & = & \left\{ \left(g,g',n\right)\in G^{2}\times\left[0,\left|\mathcal{W}\right|\right]\mid\mathcal{W}\left(g,g'\right)=n\right\} 
\end{eqnarray*}


Für die Auswertung eines internen Gates gilt analog zu \ref{def:circuit-eval}:
\begin{eqnarray*}
j_{1} & \coloneqq & \sum_{h\in G}\left(\mathcal{C}\left[\mathfrak{A}\right]\left(h\right)\cdot\mathcal{W}\left(h,g\right)\right)\\
j_{0} & \coloneqq & \sum_{h\in G}\mathcal{W}\left(h,g\right)-j_{1}\\
\mathcal{C}\left[\mathfrak{A}\right]\left(g\right) & \coloneqq & \left[\Sigma\left(g\right)\right]\left(j_{0},j_{1}\right)
\end{eqnarray*}

\end{defn}
Die Größe $\left|\mathcal{C}\right|$ eines Multischaltkreises $\mathcal{C}$
sei die Summe seiner Gates und Kanten:
\[
\left|\mathcal{C}\right|\coloneqq\left|G\right|+\sum_{g,g'\in G^{2}}\mathcal{W}\left(g,g'\right)
\]


Die Symmetrie wird auf natürliche Weise angepasst: Der von $\pi$
induzierte Automorphismus $\hat{\pi}\in\mathrm{Aut}_{\mathcal{C}}$
bildet $\left(G,\mathcal{W}\right)$ auf den isomorphen Multigraphen
$\left(\hat{\pi}G,\hat{\pi}\mathcal{W}\right)$ mit $\mathcal{W}\left(\hat{\pi}g,\hat{\pi}g'\right)=\mathcal{W}\left(g,g'\right)$
ab.

Die Rigidität wird ebenfalls angepasst: Ein rigider Schaltkreis enthält
keine Gates $g,g'$ mit $\Sigma\left(g\right)=\Sigma\left(g'\right)$
und $\mathcal{W}\left(h,g\right)=\mathcal{W}\left(h,g'\right)$ für
alle $h\in G$.
\begin{lem}
\label{lem:algo-rigid}(nach Lemma 24 aus \cite{AD2014})

Es existiert ein Algorithmus, der einen beliebigen $\left(\sigma,\mathbb{B}\right)$-Schaltkreis
$\mathcal{C}$ in einen rigiden Multischaltkreis $\hat{\mathcal{C}}$
umwandelt, wobei $T\left(\hat{\mathcal{C}}\right)=T\left(\mathcal{C}\right)$
und $\left|\hat{\mathcal{C}}\right|\leqslant\left|\mathcal{C}\right|+\left|\mathcal{C}\right|^{2}$.
Der Algorithmus ist $\mathrm{poly}\left(\left|G\right|+\left|U\right|\right)$-zeitbeschränkt.\end{lem}
\begin{proof}
Sei $\mathcal{C}''=\left(G,W,\Sigma,\Omega,U\right)$ ein beliebiger
$k$-stelliger Schaltkreis. Wir erzeugen zunächst den äquivalenten
Multischaltkreis $\mathcal{C}\coloneqq\left(G,\mathcal{W},\Sigma,\Omega,U\right)$
mit $\mathcal{W}\coloneqq\left[W\right]$, wobei die Tiefe unverändert
bleibt und die Größe zu $\left|\mathcal{C}\right|=\left|G\right|+\left|W\right|\leqslant\left|\mathcal{C}''\right|+\left|\mathcal{C}''\right|^{2}$
wird.

Der Multischaltkreis $\mathcal{C}$ wird nun wiederholt reduziert,
bis er rigide ist: Berechne dazu die Äquivalenzrelation $\sim_{\mathcal{C}}\subseteq G\times G$,
so dass $g\sim_{\mathcal{C}}g'$ genau dann wenn
\begin{enumerate}
\item $\Sigma\left(g\right)=\Sigma\left(g'\right)$, und
\item für alle $h\in W$ gilt $\mathcal{W}\left(h,g\right)=\mathcal{W}\left(h,g'\right)$.
\end{enumerate}
Wenn keine Gates $g,g'\in G$ mit $g\sim_{\mathcal{C}}g'$ mehr existieren,
so ist der Schaltkreis rigide, und der Algorithmus ist fertig.

Ansonsten sei $E\subseteq G$ eine Äquivalenzklasse von $\sim_{\mathcal{C}}$
mit mindestens zwei Gates und minimaler Tiefe $T\left(E\right)$. 

Wir berechnen die Funktion $c:G\rightarrow\left[0,\left|E\right|\right]$,
die für jedes Gate $h\in G$ die Vorgänger in $E$ zählt:
\[
c\left(h\right)\coloneqq\sum_{g'\in E}\mathcal{W}\left(g',h\right)
\]


Sei $g\in E$ beliebig, und sei $f_{g,E}\left(\mathcal{C}\right)\coloneqq\left(G',\mathcal{W}',\Sigma',\Omega',U\right)$
der folgende Multischaltkreis:
\begin{eqnarray*}
G' & \coloneqq & G\backslash\left(E\backslash\left\{ g\right\} \right)\\
\Sigma' & \coloneqq & \Sigma_{\backslash E\backslash\left\{ g\right\} }
\end{eqnarray*}

\begin{enumerate}
\item Es werden die eingehenden Kanten der Gates $E\backslash\left\{ g\right\} $
entfernt. Außerdem werden die von $E$ ausgehenden Kanten entfernt
und durch Kanten von $g$ ersetzt:
\[
\mathcal{W}'\left(h,i\right)\coloneqq\begin{cases}
c\left(i\right) & \mathrm{falls}\,h=g\\
0 & \mathrm{falls}\,h\in E\backslash\left\{ g\right\} \\
0 & \mathrm{falls}\,i\in E\backslash\left\{ g\right\} \\
\mathcal{W}\left(h,i\right) & \mathrm{sonst}
\end{cases}
\]

\item Die Output-Funktion wird wie folgt angepasst:
\[
\Omega'\left(\bar{t}\right)\coloneqq\begin{cases}
g & \mathrm{falls}\,\Omega\left(t\right)\in E\backslash\left\{ g\right\} \\
\Omega\left(t\right) & \mathrm{sonst}
\end{cases}
\]

\end{enumerate}
Der Schaltkreis $\mathcal{C}'\coloneqq f_{g,E}\left(\mathcal{C}\right)$
ist äquivalent zu dem Schaltkreis $\mathcal{C}$ über jeder Struktur
$\mathfrak{A}\in\mathbf{FIN}^{U}\left(\sigma\right)$, was induktiv
über die Tiefe (ausgehend von $g$) nachgewiesen wird:
\begin{enumerate}
\item Offensichtlich gilt $\mathcal{C}'\left[\mathfrak{A}\right]\left(g\right)=\mathcal{C}\left[\mathfrak{A}\right]\left(g\right)=\mathcal{C}\left[\mathfrak{A}\right]\left(g'\right)$
für alle $g'\in E$, da die Gates die gleichen Vorgänger und die gleiche
Beschriftung $\Sigma'\left(g\right)=\Sigma\left(g\right)=\Sigma\left(g'\right)$
besitzen.
\item Für jeden direkten Nachfolger $h\in G$ eines Gates $g'\in E$ gilt:
\begin{eqnarray*}
j_{1} & \coloneqq & \sum_{i\in G'}\mathcal{W}\left(i,h\right)\cdot\mathcal{C}\left[\mathfrak{A}\right]\\
j_{0} & \coloneqq & \sum_{i\in G'}\mathcal{W}\left(i,h\right)-j_{1}\\
j_{1}' & \coloneqq & \sum_{i\in G'}\mathcal{W}'\left(i,h\right)\cdot\mathcal{C}'\left[\mathfrak{A}\right]\\
j_{0}' & \coloneqq & \sum_{i\in G'}\mathcal{W}'\left(i,h\right)-j_{1}'
\end{eqnarray*}
Aus der Definition von $\mathcal{W}'$ folgt $j_{1}=j_{1}'$ und $j_{0}=j_{0}'$,
da die $c\left(h\right)-1$ entfernten Vorgänger $g'\in E\backslash\left\{ g\right\} $
durch $c\left(h\right)-1$ zusätzliche $\left(g,h\right)$-Kanten
ersetzt wurden, und $\mathcal{C}\left[\mathfrak{A}\right]\left(g\right)=\mathcal{C}\left[\mathfrak{A}\right]\left(g'\right)$.
Daher gilt: 
\begin{eqnarray*}
\mathcal{C}'\left[\mathfrak{A}\right]\left(g\right) & \coloneqq & \left[\Sigma'\left(g\right)\right]\left(j_{0}',j_{1}'\right)\\
 & = & \left[\Sigma\left(g\right)\right]\left(j_{0},j_{1}\right)\\
 & = & \mathcal{C}\left[\mathfrak{A}\right]
\end{eqnarray*}

\item Für jedes übrige Gate $h\in G$ folgt die Äquivalenz aus der Induktionsannahme
und der Tatsache, dass die Vorgänger von $h$ unverändert bleiben.
\end{enumerate}

Für jedes Tupel $\bar{t}\in U^{k}$ mit $\Omega\left(\bar{t}\right)=g'\in E$
gilt nun:
\begin{eqnarray*}
\left\llbracket \mathcal{C}'\right\rrbracket \left(\mathfrak{A},\bar{t}\right) & = & \mathcal{C}'\left[\mathfrak{A}\right]\left(\Omega'\left(\bar{t}\right)\right)\\
 & = & \mathcal{C}'\left[\mathfrak{A}\right]\left(g\right)\\
 & = & \mathcal{C}\left[\mathfrak{A}\right]\left(g\right)\\
 & = & \mathcal{C}\left[\mathfrak{A}\right]\left(g'\right)\\
 & = & \mathcal{C}\left[\mathfrak{A}\right]\left(\Omega\left(\bar{t}\right)\right)=\left\llbracket \mathcal{C}\right\rrbracket \left(\mathfrak{A},\bar{t}\right)
\end{eqnarray*}

\begin{description}
\item [{Größe:}] Die Umrechnung von $\mathcal{C}$ zu $f_{g,E}\left(\mathcal{C}\right)$
lässt die Tiefe unverändert, und vergrößert den Schaltkreis nicht:
Es werden $\sum_{h\in G}c\left(h\right)$ Kanten eingefügt und mindestens
$\sum_{g',h'\in E\times G}$ Kanten entfernt, wobei gilt:
\[
\sum_{h\in G}c\left(h\right)=\sum_{h\in G}\sum_{g'\in E}\mathcal{W}\left(g',h\right)=\sum_{g',h'\in E\times G}
\]

\item [{Symmetrie:}] Wenn alle Äquivalenzklassen $\bar{E}=\left(E_{1},\cdots,E_{m}\right)$
der gleichen Tiefe reduziert werden, dann bewahrt der neue Schaltkreis
$f_{g_{1,}E_{1}}\cdots f_{g_{m},E_{m}}\left(\mathcal{C}\right)=\mathcal{C}'$
die Symmetrie von $\mathcal{C}$:


Sei $\pi\in\mathrm{Sym}_{U}$ eine beliebige Permutation, und $\hat{\pi}$
ein induzierter Automorphismus. Offensichtlich muss $\hat{\pi}$ die
Äquivalenzklassen $\bar{E}$ aufeinander abbilden, da $\hat{\pi}g\sim_{\mathcal{C}}\hat{\pi}g'$
für alle $g\sim_{\mathcal{C}}g'$ gilt.


Der Automorphismus $\hat{\pi}$ auf $\mathcal{C}$ wird wie folgt
zu einem auf $\mathcal{C}'$ angepasst:
\[
\hat{\pi}'g\coloneqq\begin{cases}
g_{i} & \mathrm{falls}\,\hat{\pi}g\in E_{i}\\
\hat{\pi}g & \mathrm{sonst}
\end{cases}
\]



Da $\mathcal{W}\left(\hat{\pi}g,\hat{\pi}g'\right)=\mathcal{W}\left(g,g'\right)$,
folgt $\mathcal{W}'\left(\hat{\pi}g,\hat{\pi}g'\right)$.

\end{description}
Die Umrechnung von $\mathcal{C}$ zu $\mathcal{C}'$ verkleinert die
Äquivalenzklasse des Gates $g$ zu $\left\{ g\right\} $, da alle
äquivalenten Gates entfernt werden, und lässt alle anderen Äquivalenzklassen
der Tiefe $i\leqslant T\left(g\right)$ unverändert.

Daher haben nach höchstens $\left|G\right|$ Wiederholungen alle Äquivalenzklassen
der Tiefe $i\leqslant T\left(g\right)$ die Größe $1$, und nach höchstens
$T\left(\mathcal{C}\right)\cdot\left|G\right|$ Wiederholungen wird
ein äquivalenter, rigider Schaltkreis erzeugt.\end{proof}
\begin{prop}
Die beschriebene Konstruktion kann mit $\mathcal{O}\left(T\left(\mathcal{C}\right)\log n\right)$
Speicherplatz berechnet werden, und ist für Schaltkreisfamilien konstanter
Tiefe daher in $\mathrm{LOGSPACE}$.\end{prop}
\begin{proof}
Der Algorithmus \ref{alg:rigid} gibt die Kanten und Markierungen
des rigiden Multischaltkreises aus, wobei eine natürliche Ordnung
der Gates $G$ vorausgesetzt wird.

\begin{algorithm}
\begin{lyxcode}
Input:~$\left(G,W,\Sigma,\Omega,U\right)$.

Main:
\begin{lyxcode}
Für~jedes~Gate~$g\in G$:
\begin{lyxcode}
Falls~kein~Gate~$g'<g$~mit~Equiv($g,g'$)~existiert:
\begin{lyxcode}
Rigid($g$).
\end{lyxcode}
\end{lyxcode}
\end{lyxcode}
Rigid($g$):
\begin{lyxcode}
Gib~$g$~und~$\Sigma\left(g\right)$~aus.

Für~alle~$\bar{t}\in U^{k}$~mit~$\Omega\left(\bar{t}\right)=g$:
\begin{lyxcode}
Gib~$\Omega\left(\bar{t}\right)=g$~aus.
\end{lyxcode}
Für~jedes~Gate~$h\in G$:
\begin{lyxcode}
Falls~kein~Gate~$h'<h$~mit~Equiv($h,h'$)~existiert:
\begin{lyxcode}
$i\leftarrow0$.

Für~alle~Vorgänger~$h''$~von~$g$~mit~Equiv($h,h'')$.
\begin{lyxcode}
$i\leftarrow i+1$.
\end{lyxcode}
Gib~$\mathcal{W}\left(h,g\right)=i$~aus.
\end{lyxcode}
\end{lyxcode}
\end{lyxcode}
Equiv($g,g'$):
\begin{lyxcode}
Falls~nicht~$\Sigma\left(g\right)=\Sigma\left(g'\right)$:~$\textsc{False}$

Für~jeden~Vorgänger~$h$~von~$g$:
\begin{lyxcode}
$i\leftarrow0$

Für~jeden~Vorgänger~$h'$~von~$g$~mit~Equiv($h$,$h'$):
\begin{lyxcode}
$i\leftarrow i+1$.
\end{lyxcode}
Für~jeden~Vorgänger~$h'$~von~$g'$~mit~Equiv($h,h'$):
\begin{lyxcode}
$i\leftarrow i-1$
\end{lyxcode}
Falls~$i\neq0$:~$\textsc{False}$.
\end{lyxcode}
$\textsc{True}$
\end{lyxcode}

\end{lyxcode}
\caption{\label{alg:rigid}Berechnung des rigiden Schaltkreises}
\end{algorithm}


Sei $\sim^{*}$ eine rekursive Erweiterung von $\sim$, die alle Paare
von Gates $g,g'$ enthält, die aus jeder Äquivalenzklasse bezüglich
$\sim^{*}$ die gleiche Anzahl Vorgänger besitzen. Ferner sei $\leqslant$
eine implizite Ordnung der Gates $G$. Ein Gate $g\in G$, für das
$g\not\sim^{*}g'$ für alle $g'<g$ gilt, nennen wir den Repräsentanten
seiner Äquivalenzklasse.

Der beschriebene Algorithmus wird $\mathtt{Rigid}\left(g\right)$
für jeden Repräsentanten $g\in G$ aufrufen. $\mathtt{Rigid}\left(g\right)$
gibt dann $g$ mit seinen Markierungen aus, findet dann jeden Repräsentanten
$h\in G$, zählt die zu $h$ äquivalenten Vorgänger von $g$ und gibt
die entsprechende Multikante $\mathcal{W}\left(h,g\right)\in\mathbb{N}$
aus.

Da die Funktionen $\mathtt{Rigid}$ und $\mathtt{Equiv}$ jeweils
nur konstant viele lokale Variablen der Größe $\mathcal{O}\left(\log n\right)$
verwenden, ist der Algorithmus platzbeschränkt durch $T\cdot\mathcal{O}\left(\log n\right)$,
wobei $T$ die maximale Rekursionstiefe von $\mathtt{Equiv}$ ist.
Weil jeder Aufruf $\mathtt{Equiv}\left(g\right)$ nur Aufrufe $\mathtt{Equiv}\left(h,h'\right)$
für Vorgänger $h,h'$ von $g$ auslöst, ist $T=T\left(\mathcal{C}\right)$
die Tiefe des Schaltkreises $\mathcal{C}$.
\end{proof}

\section{Berechnung der Orbits und Träger}
\begin{prop}
\label{lem:rigide-eindeutig}(nach Satz 9 aus \cite{AD2014})

Sei $\mathcal{C}$ ein rigider $\left(\sigma,\mathbb{B}\right)$-Multischaltkreis
über $U$. Sei $\pi\in\mathrm{Sym}_{U}$ beliebig.

Falls $\pi$ einen Automorphismus in $\mathcal{C}$ induziert, dann
ist dieser eindeutig.\end{prop}
\begin{proof}
Sei $\mathcal{C}=\left(G,\mathcal{W},\Sigma,\Omega,U\right)$ und
$\pi\in\mathrm{Sym}_{U}$ beliebig. Seien $\hat{\pi}_{1},\hat{\pi}_{2}\in\mathrm{Aut}_{\mathcal{C}}$
zwei von $\pi$ induzierte Automorphismen.

Durch Induktion über die Tiefe wird bewiesen, dass $\hat{\pi}_{1}g=\hat{\pi}_{2}g$
für jedes Gate $g\in G$ gilt.
\begin{description}
\item [{Anfang:}] Wenn $g$ eine Konstante mit $\Sigma\left(g\right)\in\left\{ \mathbf{0},\mathbf{1}\right\} $
ist, dann ist $g$ das einzige Gate mit der Beschriftung $\Sigma\left(g\right)$:
\[
\hat{\pi}_{1}g=g=\hat{\pi}_{2}
\]
Wenn $g$ ein relationales Input mit $\Sigma\left(g\right)=R\bar{t}$,
$R/k\in\sigma$ und $\bar{t}\in U^{k}$ ist, dann existiert auf Grund
der Rigidität nur ein Gate $g'\in G$ mit $\Sigma\left(g'\right)=R\pi\bar{t}$:
\[
\hat{\pi}_{1}g=g'=\hat{\pi}_{2}g
\]

\item [{Schritt:}] Wenn $g$ ein internes Gate mit $\Sigma\left(g\right)\in\mathbb{B}$
ist, dann muss gelten:
\begin{eqnarray*}
\Sigma\left(\hat{\pi}_{1}g\right) & = & \Sigma\left(\hat{\pi}_{2}g\right)=\Sigma\left(g\right)\\
\mathcal{W}\left(\hat{\pi}_{1}h,\hat{\pi}_{1}g\right) & = & \mathcal{W}\left(\hat{\pi}_{2}h,\hat{\pi}_{2}g\right)=\mathcal{W}\left(h,g\right)\\
 &  & \mathrm{f.a.}\,\,h\in G
\end{eqnarray*}
Auf Grund der Rigidität von $\mathcal{C}$ muss $\hat{\pi}_{1}g=\hat{\pi}_{2}g$
gelten.
\end{description}
\end{proof}
\begin{lem}
\label{lem:algo-auto}(nach Lemma 25 aus \cite{AD2014})

Es existiert ein deterministischer Algorithmus, der bei Eingabe eines
rigiden $\left(\sigma,\mathbb{B}\right)$-Multischaltkreises $\mathcal{C}=\left(G,\mathcal{W},\Sigma,\Omega,U\right)$
und einer Permutation $\pi\in\mathrm{Sym}_{U}$ in $\mathrm{poly}\left(\left|\mathcal{C}\right|\right)$-Zeit
für jedes Gate $g\in G$ das Gate $\hat{\pi}g$ ausgibt, falls $\pi$
einen Automorphismus $\hat{\pi}$ induziert.\end{lem}
\begin{proof}
Analog zu dem Beweis von Lemma \ref{lem:rigide-eindeutig} wird gezeigt,
dass der eindeutige Automorphismus in Polynomialzeit bestimmt wird:
\begin{enumerate}
\item Zunächst sei für jedes konstante Gate $\hat{\pi}g\coloneqq g$. Für
jedes relationale Input $g\in G$ mit $\Sigma\left(g\right)=R\bar{t}$
finde das einzige Gate $g'\in G$ mit $\Sigma\left(g\right)=R\pi\bar{t}$
und gib $\hat{\pi}g\coloneqq g'$ aus.
\item Finde ein beliebiges Gate $g\in G$, für dessen Vorgänger $h\in G$
mit $\mathcal{W}\left(h,g\right)>0$ bereits $\hat{\pi}h=h'$ ausgegeben
wurde.
\item Finde ein Gate $g'\in G$ mit $\Sigma\left(g\right)=\Sigma\left(g'\right)$
und $\mathcal{W}\left(\hat{\pi}h,g'\right)=\mathcal{W}\left(h,g\right)$
für die Vorgänger $h\in G$, so dass $g'$ sonst keine Vorgänger hat.
(Wegen der Rigidität gibt es höchstens eines.) Gib $\hat{\pi}g=g'$
aus.
\item Wiederhole die Schritte 2 bis 3 solange bis $\hat{\pi}$ für jedes
Gate $g\in G$ berechnet wurde. (Wenn zu irgendeinem $g$ kein Gate
gefunden wird, ist der Schaltkreis nicht symmetrisch und der Algorithmus
bricht ab.)
\end{enumerate}
Die Schritte 2 bis 3 werden höchstens $\left|G\right|$-mal wiederholt,
und jeder Schritt erfordert $\left|G\right|^{2}$-Zeit, so dass der
Algorithmus in $\left|G\right|^{3}$-Zeit arbeitet.\end{proof}
\begin{prop}
Die obige Konstruktion ist mit $\mathcal{O}\left(T\left(\mathcal{C}\right)\log n\right)$
Speicherplatz berechenbar, und ist für Schaltkreisfamilien konstanter
Tiefe daher in $\mathrm{LOGSPACE}$.\end{prop}
\begin{proof}
Der Algorithmus \ref{alg:aut} berechnet den Automorphismus $\hat{\pi}$,
in dem für jedes Paar von Gates $g,g'$ rekursiv geprüft wird, ob
$\hat{\pi}g=\hat{\pi}g'$.

Da jede Funktion nur konstant viele lokale Variablen der Größe $\mathcal{O}\left(\log\left|G\right|\right)$
verwendet, ist der Speicherplatz durch die Funktion $T\cdot\mathcal{O}\left(\log n\right)$
beschränkt, wobei $T$ die Rekursionstiefe ist. Weil $\mathtt{Aut}\left(g,g'\right)$
nur $\mathtt{Aut}\left(h,h'\right)$ für Vorgänger $h$ von $g$ und
$h'$ von $g'$ aufruft, ist $T\leqslant T\left(\mathcal{C}\right)$.

\begin{algorithm}
\begin{lyxcode}
Input:~$\left(G,W,\Sigma,\Omega,U\right)$,~$k$,~$\pi$.

Main:
\begin{lyxcode}
Für~$g,g'\in G$:
\begin{lyxcode}
Falls~Aut($g,g'$):
\begin{lyxcode}
Gib~$\hat{\pi}\left(g\right)=g'$~aus.
\end{lyxcode}
\end{lyxcode}
\end{lyxcode}
Aut($g,g'$):
\begin{lyxcode}
Falls~$\Sigma\left(g\right)\neq\Sigma\left(g'\right)\in\mathbb{B}\uplus\left\{ \mathbf{0},\mathbf{1},\mathtt{NOT}\right\} $:~$\textsc{False}$

Falls~$\Sigma\left(g\right)=R\bar{t}$,~$\Sigma\left(g'\right)\neq R\pi\bar{t}$:~$\textsc{False}$

Für~$\bar{t}\in U^{k}$:
\begin{lyxcode}
Falls~$\Omega\left(\bar{t}\right)=g$~und~$\Omega\left(\pi\bar{t}\right)\neq g'$:~$\textsc{False}$
\end{lyxcode}
Für~jeden~Vorgänger~$h$~von~$g$:
\begin{lyxcode}
Falls~kein~Vorgänger~$h'$~von~$g'$~mit~Aut($h,h'$)~existiert:
\begin{lyxcode}
$\textsc{False}$
\end{lyxcode}
\end{lyxcode}
$\textsc{True}$
\end{lyxcode}
\end{lyxcode}
\caption{\label{alg:aut}Berechnung der Automorphismen}
\end{algorithm}
\end{proof}
\begin{lem}
(nach Lemma 26 aus \cite{AD2014})

Es existiert ein deterministischer Algorithmus, der bei Eingabe eines
rigiden $\left(\sigma,\mathbb{B}\right)$-Multischaltkreises $\mathcal{C}=\left(G,\mathcal{W},\Sigma,\Omega,U\right)$
in $\mathrm{poly}\left(\left|\mathcal{C}\right|\right)$ entscheidet,
ob dieser symmetrisch ist, und gegebenenfalls die Orbits $\mathrm{Orb}_{\mathcal{C}}\left(g\right)$
und Trägermenge $\mathrm{sp}\left(g\right)$ jedes Gates $g\in G$
ausgibt.\end{lem}
\begin{proof}
Um die Symmetrie nachzuweisen, genügt es, den Algorithmus aus Lemma
\ref{lem:algo-auto} für jede Transposition $\left(uv\right)\in\mathrm{Sym}_{U}$
durchzuführen. Diese Transpositionen erzeugen die gesamte Symmetriegruppe
$\mathrm{Sym}_{U}$, und daher ist für jede Permutation $\pi=\left(u_{1}v_{1}\right)\cdots\left(u_{k}v_{k}\right)\in\mathrm{Sym}_{U}$
die Abbildung $\hat{\pi}=\hat{\pi}_{\left(u_{1}v_{1}\right)}\cdots\hat{\pi}_{\left(u_{k}v_{k}\right)}$
ein von $\pi$ induzierter Automorphismus.
\begin{enumerate}
\item Berechne den von $\left(uv\right)\in\mathrm{Sym}_{U}$ induzierten
Automorphismus $\hat{\pi}_{\left(uv\right)}$ für jedes Paar $u,v\in U$
mit $u\neq v$. Wenn nicht alle Automorphismen existieren, ist der
Schaltkreis nicht symmetrisch; es wird abgebrochen.
\item Für jedes Gate $g\in G$ wird die Trägerpartition $\mathrm{SP}\left(\mathrm{Stab}_{\mathcal{C}}\left(g\right)\right)$
aufgebaut, in dem für jede Transposition $\left(uv\right)\in\mathrm{Sym}_{U}$
geprüft wird, ob $\hat{\pi}_{\left(uv\right)}$ das Gate $g$ fixiert.
In diesem Fall werden die Elemente $u,v$ in der Partition kombiniert:
\begin{eqnarray*}
\mathcal{P}_{\left(uv\right)} & \coloneqq & \left\{ \left\{ u,v\right\} \right\} \cup\left\{ \left\{ w\right\} \mid w\in U\backslash\left\{ u,v\right\} \right\} \\
\mathcal{P}_{g} & \coloneqq & \bigsqcup_{\begin{subarray}{c}
\left(uv\right)\in\mathrm{Sym}_{U}\\
\hat{\pi}_{\left(uv\right)}g=g
\end{subarray}}\mathcal{P}_{\left(uv\right)}
\end{eqnarray*}

\item Für jedes Gate $g\in G$ sei $S_{0}\coloneqq\left\{ g\right\} $.
Iterativ wird der Orbit von $g$ wie folgt aufgebaut, bis mit $S_{i+1}=S_{i}$
ein Fixpunkt erreicht wird (spätestens bei $S_{\left|U\right|}$):
\[
S_{i+1}\coloneqq S_{i}\cup\bigcup_{\left(uv\right)\in\mathrm{Sym}_{U}}\hat{\pi}_{\left(uv\right)}S_{i}
\]

\end{enumerate}
Nach den Definitionen aus Kapitel 7 ist jede Partition $\mathcal{P}_{\left(uv\right)}$
eine Trägerpartition von $\mathrm{Stab}_{\mathcal{C}}\left(g\right)$,
wenn $\hat{\pi}_{\left(uv\right)}g=g$, und daher ist $\mathcal{P}_{g}$
ebenfalls eine Trägerpartition von $\mathrm{Stab}_{\mathcal{C}}\left(g\right)$.
Wenn es eine gröbere Trägerpartition $\mathcal{P}'$ gäbe, dann müsste
diese zwei Elemente $u,v\in U$ kombinieren, die in $\mathcal{P}_{g}$
getrennt sind, und für die $\hat{\pi}_{\left(uv\right)}g=g$ gilt.
In diesem Fall wäre aber die Partition $\mathcal{P}_{\left(uv\right)}$
mit in $\mathcal{P}_{g}$ aufgenommen worden, und daher ist $\mathcal{P}_{g}=\mathrm{SP}\left(\mathrm{Stab}_{\mathcal{C}}\left(g\right)\right)$.
Es wird $\mathrm{sp}\left(g\right)=U\backslash\max_{\left|\cdot\right|}\mathcal{P}_{g}$
ausgegeben.

Für die Mengen $\left(S_{i}\right)_{i\in\mathbb{N}}$ gilt $S_{i}\subseteq\mathrm{Orb}_{\mathcal{C}}\left(g\right)$,
denn per Induktion existiert für jedes Gate $g'\in S_{i}$ eine Folge
von $i$ Transpositionen $\pi_{1}\cdots\pi_{i}$, so dass $\hat{\pi}_{1}\cdots\hat{\pi}_{i}$
das Gate $g$ auf $g'$ abbildet. Ferner besteht jede Permutation
$\pi$ aus einer Folge von höchstens $\left|U\right|$ Transpositionen,
so dass $S_{\left|U\right|}\supseteq\mathrm{Orb}_{\mathcal{C}}\left(g\right)$
den gesamten Orbit von $g$ enthält.

Es existieren weniger als $\left|U\right|^{2}$ Transpositionen, so
dass der Schritt 1 in $\left|G\right|^{3}\left|U\right|^{2}$-Zeit
abgeschlossen wird. Ebenso wird Schritt 2 in $\left|U\right|^{3}$-Zeit
abgeschlossen. Schritt 3 erfordert eine Iteration bis $S_{\left|U\right|}$,
wobei jeder Durchlauf $\left|U\right|^{2}$-Zeit benötigt. Insgesamt
läuft der Algorithmus in $\left|G\right|^{3}\left|U\right|^{3}$-Zeit.\end{proof}
\begin{prop}
Die obige Konstruktion ist mit $\mathcal{O}\left(T\left(\mathcal{C}\right)\log n\right)$
Speicherplatz berechenbar, und daher für Schaltkreisfamilien konstanter
Tiefe in $\mathrm{LOGSPACE}$.\end{prop}
\begin{proof}
Der entscheidende Teil ist die Bestimmung der größten Menge $P_{i}\subseteq\mathrm{SP}\left(\mathrm{Stab}_{\mathcal{C}}\left(g\right)\right)$,
denn offensichtlich können wir mit logarithmischem Platz nicht die
Partition $\mathrm{SP}\left(\mathrm{Stab}_{\mathcal{C}}\left(g\right)\right)$
(und noch nicht einmal $P_{i}$) abspeichern. Es reicht uns aber,
wenn der Algorithmus \ref{alg:orbits} für jedes Element $u\in U$
die Elemente $u\sim u'$ zählt, und sich das Element $u$ mit der
größten Äquivalenzklasse merkt. Dann findet er alle Elemente mit $u'\not\sim u$
(per Korollar \ref{cor:korollar-23} gibt es davon nur $\mathcal{O}\left(1\right)$
viele), und bildet daraus die Trägermenge $\mathrm{sp}\left(g\right)$.

Der Orbit hat die Größe $n^{\left|\mathrm{sp}\left(g\right)\right|}$,
aber diesen muss der Algorithmus nicht abspeichern, sondern nur iterativ
ausgeben.
\end{proof}
\begin{algorithm}
\begin{lyxcode}
Input:~$\left(G,W,\Sigma,\Omega,U\right)$

Trägermenge($g$):
\begin{lyxcode}
$\bar{s}\leftarrow\left\langle \right\rangle $,~$j\leftarrow0$

Für~alle~$u\in U$:
\begin{lyxcode}
$i\leftarrow0$

Für~alle~$v\in U$:
\begin{lyxcode}
Falls~$\hat{\pi}_{\left(uv\right)}\left(g\right)=g$:~(mit~Algorithmus~\ref{alg:aut})
\begin{lyxcode}
$i\leftarrow i+1$
\end{lyxcode}
\end{lyxcode}
Falls~$i>j$:
\begin{lyxcode}
$u'\leftarrow u$,~$j\leftarrow i$
\end{lyxcode}
\end{lyxcode}
Für~alle~$v\in U$:
\begin{lyxcode}
Falls~$\hat{\pi}_{\left(u'v\right)}\left(g\right)\neq g$:
\begin{lyxcode}
$\bar{s}\leftarrow\bar{s}v$
\end{lyxcode}
\end{lyxcode}
Gib~$\bar{s}$~zurück.
\end{lyxcode}
Orbit($g$):
\begin{lyxcode}
$\bar{s}\leftarrow\mathtt{Tr\ddot{a}germenge}\left(g\right)$
\begin{lyxcode}
Für~$\bar{t}\in U^{\mathrm{ar}\left(\bar{s}\right)}$:
\begin{lyxcode}
Gib~$\hat{\pi}_{\left(\bar{s}\mapsto\bar{t}\right)}\left(g\right)$~aus.
\end{lyxcode}
\end{lyxcode}
\end{lyxcode}
\end{lyxcode}
\caption{\label{alg:orbits}Berechnung der Trägermengen $\mathrm{sp}\left(g\right)$
und Orbits $\mathrm{Orb}_{\mathcal{C}}\left(g\right)$}


\end{algorithm}



\section{Rekursive Auswertung der Schaltkreise}

Für eine rigide, symmetrische $k$-stellige $\left(\sigma,\mathbb{B}\right)$-Multischaltkreisfamilie
$\left(\mathcal{C}_{n}\right)_{n\in\mathbb{N}}$ gilt nach Korollar
\ref{cor:korollar-23} $\mathrm{SP}\left(\mathcal{C}_{n}\right)\in\mathcal{O}\left(1\right)$.
Seien also $n_{0},c\in\mathbb{N}$ so gewählt, dass $\mathrm{SP}\left(\mathcal{C}_{n}\right)\leqslant c$
für $n\geqslant n_{0}$.

Zur Erinnerung: $\mathrm{sp}\left(\mathcal{C}\right)$ ist die maximale
Größe der Trägermenge $\mathrm{sp}\left(g\right)=\left\{ P_{1},\cdots,P_{m}\right\} $,
$\left|P_{1}\right|\leqslant\cdots\leqslant\left|P_{m}\right|$ jedes
Gates $g$ von $\mathcal{C}$.

Wir möchten $\mathcal{C}_{n}$ auf beliebigen Strukturen $\mathfrak{A}\in\mathbf{FIN}^{\left(n\right)}\left(\sigma\right)$
(nicht nur $\mathfrak{A}\in\mathbf{FIN}^{\left[1,n\right]}\left(\sigma\right)$)
auswerten, wofür eine beliebige Einbettung $\pi:A\rightarrow\left[1,n\right]$
definiert werden muss. Es wird nun gezeigt, dass die Auswertung des
Gates $g$ nur von dem Teil der Abbildung $\pi$ abhängt, der Elemente
auf $\mathrm{sp}\left(g\right)$ abbildet. Die Abbildung auf die übrigen
Elemente $U\backslash\mathrm{sp}\left(g\right)$ ist für $g$ unbedeutend.

Die Folgerung in diesem Abschnitt passt den Abschnitt 4.3 aus \cite{AD2014}
für Multischaltkreise an.


\begin{defn}
\textbf{Konsistenz}

Zwei bijektive Abbildungen $f,f':A\rightarrow B$ seien konsistent
in $A'\subseteq A$ (kurz $f\sim_{A'}f'$), wenn sie im Teilbereich
$A'$ identisch sind. 
\[
f\sim_{A'}f'\Leftrightarrow f_{\mid A'}=f'_{\mid A'}
\]


Für $B'\subseteq B$ heißen sie bildkonsistent in $B'$, wenn $f^{-1}\sim_{B'}f^{-1}$
beziehungsweise wenn $f=\tau f'$ mit einer Permutation $\tau\in\mathrm{Stab}_{B}\left(B'\right)$,
die die Elemente von $B'$ fixiert.\end{defn}
\begin{prop}
\label{prop:konsistenz}Sei $\mathcal{C}=\left(G,\mathcal{W},\Sigma,\Omega,U\right)$
ein rigider, symmetrischer Multischaltkreis mit $n=\left|U\right|$,
und sei $g\in G$ ein beliebiges Gate mit den Vorgängern $H\coloneqq\left\{ h\in G\mid\mathcal{W}\left(h,g\right)>0\right\} $.
Sei $\mathfrak{A}\in\mathbf{FIN}^{\left(n\right)}\left(\sigma\right)$
eine beliebige Struktur. Seien $\pi_{1},\pi_{2}:A\rightarrow U$ zwei
beliebige Einbettungen von $\mathfrak{A}$ in $U$, die bildkonsistent
in $\mathrm{sp}\left(g\right)$ sind. So gilt:
\begin{eqnarray}
\mathcal{C}\left[\pi_{1}\mathfrak{A}\right]\left(g\right) & = & \mathcal{C}\left[\pi_{2}\mathfrak{A}\right]\left(g\right)\label{eq:cons-1}\\
\sum_{h\in H}\mathcal{W}\left(h,g\right)\cdot\mathcal{C}\left[\pi_{1}\mathfrak{A}\right]\left(h\right) & = & \sum_{h\in H}\mathcal{W}\left(h,g\right)\cdot\mathcal{C}\left[\pi_{2}\mathfrak{A}\right]\left(h\right)\label{eq:cons-2}
\end{eqnarray}
\end{prop}
\begin{proof}
Sei $\tau\in\mathrm{Sym}_{U}$ die Permutation $\tau\coloneqq\pi_{1}\pi_{2}^{-1}$,
so dass $\pi_{1}=\tau\pi_{2}$.

Weil $\pi_{1}$ und $\pi_{2}$ bildkonsistent in $\mathrm{sp}\left(g\right)$
sind, gilt $\pi_{1}^{-1}u=\pi_{2}^{-1}u$ für $u\in\mathrm{sp}\left(g\right)$.
\begin{eqnarray*}
\tau u & = & \pi_{1}\pi_{2}^{-1}u\\
 & = & \pi_{1}\pi_{1}^{-1}u=u
\end{eqnarray*}


Wegen der Symmetrie und Rigidität induziert $\tau$ einen eindeutigen
Automorphismus $\hat{\tau}$ im Schaltkreis $\mathcal{C}$. Weil $\tau$
die Elemente von $\mathrm{sp}\left(g\right)$ fixiert, fixiert $\hat{\tau}$
auch das Gate $g$:
\begin{eqnarray*}
\tau & \in & \mathrm{Stab}_{U}\left(\mathrm{sp}\left(g\right)\right)\\
 & \subseteq & \mathrm{Stab}_{\mathcal{C}}\left(g\right)
\end{eqnarray*}
Damit ist Gleichung \ref{eq:cons-1} bewiesen:
\begin{eqnarray*}
\mathcal{C}\left[\pi_{2}\mathfrak{A}\right]\left(g\right) & = & \mathcal{C}\left[\tau\pi_{2}\mathfrak{A}\right]\left(\hat{\tau}g\right)\\
 & = & \mathcal{C}\left[\tau\pi_{2}\mathfrak{A}\right]\left(g\right)\\
 & = & \mathcal{C}\left[\pi_{1}\mathfrak{A}\right]\left(g\right)
\end{eqnarray*}


Da $\hat{\tau}g=g$, muss auch $\hat{\tau}H=H$ auch für die Vorgänger
gelten. Außerdem hat $\hat{\tau}h$ die gleiche Anzahl von Kanten
zu $g$ wie $\tau$:
\begin{eqnarray*}
\mathcal{C}\left[\pi_{2}\right]\left(h\right) & = & \mathcal{C}\left[\tau\pi_{2}\right]\left(\hat{\tau}g\right)\\
\mathcal{W}\left(h,g\right) & = & \mathcal{W}\left(\hat{\tau},g\right)
\end{eqnarray*}
Es folgt die Gleichung \ref{eq:cons-2} für das Gewicht der mit $1$
belegten Vorgänger von $g$:
\[
\sum_{h\in H}\mathcal{W}\left(h,g\right)\cdot\mathcal{C}\left[\pi_{1}\mathfrak{A}\right]\left(h\right)=\sum_{h\in H}\mathcal{W}\left(h,g\right)\cdot\mathcal{C}\left[\pi_{2}\mathfrak{A}\right]\left(h\right)
\]
\end{proof}
\begin{defn}
Für jedes Gate $g$ des Schaltkreises $\mathcal{C}$ über dem Universum
$U$ beschreiben wir die Menge der verschiedenen Bijektionen $\pi\in\mathrm{Bij}\left(U,A\right)$,
für die $\mathcal{C}\left[\pi^{-1}\mathfrak{A}\right]\left(g\right)=1$.
Per Satz \ref{prop:konsistenz} müssen nur deren Reduktionen auf $\mathrm{sp}\left(g\right)$
betrachtet werden. Sei $\mathrm{EV}\left(g\right)$ die Menge dieser
Belegungen von $\mathrm{sp}\left(g\right)$:

\[
\mathrm{EV}\left(g\right)\coloneqq\left\{ \pi{}_{\mid\mathrm{sp}\left(g\right)}\mid\pi:\mathrm{Bij}\left(U,A\right),\,\mathcal{C}\left[\pi^{-1}\mathfrak{A}\right]\left(g\right)=1\right\} 
\]


Für jede injektive Funktion $\rho:\mathrm{sp}\left(g\right)\rightarrow A$
sei $M_{\rho}$ die Menge der zu $\rho$ konsistenten Bijektionen
$\pi:U\rightarrow A$ :
\[
M_{\rho}\coloneqq\left\{ \pi\in\mathrm{Bij}\left(U,A\right)\mid\pi_{\mid\mathrm{sp}\left(g\right)}=\rho\right\} 
\]


Zusätzlich beschreiben wir für jeden Vorgänger $h\in H$ von $g$
und jede injektive Funktion $\rho:\mathrm{sp}\left(g\right)\rightarrow A$
die Menge $\Pi_{\rho}\left(h\right)$ der unterschiedlichen $\mathrm{sp}\left(h\right)$-Reduktionen
von Bijektionen $\pi:U\rightarrow A$, die auf $\mathrm{sp}\left(g\right)$
konsistent zu $\pi$ sind: 
\[
\Pi_{\rho}\left(h\right)\coloneqq\left\{ \pi_{\mid\mathrm{sp}\left(h\right)}\mid\pi\in M_{\rho}\right\} 
\]
\end{defn}
\begin{claim}
\label{claim:claim-28}(nach Behauptung 28 aus \cite{AD2014})

Sei $\pi:U\rightarrow A$ eine beliebige Bijektion, und $\rho\coloneqq\pi_{\mid\mathrm{sp}\left(g\right)}$.
Das Gesamtgewicht der unter $\pi^{-1}\mathfrak{A}$ erfüllten Vorgänger
$h\in H$ gleicht der gewichteten Summe von $\frac{\left|\Pi_{\rho}\left(h\right)\cap\mathrm{EV}\left(h\right)\right|}{\left|\Pi_{\rho}\left(h\right)\right|}$,
dem Anteil der erfüllenden Bijektionen in $\Pi_{\rho}\left(h\right)$:

\begin{equation}
r\coloneqq\sum_{h\in H}\mathcal{W}\left(h,g\right)\mathcal{C}\left[\pi^{-1}\mathfrak{A}\right]\left(h\right)=\sum_{h\in H}\mathcal{W}\left(h,g\right)\frac{\left|\Pi_{\rho}\left(h\right)\cap\mathrm{EV}\left(h\right)\right|}{\left|\Pi_{\rho}\left(h\right)\right|}\label{eq:behauptung-28}
\end{equation}
\end{claim}
\begin{proof}
Nach Gleichung \ref{eq:cons-2} ist das Gesamtgewicht der unter $\pi'^{-1}\mathfrak{A}$
erfüllten Gates $h\in G$ für alle $\pi'\in M_{\rho}$ gleich, so
dass $\left|M_{\rho}\right|r$ die Summe der Gesamtgewichte für jede
Belegung $\pi'\in M_{\rho}$ ist.

Weiterhin können wir für jeden Vorgänger $h\in H$ die Belegungen
$M_{\rho}$ in Äquivalenzklassen bezüglich der Konsistenz zu einer
Belegung $\rho'\in\Pi_{\rho}\left(h\right)$ von $\mathrm{sp}\left(h\right)$
partitionieren: 
\begin{eqnarray*}
\left|M_{\rho}\right|r & = & \sum_{h\in H}\mathcal{W}\left(h,g\right)\sum_{\pi'\in M_{\rho}}\mathcal{C}\left[\pi'\mathfrak{^{-1}A}\right]\left(h\right)\\
 & = & \sum_{h\in H}\mathcal{W}\left(h,g\right)\sum_{\rho'\in\Pi_{\rho}\left(h\right)}\sum_{\begin{subarray}{c}
\pi'\in M_{\rho}\\
\pi'_{\mid\mathrm{sp}\left(h\right)}=\rho'
\end{subarray}}\mathcal{C}\left[\pi'^{-1}\mathfrak{A}\right]\left(h\right)
\end{eqnarray*}


Nach der Definition der Menge $\mathrm{EV}\left(h\right)$ gilt für
alle Belegungen $\pi':U\rightarrow A$, dass $\mathcal{C}\left[\pi'^{-1}\mathfrak{A}\right]\left(h\right)=1$
genau dann wenn $\pi'_{\mid\mathrm{sp}\left(h\right)}\in\mathrm{EV}\left(h\right)$.
Daher können wir $\left[\mathrm{EV}\left(h\right)\right]\left(\rho'\right)\in\left\{ 0,1\right\} $
einfach mit der Größe von $\left\{ \pi'\in M_{\rho}\mid\pi'_{\mid\mathrm{sp}\left(h\right)}=\rho'\right\} $
multiplizieren: 
\begin{eqnarray*}
\left|M_{\rho}\right|r & = & \sum_{h\in H}\mathcal{W}\left(h,g\right)\sum_{\rho'\in\Pi_{\rho}\left(h\right)}\sum_{\begin{subarray}{c}
\pi'\in M_{\rho}\\
\pi'_{\mid\mathrm{sp}\left(h\right)}=\rho'
\end{subarray}}\left[\mathrm{EV}\left(h\right)\right]\left(\rho'\right)\\
 & = & \sum_{h\in H}\mathcal{W}\left(h,g\right)\sum_{\rho'\in\Pi_{\rho}\left(h\right)}\left[\mathrm{EV}\left(h\right)\right]\left(\rho'\right)\left|\left\{ \pi'\in M_{\rho},\,\pi'_{\mid\mathrm{sp}\left(h\right)}=\rho'\right\} \right|
\end{eqnarray*}


Weil die Partitionierung $M_{\rho}=\biguplus_{\rho'\in\Pi_{\pi}\left(h\right)}\left\{ \pi'\in M_{\rho},\,\pi'_{\mid\mathrm{sp}\left(h\right)}=\rho'\right\} $
die Menge $M_{\rho}$ in isomorphe Klassen teilt, gilt $\left|\left\{ \pi'\in M_{\rho},\,\pi'_{\mid\mathrm{sp}\left(h\right)}=\rho'\right\} \right|=\frac{\left|M_{\rho}\right|}{\left|\Pi_{\rho}\left(h\right)\right|}$
für $\rho'\in\Pi_{\rho}\left(h\right)$.

\begin{eqnarray*}
\left|M_{\rho}\right|r & = & \sum_{h\in H}\mathcal{W}\left(h,g\right)\sum_{\rho'\in\Pi_{\rho}\left(h\right)}\left[\mathrm{EV}\left(h\right)\right]\left(\rho'\right)\frac{\left|M_{\rho}\right|}{\left|\Pi_{\rho}\left(h\right)\right|}\\
 & = & \sum_{h\in H}\mathcal{W}\left(h,g\right)\sum_{\rho'\in\Pi_{\rho}\left(h\right)\cap\mathrm{EV}\left(h\right)}\frac{\left|M_{\rho}\right|}{\left|\Pi_{\rho}\left(h\right)\right|}\\
 & = & \sum_{h\in H}\mathcal{W}\left(h,g\right)\frac{\left|\Pi_{\rho}\left(h\right)\cap\mathrm{EV}\left(h\right)\right|\left|M_{\rho}\right|}{\left|\Pi_{\rho}\left(h\right)\right|}
\end{eqnarray*}


Durch das Kürzen von $\left|M_{\rho}\right|$ entsteht die Gleichung
\ref{eq:behauptung-28} aus der Behauptung.
\end{proof}
Sei nach Definition \ref{def:tupel} $\bar{U}$ das geordnete Tupel
aller Elemente des Universums, und $\bar{\mathrm{sp}}\left(g\right)$
das Tupel der Elemente von $\mathrm{sp}\left(g\right)$.

Sei $\bar{M}_{\rho}\subseteq A^{n}$ die Relation der $n$-Tupel $\pi\bar{U}$
für $\pi\in M_{\rho}$, sei $\bar{\Pi}_{\rho}\left(h\right)\subseteq A^{\left|\mathrm{sp}\left(h\right)\right|}$
die Relation der Tupel $\rho\bar{\mathrm{sp}}\left(h\right)$ für
$\rho\in\Pi_{\rho}\left(h\right)$, und sei $\bar{\mathrm{EV}}\left(g\right)\subseteq A^{\left|\mathrm{sp}\left(g\right)\right|}$
die Relation der Tupel $\rho\bar{\mathrm{sp}}\left(g\right)$ für
$\rho\in\mathrm{EV}\left(g\right)$. 
\begin{eqnarray*}
\bar{M}_{\rho} & \coloneqq & \left\{ \pi\bar{U}\mid\pi\in M_{\rho}\right\} \\
\bar{\mathrm{EV}}\left(g\right) & \coloneqq & \left\{ \rho\bar{\mathrm{sp}}\left(g\right)\mid\rho\in\mathrm{EV}\left(g\right)\right\} 
\end{eqnarray*}


Wir werden nun für jedes Gate $g\in G$ mit den Vorgängern $H\subseteq G$
die Menge $\bar{\mathrm{EV}}\left(g\right)$ rekursiv durch $\left(\bar{\mathrm{EV}}\left(h\right)\right)_{h\in H}$
und $\mathfrak{A}$ definieren, wobei $\rho_{\bar{a}}:\mathrm{sp}\left(g\right)\rightarrow A$
für $\bar{a}\in A^{\left|\mathrm{sp}\left(g\right)\right|}$ die Abbildung
$\rho_{\bar{a}}=\left(\bar{\mathrm{sp}}\left(g\right)\mapsto\bar{a}\right)$
bezeichne.
\begin{casenv}
\item Falls $g$ eine Konstante mit $\Sigma\left(g\right)\in\left\{ \mathbf{0},\mathbf{1}\right\} $
ist, dann ist $\mathrm{sp}\left(g\right)=\emptyset$, da $g$ ein
Fixpunkt aller Automorphismen ist. In diesem Fall gilt:
\[
\bar{\mathrm{EV}}\left(g\right)=\begin{cases}
\emptyset & \mathrm{falls}\,\Sigma\left(g\right)=\mathbf{0}\\
\left\{ \left\langle \right\rangle \right\}  & \mathrm{falls}\,\Sigma\left(g\right)=\mathbf{1}
\end{cases}
\]

\item Falls $g$ ein relationales Input mit $\Sigma\left(g\right)=R\bar{t}$,
$R/k\in\sigma$ und $\bar{t}\in\mathrm{sp}\left(g\right)^{k}$ ist,
dann gilt:
\[
\bar{\mathrm{EV}}\left(g\right)=R^{\mathfrak{A}}\cap\left\{ \rho_{\bar{a}}\bar{t}\mid\bar{a}\in A^{\left|\mathrm{sp}\left(g\right)\right|}\right\} 
\]

\item Falls $\Sigma\left(g\right)=\mathtt{AND}$ ist, dann gilt für jedes
Tupel $\bar{a}\in A^{\left|\mathrm{sp}\left(g\right)\right|}$ , dass
$\rho_{\bar{a}}\in\mathrm{EV}\left(g\right)$ genau dann wenn jede
zu $\rho_{\bar{a}}$ konsistente Bijektion $\pi\in M_{\rho_{\bar{a}}}$
alle Vorgänger $h\in H$ erfüllt: 
\begin{eqnarray*}
\sum_{h\in H}\mathcal{W}\left(h,g\right)\mathcal{C}\left[\pi^{-1}\mathfrak{A}\right]\left(h\right) & = & \sum_{h\in H}\mathcal{W}\left(h,g\right)
\end{eqnarray*}
Beziehungsweise nach Behauptung \ref{claim:claim-28}:
\[
\sum_{h\in H}\mathcal{W}\left(h,g\right)\frac{\left|\Pi_{\rho_{\bar{a}}}\left(h\right)\cap\mathrm{EV}\left(h\right)\right|}{\left|\Pi_{\rho_{\bar{a}}}\left(h\right)\right|}=\sum_{h\in H}\mathcal{W}\left(h,g\right)
\]
Dies ist gleichbedeutend mit $\Pi_{\rho_{\bar{a}}}\left(h\right)\subseteq\mathrm{EV}\left(h\right)$.
Demnach gilt:
\[
\bar{\mathrm{EV}}\left(g\right)=\left\{ \bar{a}\in A^{\left|\mathrm{sp}\left(g\right)\right|}\mid\bigwedge_{h\in H}\bar{\Pi}_{\rho_{\bar{a}}}\left(h\right)\subseteq\bar{\mathrm{EV}}\left(h\right)\right\} 
\]

\item Falls $\Sigma\left(g\right)=\mathtt{OR}$ ist, dann ist $\rho_{\bar{a}}\in\mathrm{EV}\left(g\right)$
genau dann wenn mindestens eine Bijektion $\pi\in M_{\rho}$ mindestens
einen Vorgänger $h\in H$ erfüllt:
\[
\sum_{h\in H}\mathcal{W}\left(h,g\right)\frac{\left|\Pi_{\rho_{\bar{a}}}\left(h\right)\cap\mathrm{EV}\left(h\right)\right|}{\left|\Pi_{\rho_{\bar{a}}}\left(h\right)\right|}>0
\]
\[
\bar{\mathrm{EV}}\left(g\right)=\left\{ \bar{a}\in A^{\left|\mathrm{sp}\left(g\right)\right|}\mid\bigvee_{h\in H}\left(\bar{\Pi}_{\rho_{\bar{a}}}\left(h\right)\cap\bar{\mathrm{EV}}\left(h\right)\neq\emptyset\right)\right\} 
\]

\item Falls $\Sigma\left(g\right)=\mathtt{MAJ}$ ist, dann ist $\rho_{\bar{a}}\in\mathrm{EV}\left(g\right)$
genau dann wenn mindestens die Hälfte der Vorgänger erfüllt sind:
\[
\sum_{h\in H}\mathcal{W}\left(h,g\right)\frac{\left|\Pi_{\rho\bar{a}}\left(h\right)\cap\mathrm{EV}\left(h\right)\right|}{\left|\Pi_{\rho_{\bar{a}}}\left(h\right)\right|}\geqslant\frac{1}{2}\sum_{h\in H}\mathcal{W}\left(h,g\right)
\]

\item Falls $\Sigma\left(g\right)=\mathtt{NOT}$, dann hat $g$ per Definition
des Schaltkreises genau einen Vorgänger $h$, es gilt $\mathrm{sp}\left(g\right)=\mathrm{sp}\left(h\right)$
und $\mathcal{C}\left[\pi^{-1}\mathfrak{A}\right]\left(g\right)=1-\mathcal{C}\left[\pi^{-1}\mathfrak{A}\right]\left(h\right)$.
Also:
\[
\bar{\mathrm{EV}}\left(g\right)=A^{\left|\mathrm{sp}\left(g\right)\right|}\backslash\bar{\mathrm{EV}}\left(h\right)
\]

\end{casenv}
Die vom Schaltkreis $\mathcal{C}$ berechnete Anfrage $q_{\mathcal{C}}$
ist äquivalent zu der folgenden Relation:
\[
q_{\mathcal{C}}\left(\mathfrak{A}\right)\coloneqq\left\{ \bar{a}\in A^{k}\mid\mathrm{ex.}\,\bar{t}\in U^{k}\,\mathrm{mit}\,\bar{a}\in\mathrm{EV}\left(\Omega\left(\bar{t}\right)\right)\right\} 
\]


\pagebreak{}


\section{Kodierung durch Fixpunktlogik}

Die beschriebenen Klassen Relationen $\mathrm{EV}$ werden nun verwendet,
um die Klasse $\mathrm{SBC}$ auf die Fixpunktlogik $\mathrm{LFP}$
zu reduzieren.
\begin{lem}
Sei $\left(\mathcal{C}_{n}\right)_{n\in\mathbb{N}}$ eine $k$-stellige,
rigide, symmetrische, $P$-uniforme $\left(\sigma,\mathbb{B}_{\mathrm{std}}\right)$-Multischaltkreisfamilie.
Es existiert eine $\left(\mathrm{LFP}+\mathbf{ORD}\right)\left[\sigma\right]$-Formel
$\varphi$ aufbauen, so dass für $n\in\mathbb{N}$ und $\mathfrak{A}\in\mathbf{FIN}^{\left(n\right)}\left(\sigma\right)$
die Formel $\varphi\left(\bar{x}\right)$ die gleiche Anfrage definiert
wie $\mathcal{C}_{n}$:

\[
q_{\mathcal{C}_{n}}\left(\mathfrak{A}\right)=q_{\varphi}\left(\mathfrak{A}\right)
\]
\end{lem}
\begin{proof}
Da die Schaltkreisfamilie von einer $P$-Turingmaschine berechnet
wird, existiert nach dem Immerman-Vardi-Theorem\cite{Vardi:1982:CRQ:800070.802186,IMMERMAN198686}
und Lemma \ref{lem:algo-rigid} eine Sammlung von $\mathrm{LFP}\left[\left\{ \leqslant\right\} \right]$-Formeln
$\Phi$, die auf der Struktur $\mathbf{ORD}\left(n\right)$ ausgewertet
den Schaltkreis $\mathcal{C}_{n}$ beschreiben:
\[
\Phi\coloneqq\left(\varphi_{G},\varphi_{\mathcal{W}},\varphi_{\Omega},\left(\varphi_{\phi}\right)_{\phi\in\mathbb{B}\uplus\left\{ \mathbf{0},\mathbf{1},\mathtt{NOT}\right\} },\left(\varphi_{R}\right)_{R\in\sigma}\right)
\]


Hierbei sei $f_{G}:G\rightarrow\left[1,n\right]^{c}$ eine geeignete
Kodierung der höchstens $n^{c}$ Gates von $\mathcal{C}_{n}$, und
$f_{W}:\left[1,n^{c}\right]\rightarrow\left[1,n\right]^{c}$ eine
Kodierung von Zahlen, so dass für $\bar{g},\bar{h},\bar{w}\in\left[0,n\right]^{c}$:
\begin{eqnarray*}
\mathbf{ORD}\left(n\right)\models\varphi_{G}\left[\bar{g}\right] & \Leftrightarrow & f_{G}^{-1}\left(\bar{g}\right)\in G\\
\mathbf{ORD}\left(n\right)\models\varphi_{W}\left[\bar{h}\bar{g}\bar{w}\right] & \Leftrightarrow & \mathcal{W}\left(f_{G}^{-1}\left(\bar{h}\right),f_{G}^{-1}\left(\bar{g}\right)\right)=f_{W}^{-1}\left(\bar{w}\right)\\
\mathbf{ORD}\left(n\right)\models\varphi_{\Omega}\left[\bar{t}\bar{g}\right] & \Leftrightarrow & \Omega\left(\bar{t}\right)=f_{G}^{-1}\left(\bar{g}\right)\\
 &  & \mathrm{f\ddot{u}r}\,\bar{t}\in\left[1,n\right]^{k}\\
\mathbf{ORD}\left(n\right)\models\varphi_{\phi}\left[\bar{g}\right] & \Leftrightarrow & \Sigma\left(f_{G}^{-1}\left(\bar{g}\right)\right)=\phi\\
 &  & \mathrm{f\ddot{u}r}\,\phi\in\mathbb{B}\uplus\left\{ \mathbf{0},\mathbf{1},\mathtt{NOT}\right\} \\
\mathbf{ORD}\left(n\right)\models\varphi_{R}\left[\bar{g}\bar{x}\right] & \Leftrightarrow & \Sigma\left(f_{G}^{-1}\left(\bar{g}\right)\right)=R\bar{x}\\
 &  & \mathrm{f\ddot{u}r}\,R/m\in\sigma,\,\bar{x}\in\left[1,n\right]^{m}
\end{eqnarray*}


Für $n<n_{0}$ gibt es nur eine endliche Anzahl von festen Schaltkreisen
$\mathcal{C}_{n}$. Jeder dieser Schaltkreise ist durch eine $\mathrm{FO}\left[\sigma\right]$-Formel
kodierbar: Sei $\psi_{n}\left(\bar{x}\right)$ eine Formel, die prüft,
ob $\left|A\right|=n$, und dann prüft, ob für alle $n!$ Bijektionen
$\pi:A\rightarrow U$ gilt, dass $\mathcal{C}\left[\pi\mathfrak{A}\right]\left(\Omega\left(\pi\beta\bar{x}\right)\right)$
mit $\beta:\mathrm{frei}\left(\psi_{n}\right)\rightarrow A$.

{[}...{]}
\end{proof}
\pagebreak{}


\section{Schaltkreise konstanter Tiefe}

Das Resultat von Anderson und Dawar werden wir nun auf Schaltkreise
konstanter Tiefe ausweiten, die auf $\mathrm{FO}+\mathbf{BIT}$ reduzierbar
sind.
\begin{lem}
Sei $\left(\mathcal{C}_{n}\right)_{n\in\mathbb{N}}$ eine $k$-stellige,
rigide, symmetrische, $\mathrm{LOGSPACE}$-uniforme $\left(\sigma,\mathbb{B}\right)$-Multischaltkreisfamilie
mit konstanter $c$-Tiefe und $n^{d}$-Größe. Es existiert eine $\left(\mathrm{FO}+\mathbf{BIT}\right)\left[\sigma\right]$-Formel
$\varphi$, so dass für $n\in\mathbb{N}$ und $\mathfrak{A}\in\mathbf{FIN}^{\left(n\right)}\left(\sigma\right)$
die Formel $\varphi\left(\bar{x}\right)$ die gleiche Anfrage definiert
wie $\mathcal{C}_{n}$.\end{lem}
\begin{proof}
Weil die Schaltkreisfamilie von einer $\mathrm{LOGSPACE}$-Turingmaschine
berechnet wird, existiert nach Immerman\cite{immerman2012descriptive}
eine Sammlung von $\mathrm{FO}\left[\left\{ \mathtt{BIT}\right\} \right]$-Formeln
$\Phi$, die auf der Struktur $\mathbf{BIT}\left(n\right)$ ausgewertet
den Schaltkreis $\mathcal{C}_{n}$ beschreiben:

\[
\Phi\coloneqq\left(\varphi_{G},\varphi_{\mathcal{W}},\varphi_{\Omega},\left(\varphi_{\phi}\right)_{\phi\in\mathbb{B}\uplus\left\{ \mathbf{0},\mathbf{1},\mathtt{NOT}\right\} },\left(\varphi_{R}\right)_{R\in\sigma}\right)
\]


Hierbei sei $f_{G}:G\rightarrow\left[1,n\right]^{d}$ eine geeignete
Kodierung der höchstens $n^{d}$ Gates von $\mathcal{C}_{n}$, und
$f_{W}:\left[1,n^{d}\right]\rightarrow\left[1,n\right]^{d}$ eine
Kodierung von Zahlen, so dass für $\bar{g},\bar{h},\bar{w}\in\left[0,n\right]^{d}$:
\begin{eqnarray*}
\mathbf{BIT}\left(n\right)\models\varphi_{G}\left[\bar{g}\right] & \Leftrightarrow & f_{G}^{-1}\left(\bar{g}\right)\in G\\
\mathbf{BIT}\left(n\right)\models\varphi_{W}\left[\bar{h}\bar{g}\bar{w}\right] & \Leftrightarrow & \mathcal{W}\left(f_{G}^{-1}\left(\bar{h}\right),f_{G}^{-1}\left(\bar{g}\right)\right)=f_{W}^{-1}\left(\bar{w}\right)\\
\mathbf{BIT}\left(n\right)\models\varphi_{\Omega}\left[\bar{t}\bar{g}\right] & \Leftrightarrow & \Omega\left(\bar{t}\right)=f_{G}^{-1}\left(\bar{g}\right)\\
 &  & \mathrm{f\ddot{u}r}\,\bar{t}\in\left[1,n\right]^{k}\\
\mathbf{BIT}\left(n\right)\models\varphi_{\phi}\left[\bar{g}\right] & \Leftrightarrow & \Sigma\left(f_{G}^{-1}\left(\bar{g}\right)\right)=\phi\\
 &  & \mathrm{f\ddot{u}r}\,\phi\in\mathbb{B}\uplus\left\{ \mathbf{0},\mathbf{1},\mathtt{NOT}\right\} \\
\mathbf{BIT}\left(n\right)\models\varphi_{R}\left[\bar{g}\bar{x}\right] & \Leftrightarrow & \Sigma\left(f_{G}^{-1}\left(\bar{g}\right)\right)=R\bar{x}\\
 &  & \mathrm{f\ddot{u}r}\,R/m\in\sigma,\,\bar{x}\in\left[1,n\right]^{m}
\end{eqnarray*}


{[}...{]}
\end{proof}

\chapter{Grenzen der symmetrischen Schaltkreisklassen}

Wir weisen nach, dass die symmetrischen $\mathrm{AC}^{0}$-Schaltkreisfamilien
eine echte Teilmenge der Anfragen beschreiben, die durch $\mathrm{AC}^{0}$
definierbar sind.

Hierfür verwenden wir die Charakterisierung aus Theorem \ref{thm:fo}
von symmetrischem $\mathrm{AC}^{0}$ durch die Logik $\mathrm{FO}+\mathbf{ARB}$,
die Charakterisierung von $\mathrm{AC}^{0}$ durch die Logik $\mathrm{inv}\left(\mathrm{FO}\oplus\mathbf{ARB}\right)$,
und ein Problem, dass die Ausdrucksstärke dieser beiden Logiken voneinander
trennt.
\begin{thm}
\textbf{\label{lem:fo-arb-ac0}Immerman (1987)}\cite{Immerman1987}\textbf{,
Makowsky (1997)\cite{Makowsky1997-FO}}

Die Klasse der $\mathrm{AC}^{0}$-definierbaren Anfragen ist äquivalent
zu der Klasse der $\mathrm{inv}\left(\mathrm{FO}\oplus\mathbf{ARB}\right)$-definierbaren
Anfragen.
\end{thm}
Für die Konstruktion der Formel (hier nur skizziert) wird jeder Schaltkreis
in eine alternierende Normalform der Tiefe $d$ gebracht, in der jedes
Gate $n^{k}$ Vorgänger hat. Die $n^{kd}$ Wege von einem Input zu
einem Output werden durch numerische Tupel kodiert (die Relation dieser
Wege ist ein numerisches Prädikat und daher in $\mathrm{inv}\left(\mathrm{FO}\oplus\mathbf{ARB}\right)$-Logik
verwendbar). Die Formel muss dann über jede der alternierenden Ebenen
des Schaltkreises quantifizieren (mit $\exists$ für $\mathtt{OR}$,
und $\forall$ für $\mathtt{AND}$), und berechnet so die Auswertung
von $\mathcal{C}$.

Da per Definition offensichtlich $\mathrm{SAC}^{0}\subseteq\mathrm{AC}^{0}$
gilt, können wir mit $\mathrm{FO}+\mathbf{ARB}\subseteq\mathrm{SAC}^{0}$
direkt ablesen, dass $\mathrm{FO}+\mathbf{ARB}$ in $\mathrm{inv}\left(\mathrm{FO}\oplus\mathbf{ARB}\right)$
enthalten ist (und beweisen somit Teil 1 des Theorems \ref{thm:fo-arb}):
Die Logik erster Stufe mit disjunktem $\mathbf{ARB}$-Orakel ist nicht
stärker als die mit nicht-disjunktem Orakel.

Für den echten Einschluss (Teil 2 des Theorems \ref{thm:fo-arb})
benötigen wir eine Anfrage, die in $\mathrm{inv}\left(\mathrm{FO}\oplus\mathbf{ARB}\right)$
beschreibbar ist, jedoch nicht in $\mathrm{FO}+\mathbf{ARB}$ beschreibbar
ist. Per Theorem \ref{thm:fo} ist diese Anfrage dann in $\mathrm{AC}^{0}$,
aber per Theorem \ref{thm:fo} nicht in $\mathrm{SAC}^{0}$ beschreibbar.

Dafür verwenden wir den Lokalitäts-Satz von Hanf.
\begin{thm}
\textbf{Der Satz von Hanf} (Theorem 2.4.1 in \cite{EbbinghausFlum})

Seien $\mathfrak{A},\mathfrak{B}\in\mathbf{FIN}\left(\sigma\right)$,
$m\in\mathbb{N}$ und $r\coloneqq3^{m}$, und sei $\#_{r}^{\mathfrak{A}}\left(a\right)\coloneqq\left|\left\{ b\in A\mid a\sim_{r}b\right\} \right|$
die Anzahl der $r$-ähnlichen Elemente zu $a$ in $\mathfrak{B}$
(und $\#_{r}^{\mathfrak{B}}\left(a\right)$ analog in $\mathfrak{B}$).
Sei $e\in\mathbb{N}$ so gewählt, dass $\max_{a\in A}\left(\left|N_{r}^{\mathfrak{A}}\left(a\right)\right|\right),\max_{b\in B}\left(\left|N_{r}^{\mathfrak{B}}\left(b\right)\right|\right)\leqslant e$.

Nun gelte für jedes Element $a\in A$ mindestens eine der folgenden
Aussagen:
\begin{enumerate}
\item Die Anzahl der $r$-ähnlichen Elemente (siehe Definition \ref{def:neighborhoods})
zu $a$ in $\mathfrak{A}$ und $\mathfrak{B}$ ist gleich.
\[
\#_{r}^{\mathfrak{A}}\left(a\right)=\#_{r}^{\mathfrak{B}}\left(a\right)
\]

\item Die Anzahl der $r$-ähnlichen Elemente zu $a$ in $\mathfrak{A}$
und in $\mathfrak{B}$ ist jeweils größer als $m\cdot e$.
\[
\#_{r}^{\mathfrak{A}}\left(a\right),\#_{r}^{\mathfrak{B}}\left(a\right)\geqslant m\cdot e
\]

\end{enumerate}
Dann gilt: $\mathfrak{A}\equiv_{m}\mathfrak{B}$ (siehe Definition
\ref{def:m-equiv}).\end{thm}
\begin{lem}
Es existiert eine Graph-Anfrage $q$, die in $\mathrm{inv}\left(\mathrm{FO}\oplus\mathbf{ARB}\right)$-definierbar
ist, aber nicht in $\mathrm{FO}+\mathbf{ARB}$ beschreibbar ist.\end{lem}
\begin{proof}
Sei $C\subseteq\mathbf{FIN}\left(\left\{ E\right\} \right)$ die Klasse
der Graphen $\mathfrak{A}=\left(A,E^{\mathfrak{A}}\right)$ für die
gilt: $A$ enthält höchstens $\left\lceil \mathrm{log}\left|A\right|\right\rceil $
viele nicht-isolierte Knoten.

Diese Anfrage ist durch einen $\mathrm{inv}\left(\mathrm{FO}\oplus\mathbf{ARB}\right)\left[\left\{ E\right\} \right]$-Satz
definierbar (siehe dazu Abschnitt 4.4 von \cite{AMSS2012-locality}).
\begin{assumption*}
Es existiere ein beliebiger $\left(\mathrm{FO}+\mathbf{ARB}\right)\left[\left\{ E\right\} \right]$-Satz
$\varphi_{C}$, der die Anfrage $q_{C}$ definiere.
\end{assumption*}
Sei $m\coloneqq\mathrm{qr}\left(\varphi_{C}\right)$ der Quantorenrang
von $\varphi_{C}$, und o.B.d.A. sei $m\geqslant9$. Wir definieren
die folgenden Graphen $\mathfrak{A},\mathfrak{B}\in\mathbf{FIN}^{\left(2^{m^{m}}\right)}\left(\left\{ E\right\} \right)$
(siehe Abbildung \ref{fig:m-equiv}):
\begin{eqnarray*}
A,B & \coloneqq & \left[1,2^{m^{m}}\right]\\
E^{\mathfrak{A}} & \coloneqq & \left\{ \left(i,i+1\right)\mid i\in\left[1,m^{m}-1\right]\right\} \cup\left\{ \left(m^{m},1\right)\right\} \\
E^{\mathfrak{B}} & \coloneqq & \left\{ \left(i,i+1\right)\mid i\in\left[1,m^{m}\right]\right\} \cup\left\{ \left(m^{m}+1,1\right)\right\} 
\end{eqnarray*}
Beide Strukturen bestehen aus $2^{m^{m}}$ Knoten, $\mathfrak{A}$
enthält einen Kreis der Länge $m^{m}$, und $\mathfrak{B}$ einen
Kreis der Länge $m^{m}+1$. Damit gilt:
\[
\mathfrak{A}\in C,\,\mathfrak{B}\notin C
\]
\[
\mathfrak{A}\models\varphi_{C},\,\mathfrak{B}\not\models\varphi_{C}
\]
Offensichtlich besteht die $3^{m}$-Nachbarschaft jedes Knotens im
Kreis aus einer $3^{m}+1$ langen Kette, und die übrigen Knoten sind
isoliert. Damit sind alle $3^{m}$-Nachbarschaften kleiner als $e\coloneqq3^{m}+2$.
Ferner hat jeder Knoten im Kreis mindestens $m^{m}\geqslant m\cdot3^{m+7}>m\cdot e$
viele $3^{m}$-ähnliche Knoten in jedem Graphen, und jeder isolierte
Knoten ohnehin $2^{m^{m}}-m^{m}>m^{m}$ viele $3^{m}$-ähnliche Knoten.
Somit sind die Graphen $\mathfrak{A}$ und $\mathfrak{B}$ nach dem
Satz von Hanf $m$-äquivalent.

\begin{figure}
\noindent \begin{centering}
\tikzstyle{g}=[circle, draw, fill=black,
                        inner sep=0pt, minimum width=2pt]
%  Tutte's 8-cage
\begin{tikzpicture}[thick,scale=0.8]
    \draw  \foreach \x in {0,18,...,342}
    {
        (\x:1.5) node[g] {} edge[dotted] (\x+18:1.5)
    };
	\node (0:0) {$m^m$};
	\begin{scope}[shift={(0,-4)},xscale=2]
		\draw [dotted] (0,0) ellipse (2 and 2);
		\draw plot [only marks, mark=*, mark size=0.1, domain=0:5, samples=75] ({rnd*360}:{1+rnd});
	\end{scope}
	\node at (0,-4) {$2^{m^m}-m^m$};
\end{tikzpicture}\tikzstyle{g}=[circle, draw, fill=black,
                        inner sep=0pt, minimum width=2pt]
%  Tutte's 8-cage
\begin{tikzpicture}[thick,scale=0.8]
    \draw  \foreach \x in {0,18,...,342}
    {
        (\x:1.5) node[g] {} edge[dotted] (\x+18:1.5)
    };
	\node (0:0) {$m^m+1$};
	\begin{scope}[shift={(0,-4)},xscale=2]
		\draw [dotted] (0,0) ellipse (2 and 2);
		\draw plot [only marks, mark=*, mark size=0.1, domain=0:5, samples=75] ({rnd*360}:{1+rnd});
	\end{scope}
	\node at (0,-4) {$2^{m^m}-m^m-1$};
\end{tikzpicture}
\par\end{centering}

\caption{\label{fig:m-equiv}Zwei $m$-äquivalente Graphen $\mathfrak{A},\mathfrak{B}$}


\end{figure}


Der $\mathrm{FO}+\mathbf{ARB}\left[\sigma\right]$-Satz $\varphi$
wird nicht auf $\mathfrak{A}$ und $\mathfrak{B}$, sondern $\mathfrak{A}\uplus\mathbf{ARB}\left(n\right)$
und $\mathfrak{B}\uplus\mathbf{ARB}\left(n\right)$ ausgewertet. Wir
werden im folgenden sehen, warum das nicht hilft, denn nach Satz \ref{prop:m-equiv-closed}
ist die $m$-Äquivalenz unter disjunkter Vereinigung abgeschlossen.

Da $\mathfrak{A}\equiv_{m}\mathfrak{B}$, und offensichtlich $\mathbf{ARB}\left(n\right)\equiv_{m}\mathbf{ARB}\left(n\right)$,
folgt somit $\mathfrak{A}\uplus\mathbf{ARB}\left(n\right)\equiv_{m}\mathfrak{B}\uplus\mathbf{ARB}\left(n\right)$,
und es gilt, im Widerspruch zu der Annahme:
\[
\mathfrak{A}\models\varphi_{C}\Leftrightarrow\mathfrak{B}\models\varphi_{C}
\]
\end{proof}
\begin{prop}
\label{prop:m-equiv-closed}Seien $\sigma_{1},\sigma_{2}$ beliebige
Signaturen, $\mathfrak{A}\equiv_{m}\mathfrak{B}$ zwei beliebige $\sigma_{1}$-Strukturen
und $\mathfrak{A}'\equiv_{m}\mathfrak{B}'$ zwei beliebige $\sigma_{2}$-Strukturen.

Dann gilt $\mathfrak{A}\uplus\mathfrak{A}'\equiv_{m}\mathfrak{B}\uplus\mathfrak{B}'$.
\end{prop}
Um dies zu beweisen, verwenden wir den Satz von Ehrenfeucht, nach
dem die $m$-Äquivalenz von Strukturen gleichbedeutend ist mit der
Existenz einer Gewinnstrategie für Duplicator im Ehrenfeucht-Fraïssé-Spiel
mit $m$ Runden. Wir verwenden die Definition des EF-Spiels von Ebbinghaus
und Flum (Abschnitt 2.2 von \cite{EbbinghausFlum}).
\begin{proof}
Es wird per $\mathfrak{A}\equiv_{m}\mathfrak{B}$ und $\mathfrak{A}'\equiv_{m}\mathfrak{B}'$
vorausgesetzt, dass Duplicator eine Gewinnstrategie für jedes $m'\leqslant m$-Runden-Spiel
auf $\left(\mathfrak{A},\mathfrak{B}\right)$ und auf $\left(\mathfrak{A}',\mathfrak{B}'\right)$
hat. Im Spiel auf $\left(\mathfrak{A}\uplus\mathfrak{A}',\mathfrak{B}\uplus\mathfrak{B}'\right)$
geht Duplicator wie folgt vor:
\begin{itemize}
\item Falls Spoiler einen Knoten $a_{i}\in A$ oder $b_{i}\in B$ wählt,
so antworte mit dem Gewinnzug aus dem Spiel auf $\left(\mathfrak{A},\mathfrak{B}\right)$.
\item Falls Spoiler $a_{i}\in A'$ oder $b_{i}\in B'$ wählt, so antworte
mit dem Gewinnzug aus dem Spiel auf $\left(\mathfrak{A}',\mathfrak{B}'\right)$.
\end{itemize}
Nun betrachten wir die gespielten Tupel $\bar{a}\in\left(A\cup A'\right)^{m}$
und $\bar{b}\in\left(B\cup B'\right)^{m}$, und die induzierten Strukturen
$\left(\mathfrak{A}\uplus\mathfrak{A}'\right)_{\mid\bar{a}}$ und
$\left(\mathfrak{B}\uplus\mathfrak{B}'\right)_{\mid\bar{b}}$.

Wegen der Annahme induzieren $\bar{a}$ und $\bar{b}$ zwei partielle
Isomorphismen mit $\left(\mathfrak{A}_{\mid\bar{a}},\bar{a}_{\mid A}\right)\cong\left(\mathfrak{B}_{\mid\bar{b}},\bar{b}_{\mid B}\right)$
und $\left(\mathfrak{A}'_{\mid\bar{a}},\bar{a}_{\mid A'}\right)\cong\left(\mathfrak{B}'_{\mid\bar{b}},\bar{b}_{\mid B'}\right)$.
Nach Satz \ref{prop:iso-closed-disjoint} ist der Isomorphismus abgeschlossen,
so dass gilt:
\[
\left(\mathfrak{A}\uplus\mathfrak{A}'_{\mid\bar{a}},\bar{a}\right)\cong\left(\mathfrak{B}\uplus\mathfrak{B}'_{\mid\bar{b}},\bar{b}\right)
\]
Damit hat Duplicator das Spiel auf $\left(\mathfrak{A}\uplus\mathfrak{A}',\mathfrak{B}\uplus\mathfrak{B}'\right)$
gewonnen, und es folgt $\mathfrak{A}\uplus\mathfrak{A}'\equiv_{m}\mathfrak{B}\uplus\mathfrak{B}'$.
\end{proof}
Die hier dargestellte Folgerung lässt sich allgemein auf jedes Paar
von $m$-äquivalenten Strukturen erweitern, solange die Strukturen
die gleiche Größe haben.
\begin{cor}
Die Logik $\mathrm{FO}+\mathbf{ARB}$ mit disjunktem Orakel kann nur
Eigenschaften ausdrücken, die bezüglich gleich großer Strukturen Hanf-lokal
sind.
\end{cor}
(Die Forderung nach gleicher Größe ist notwendig, denn offensichtlich
ist zum Beispiel die $\mathrm{FO}+\mathbf{ARB}$-definierbare Klasse
$\textsc{Even}$ nicht Hanf-lokal.)


\chapter{Ausblick}

Wir haben den Beweis im letzten Abschnitt über den Satz von Hanf formuliert,
und somit gezeigt, dass die Logik $\mathrm{FO}+\mathbf{ARB}$ modulo
der Struktur-Größe Hanf-lokal ist, während dies für die arb-invariante
Logik $\mathrm{inv}\left(\mathrm{FO}\oplus\mathbf{ARB}\right)$ nicht
allgemein gilt \cite{AnMeScSe11}.

Vermutlich gelten ähnliche Beziehungen auch für die symmetrischen
Teile der übrigen Schaltkreisklassen $\mathrm{SBC}$, $\mathrm{AC}^{0}+\mathbf{MAJ}$
und $\mathrm{SBC}+\mathbf{MAJ}$. Ein Beweis über die Hanf-Lokalität
bietet sich hier aber vermutlich nicht an, denn insbesondere wäre
die im letzten Abschnitt definierte Klasse in $\mathrm{FO}+\mathbf{ARB}+C$
definierbar:
\begin{eqnarray*}
\varphi & \coloneqq & \exists x\left(\exists^{=x}y\exists z\,\left(Eyz\vee Ezy\right)\wedge\exists x_{\max}\left(\log_{\leqslant}\left(x,x_{\max}\right)\wedge\forall y\left(x_{\max}\leqslant y\rightarrow x_{\max}=y\right)\right)\right)\\
\log_{\leqslant} & \coloneqq & \left\{ \left(m,n\right)\in\mathbb{N}^{2}\mid2^{m}\leqslant n\right\} 
\end{eqnarray*}


\bibliographystyle{plain}
\bibliography{master}



\chapter*{Erklärung}

\addcontentsline{toc}{chapter}{Erklärung}

Gemäß der Ordnung für den Masterstudiengang Informatik, § 24 Abs.
12 bestätige ich hiermit, dass ich die vorliegende Arbeit selbständig
ohne fremde Hilfe angefertigt und nur die angegebenen Hilfsmittel
verwendet habe.

\vspace{2em}


Frankfurt, den \today

\vspace{5em}


Christoph Burschka
\end{document}
